(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{512:function(e,t,a){e.exports=a.p+"static/media/sound.9fd5812c.mp3"},544:function(e,t,a){e.exports=a.p+"static/media/wa-background.adbccee0.png"},580:function(e,t,a){e.exports=a(880)},880:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(26),l=a.n(r),s=a(979),c=a(42),i=a(49),d=a(13),m=a(256),u=a.n(m);function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0!==window.ENV?window.ENV[e]||t:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_BACKEND_URL:"fenix.ticket",REACT_APP_HOURS_CLOSE_TICKETS_AUTO:"24"})[e]||t}function g(){return p("REACT_APP_BACKEND_URL")}var E=function(){const e=localStorage.getItem("token");return u()(g(),{query:{token:JSON.parse(e)}})},h=a(349),b=a(495);const f={pt:{translations:{signup:{title:"Cadastre-se",toasts:{success:"Usu\xe1rio criado com sucesso! Fa\xe7a seu login!!!.",fail:"Erro ao criar usu\xe1rio. Verifique os dados informados."},form:{name:"Nome",email:"Email",password:"Senha"},buttons:{submit:"Cadastrar",login:"J\xe1 tem uma conta? Entre!"}},login:{title:"Login",form:{email:"Email",password:"Senha"},buttons:{submit:"Entrar",register:"N\xe3o tem um conta? Cadastre-se!"}},auth:{toasts:{success:"Login efetuado com sucesso!"}},dashboard:{charts:{perDay:{title:"Tickets hoje: "}},messages:{inAttendance:{title:"Em Atendimento"},waiting:{title:"Aguardando"},closed:{title:"Finalizado"}}},connections:{title:"Conex\xf5es",toasts:{deleted:"Conex\xe3o com o WhatsApp exclu\xedda com sucesso!"},confirmationModal:{deleteTitle:"Deletar",deleteMessage:"Voc\xea tem certeza? Essa a\xe7\xe3o n\xe3o pode ser revertida.",disconnectTitle:"Desconectar",disconnectMessage:"Tem certeza? Voc\xea precisar\xe1 ler o QR Code novamente."},buttons:{add:"Adicionar WhatsApp",disconnect:"desconectar",tryAgain:"Tentar novamente",qrcode:"QR CODE",newQr:"Novo QR CODE",connecting:"Conectando"},toolTips:{disconnected:{title:"Falha ao iniciar sess\xe3o do WhatsApp",content:"Certifique-se de que seu celular esteja conectado \xe0 internet e tente novamente, ou solicite um novo QR Code"},qrcode:{title:"Esperando leitura do QR Code",content:"Clique no bot\xe3o 'QR CODE' e leia o QR Code com o seu celular para iniciar a sess\xe3o"},connected:{title:"Conex\xe3o estabelecida!"},timeout:{title:"A conex\xe3o com o celular foi perdida",content:"Certifique-se de que seu celular esteja conectado \xe0 internet e o WhatsApp esteja aberto, ou clique no bot\xe3o 'Desconectar' para obter um novo QR Code"}},table:{name:"Nome",status:"Status",lastUpdate:"\xdaltima atualiza\xe7\xe3o",default:"Padr\xe3o",actions:"A\xe7\xf5es",session:"Sess\xe3o"}},whatsappModal:{title:{add:"Adicionar WhatsApp",edit:"Editar WhatsApp"},form:{name:"Nome",default:"Padr\xe3o",farewellMessage:"Mensagem de despedida",isMultidevice:"Multidevice",transferTicketMessage:"Mensagem de Transfer\xeancia do Ticket",reopenLastTicket:"Reabrir Ultimo Ticket",minutes:"Minutos",newticketafter:"Gerar um Novo Ticket ap\xf3s",titlenewticketafter:"Ao receber uma mensagem"},buttons:{okAdd:"Adicionar",okEdit:"Salvar",cancel:"Cancelar"},success:"WhatsApp salvo com sucesso."},qrCode:{message:"Leia o QrCode para iniciar a sess\xe3o"},contacts:{title:"Contatos",toasts:{deleted:"Contato exclu\xeddo com sucesso!"},searchPlaceholder:"Pesquisar...",confirmationModal:{deleteTitle:"Deletar ",importTitlte:"Importar contatos",deleteMessage:"Tem certeza que deseja deletar este contato? Todos os tickets relacionados ser\xe3o perdidos.",importMessage:"Deseja importas todos os contatos do telefone?"},buttons:{import:"Importar Contatos",add:"Adicionar Contato"},table:{name:"Nome",whatsapp:"WhatsApp",email:"Email",actions:"A\xe7\xf5es"}},contactModal:{title:{add:"Adicionar contato",edit:"Editar contato"},form:{mainInfo:"Dados do contato",extraInfo:"Informa\xe7\xf5es adicionais",name:"Nome",number:"N\xfamero do Whatsapp",email:"Email",extraName:"Nome do campo",extraValue:"Valor"},buttons:{addExtraInfo:"Adicionar informa\xe7\xe3o",okAdd:"Adicionar",okEdit:"Salvar",cancel:"Cancelar"},success:"Contato salvo com sucesso."},quickAnswersModal:{title:{add:"Adicionar Resposta R\xe1pida",edit:"Editar Resposta R\xe1pida"},form:{shortcut:"Atalho",message:"Resposta R\xe1pida"},buttons:{okAdd:"Adicionar",okEdit:"Salvar",cancel:"Cancelar"},success:"Resposta R\xe1pida salva com sucesso."},queueModal:{title:{add:"Adicionar fila",edit:"Editar fila"},form:{name:"Nome",color:"Cor",greetingMessage:"Mensagem de sauda\xe7\xe3o",transferQueueMessage:"Mensagem de Transfer\xeancia entre Setor",outOfWorkMessage:"Personalize a mensagem quando estiver fora do hor\xe1rio de expediente",startWorkHour:"Expediente: Abertura",endWorkHour:"Expediente: Fechamento",monday:"Segunda",tuesday:"Ter\xe7a",wednesday:"Quarta",thursday:"Quinta",friday:"Sexta",saturday:"S\xe1bado",sunday:"Domingo",holiday:"Feriado",token:"Token",checkHourExpedient:"Checar Hor\xe1rio de Expediente"},buttons:{okAdd:"Adicionar",okEdit:"Salvar",cancel:"Cancelar"}},userModal:{title:{add:"Adicionar usu\xe1rio",edit:"Editar usu\xe1rio"},form:{name:"Nome",email:"Email",password:"Senha",profile:"Perfil",whatsapp:"Conex\xe3o Padr\xe3o"},buttons:{okAdd:"Adicionar",okEdit:"Salvar",cancel:"Cancelar"},success:"Usu\xe1rio salvo com sucesso."},tagModal:{title:{add:"Nova Tag",edit:"Editar Tag"},form:{name:"Nome",color:"Cor"},buttons:{okAdd:"Adicionar",okEdit:"Salvar",cancel:"Cancelar"},success:"Tag salvo com sucesso."},chat:{noTicketMessage:"Selecione um ticket para come\xe7ar a conversar."},ticketsManager:{buttons:{newTicket:"Novo"}},ticketsQueueSelect:{placeholder:"Filas"},tickets:{toasts:{deleted:"O ticket que voc\xea estava foi deletado."},notification:{message:"Mensagem de"},tabs:{open:{title:"Inbox"},closed:{title:"Resolvidos"},search:{title:"Busca"}},search:{placeholder:"Buscar tickets e mensagens"},buttons:{showAll:"Todos"}},transferTicketModal:{title:"Transferir Ticket",fieldLabel:"Digite para buscar usu\xe1rios",fieldQueueLabel:"Transferir para fila",fieldConnectionLabel:"Transferir para conex\xe3o",fieldQueuePlaceholder:"Selecione uma fila",fieldConnectionPlaceholder:"Selecione uma conex\xe3o",noOptions:"Nenhum usu\xe1rio encontrado com esse nome",buttons:{ok:"Transferir",cancel:"Cancelar"}},ticketsList:{pendingHeader:"Aguardando",assignedHeader:"Atendendo",noTicketsTitle:"Nada aqui!",noTicketsMessage:"Nenhum ticket encontrado com esse status ou termo pesquisado",connectionTitle:"Conex\xe3o que est\xe1 sendo utilizada atualmente.",buttons:{accept:"Aceitar"}},newTicketModal:{title:"Criar Ticket",fieldLabel:"Digite para pesquisar o contato",add:"Adicionar",buttons:{ok:"Salvar",cancel:"Cancelar"}},mainDrawer:{listItems:{dashboard:"Dashboard",connections:"Conex\xf5es",tickets:"Tickets",contacts:"Contatos",quickAnswers:"Respostas R\xe1pidas",queues:"Filas & Chatbot",schedules:"Agendamentos",tags:"Tags",administration:"Administra\xe7\xe3o",users:"Usu\xe1rios",settings:"Configura\xe7\xf5es"},appBar:{user:{profile:"Perfil",logout:"Sair"}}},notifications:{noTickets:"Nenhuma notifica\xe7\xe3o."},schedules:{title:"Agendamentos",confirmationModal:{deleteTitle:"Voc\xea tem certeza que quer excluir este Agendamento?",deleteMessage:"Esta a\xe7\xe3o n\xe3o pode ser revertida."},table:{contact:"Contato",body:"Mensagem",sendAt:"Data de Agendamento",sentAt:"Data de Envio",status:"Status",actions:"A\xe7\xf5es"},buttons:{add:"Novo Agendamento"},toasts:{deleted:"Agendamento exclu\xeddo com sucesso."}},scheduleModal:{title:{add:"Novo Agendamento",edit:"Editar Agendamento"},form:{body:"Mensagem",contact:"Contato",sendAt:"Data de Agendamento",sentAt:"Data de Envio"},buttons:{okAdd:"Adicionar",okEdit:"Salvar",cancel:"Cancelar"},success:"Agendamento salvo com sucesso."},queues:{title:"Filas",table:{name:"Nome",color:"Cor",greeting:"Mensagem de sauda\xe7\xe3o",actions:"A\xe7\xf5es"},buttons:{add:"Adicionar fila"},confirmationModal:{deleteTitle:"Excluir",deleteMessage:"Voc\xea tem certeza? Essa a\xe7\xe3o n\xe3o pode ser revertida! Os tickets dessa fila continuar\xe3o existindo, mas n\xe3o ter\xe3o mais nenhuma fila atribu\xedda."}},queueSelect:{inputLabel:"Filas"},quickAnswers:{title:"Respostas R\xe1pidas",table:{shortcut:"Atalho",message:"Resposta R\xe1pida",actions:"A\xe7\xf5es"},buttons:{add:"Adicionar Resposta R\xe1pida"},toasts:{deleted:"Resposta R\xe1pida exclu\xedda com sucesso."},searchPlaceholder:"Pesquisar...",confirmationModal:{deleteTitle:"Voc\xea tem certeza que quer excluir esta Resposta R\xe1pida: ",deleteMessage:"Esta a\xe7\xe3o n\xe3o pode ser revertida."}},users:{title:"Usu\xe1rios",table:{name:"Nome",email:"Email",profile:"Perfil",whatsapp:"Conex\xe3o Padr\xe3o",actions:"A\xe7\xf5es"},buttons:{add:"Adicionar usu\xe1rio"},toasts:{deleted:"Usu\xe1rio exclu\xeddo com sucesso."},confirmationModal:{deleteTitle:"Excluir",deleteMessage:"Todos os dados do usu\xe1rio ser\xe3o perdidos. Os tickets abertos deste usu\xe1rio ser\xe3o movidos para a fila."}},tags:{title:"Tags",confirmationModal:{deleteTitle:"Voc\xea tem certeza que quer excluir esta Tag?",deleteMessage:"Esta a\xe7\xe3o n\xe3o pode ser revertida."},table:{name:"Nome",color:"Cor",tickets:"Registros Tagdos",actions:"A\xe7\xf5es"},buttons:{add:"Nova Tag"},toasts:{deleted:"Tag exclu\xeddo com sucesso."}},settings:{success:"Configura\xe7\xf5es salvas com sucesso.",title:"Configura\xe7\xf5es",settings:{userCreation:{name:"Cria\xe7\xe3o de usu\xe1rio",options:{enabled:"Ativado",disabled:"Desativado"}},timeCreateNewTicket:{name:"Mensagem de boas-vindas ap\xf3s",note:"Selecione o tempo que ser\xe1 necess\xe1rio para abrir um novo ticket, caso o cliente entre em contatos novamente",options:{10:"10 Segundos",30:"30 Segundos",60:"1 minuto",300:"5 minutos",1800:"30 minutos",3600:"1 hora",7200:"2 horas",21600:"6 horas",43200:"12 horas",86400:"24 horas",172800:"48 horas"}},call:{name:"Aceitar chamadas",options:{enabled:"Ativado",disabled:"Desativado"}},CheckMsgIsGroup:{name:"Ignorar Mensagens de Grupos",options:{enabled:"Ativado",disabled:"Desativado"}}}},messagesList:{header:{assignedTo:"Atribu\xeddo \xe0:",buttons:{return:"Retornar",resolve:"Resolver",reopen:"Reabrir",accept:"Aceitar"}}},messagesInput:{placeholderOpen:"Digite uma mensagem ou tecle ''/'' para utilizar as respostas r\xe1pidas cadastrada",placeholderClosed:"Reabra ou aceite esse ticket para enviar uma mensagem.",signMessage:"Assinar"},contactDrawer:{header:"Dados do contato",buttons:{edit:"Editar contato"},extraInfo:"Outras informa\xe7\xf5es"},ticketOptionsMenu:{delete:"Deletar",transfer:"Transferir",confirmationModal:{title:"Deletar o ticket do contato",message:"Aten\xe7\xe3o! Todas as mensagens relacionadas ao ticket ser\xe3o perdidas."},buttons:{delete:"Excluir",cancel:"Cancelar"}},confirmationModal:{buttons:{confirm:"Ok",cancel:"Cancelar"}},messageOptionsMenu:{delete:"Deletar",reply:"Responder",confirmationModal:{title:"Apagar mensagem?",message:"Esta a\xe7\xe3o n\xe3o pode ser revertida."}},backendErrors:{ERR_TAG_NAME_ALREADY_EXISTS:"J\xe1 existe uma tag com esse nome.",ERR_NO_OTHER_WHATSAPP:"Deve haver pelo menos um WhatsApp padr\xe3o.",ERR_NO_DEF_WAPP_FOUND:"Nenhum WhatsApp padr\xe3o encontrado. Verifique a p\xe1gina de conex\xf5es.",ERR_WAPP_NOT_INITIALIZED:"Esta sess\xe3o do WhatsApp n\xe3o foi inicializada. Verifique a p\xe1gina de conex\xf5es.",ERR_WAPP_CHECK_CONTACT:"N\xe3o foi poss\xedvel verificar o contato do WhatsApp. Verifique a p\xe1gina de conex\xf5es",ERR_WAPP_INVALID_CONTACT:"Este n\xe3o \xe9 um n\xfamero de Whatsapp v\xe1lido.",ERR_WAPP_DOWNLOAD_MEDIA:"N\xe3o foi poss\xedvel baixar m\xeddia do WhatsApp. Verifique a p\xe1gina de conex\xf5es.",ERR_INVALID_CREDENTIALS:"Erro de autentica\xe7\xe3o. Por favor, tente novamente.",ERR_SENDING_WAPP_MSG:"Erro ao enviar mensagem do WhatsApp. Verifique a p\xe1gina de conex\xf5es.",ERR_DELETE_WAPP_MSG:"N\xe3o foi poss\xedvel excluir a mensagem do WhatsApp.",ERR_OTHER_OPEN_TICKET:"J\xe1 existe um t\xedquete aberto para este contato.",ERR_SESSION_EXPIRED:"Sess\xe3o expirada. Por favor entre.",ERR_USER_CREATION_DISABLED:"A cria\xe7\xe3o do usu\xe1rio foi desabilitada pelo administrador.",ERR_NO_PERMISSION:"Voc\xea n\xe3o tem permiss\xe3o para acessar este recurso.",ERR_DUPLICATED_CONTACT:"J\xe1 existe um contato com este n\xfamero.",ERR_NO_SETTING_FOUND:"Nenhuma configura\xe7\xe3o encontrada com este ID.",ERR_NO_CONTACT_FOUND:"Nenhum contato encontrado com este ID.",ERR_NO_TICKET_FOUND:"Nenhum t\xedquete encontrado com este ID.",ERR_NO_USER_FOUND:"Nenhum usu\xe1rio encontrado com este ID.",ERR_NO_WAPP_FOUND:"Nenhum WhatsApp encontrado com este ID.",ERR_CREATING_MESSAGE:"Erro ao criar mensagem no banco de dados.",ERR_CREATING_TICKET:"Erro ao criar t\xedquete no banco de dados.",ERR_FETCH_WAPP_MSG:"Erro ao buscar a mensagem no WhtasApp, talvez ela seja muito antiga.",ERR_QUEUE_COLOR_ALREADY_EXISTS:"Esta cor j\xe1 est\xe1 em uso, escolha outra.",ERR_WAPP_GREETING_REQUIRED:"A mensagem de sauda\xe7\xe3o \xe9 obrigat\xf3rio quando h\xe1 mais de uma fila."}}},en:{translations:{signup:{title:"Sign up",toasts:{success:"User created successfully! Please login!",fail:"Error creating user. Check the reported data."},form:{name:"Name",email:"Email",password:"Password"},buttons:{submit:"Register",login:"Already have an account? Log in!"}},login:{title:"Login",form:{email:"Email",password:"Password"},buttons:{submit:"Enter",register:"Don't have an account? Register!"}},auth:{toasts:{success:"Login successfully!"}},dashboard:{charts:{perDay:{title:"Tickets today: "}},messages:{inAttendance:{title:"In Service"},waiting:{title:"Waiting"},closed:{title:"Closed"}}},connections:{title:"Connections",toasts:{deleted:"WhatsApp connection deleted sucessfully!"},confirmationModal:{deleteTitle:"Delete",deleteMessage:"Are you sure? It cannot be reverted.",disconnectTitle:"Disconnect",disconnectMessage:"Are you sure? You'll need to read QR Code again."},buttons:{add:"Add WhatsApp",disconnect:"Disconnect",tryAgain:"Try Again",qrcode:"QR CODE",newQr:"New QR CODE",connecting:"Connectiing"},toolTips:{disconnected:{title:"Failed to start WhatsApp session",content:"Make sure your cell phone is connected to the internet and try again, or request a new QR Code"},qrcode:{title:"Waiting for QR Code read",content:"Click on 'QR CODE' button and read the QR Code with your cell phone to start session"},connected:{title:"Connection established"},timeout:{title:"Connection with cell phone has been lost",content:"Make sure your cell phone is connected to the internet and WhatsApp is open, or click on 'Disconnect' button to get a new QRcode"}},table:{name:"Name",status:"Status",lastUpdate:"Last Update",default:"Default",actions:"Actions",session:"Session"}},whatsappModal:{title:{add:"Add WhatsApp",edit:"Edit WhatsApp"},form:{name:"Name",default:"Default"},buttons:{okAdd:"Add",okEdit:"Save",cancel:"Cancel"},success:"WhatsApp saved successfully."},qrCode:{message:"Read QrCode to start the session"},contacts:{title:"Contacts",toasts:{deleted:"Contact deleted sucessfully!"},searchPlaceholder:"Search ...",confirmationModal:{deleteTitle:"Delete",importTitlte:"Import contacts",deleteMessage:"Are you sure you want to delete this contact? All related tickets will be lost.",importMessage:"Do you want to import all contacts from the phone?"},buttons:{import:"Import Contacts",add:"Add Contact"},table:{name:"Name",whatsapp:"WhatsApp",email:"Email",actions:"Actions"}},contactModal:{title:{add:"Add contact",edit:"Edit contact"},form:{mainInfo:"Contact details",extraInfo:"Additional information",name:"Name",number:"Whatsapp number",email:"Email",extraName:"Field name",extraValue:"Value"},buttons:{addExtraInfo:"Add information",okAdd:"Add",okEdit:"Save",cancel:"Cancel"},success:"Contact saved successfully."},quickAnswersModal:{title:{add:"Add Quick Reply",edit:"Edit Quick Answer"},form:{shortcut:"Shortcut",message:"Quick Reply"},buttons:{okAdd:"Add",okEdit:"Save",cancel:"Cancel"},success:"Quick Reply saved successfully."},queueModal:{title:{add:"Add queue",edit:"Edit queue"},form:{name:"Name",color:"Color",greetingMessage:"Greeting Message"},buttons:{okAdd:"Add",okEdit:"Save",cancel:"Cancel"}},userModal:{title:{add:"Add user",edit:"Edit user"},form:{name:"Name",email:"Email",password:"Password",profile:"Profile",whatsapp:"Default Connection"},buttons:{okAdd:"Add",okEdit:"Save",cancel:"Cancel"},success:"User saved successfully."},chat:{noTicketMessage:"Select a ticket to start chatting."},ticketsManager:{buttons:{newTicket:"New"}},ticketsQueueSelect:{placeholder:"Queues"},tickets:{toasts:{deleted:"The ticket you were on has been deleted."},notification:{message:"Message from"},tabs:{open:{title:"Inbox"},closed:{title:"Resolved"},search:{title:"Search"}},search:{placeholder:"Search tickets and messages."},buttons:{showAll:"All"}},transferTicketModal:{title:"Transfer Ticket",fieldLabel:"Type to search for users",fieldQueueLabel:"Transfer to queue",fieldConnectionLabel:"Transfer to connection",fieldQueuePlaceholder:"Please select a queue",fieldConnectionPlaceholder:"Please select a connection",noOptions:"No user found with this name",buttons:{ok:"Transfer",cancel:"Cancel"}},ticketsList:{pendingHeader:"Queue",assignedHeader:"Working on",noTicketsTitle:"Nothing here!",noTicketsMessage:"No tickets found with this status or search term.",connectionTitle:"Connection that is currently being used.",buttons:{accept:"Accept"}},newTicketModal:{title:"Create Ticket",fieldLabel:"Type to search for a contact",add:"Add",buttons:{ok:"Save",cancel:"Cancel"}},mainDrawer:{listItems:{dashboard:"Dashboard",connections:"Connections",tickets:"Tickets",contacts:"Contacts",quickAnswers:"Quick Answers",queues:"Queues",administration:"Administration",users:"Users",settings:"Settings"},appBar:{user:{profile:"Profile",logout:"Logout"}}},notifications:{noTickets:"No notifications."},queues:{title:"Queues",table:{name:"Name",color:"Color",greeting:"Greeting message",actions:"Actions"},buttons:{add:"Add queue"},confirmationModal:{deleteTitle:"Delete",deleteMessage:"Are you sure? It cannot be reverted! Tickets in this queue will still exist, but will not have any queues assigned."}},queueSelect:{inputLabel:"Queues"},quickAnswers:{title:"Quick Answers",table:{shortcut:"Shortcut",message:"Quick Reply",actions:"Actions"},buttons:{add:"Add Quick Reply"},toasts:{deleted:"Quick Reply deleted successfully."},searchPlaceholder:"Search...",confirmationModal:{deleteTitle:"Are you sure you want to delete this Quick Reply: ",deleteMessage:"This action cannot be undone."}},users:{title:"Users",table:{name:"Name",email:"Email",profile:"Profile",whatsapp:"Default Connection",actions:"Actions"},buttons:{add:"Add user"},toasts:{deleted:"User deleted sucessfully."},confirmationModal:{deleteTitle:"Delete",deleteMessage:"All user data will be lost. Users' open tickets will be moved to queue."}},settings:{success:"Settings saved successfully.",title:"Settings",settings:{userCreation:{name:"User creation",options:{enabled:"Enabled",disabled:"Disabled"}}}},messagesList:{header:{assignedTo:"Assigned to:",buttons:{return:"Return",resolve:"Resolve",reopen:"Reopen",accept:"Accept"}}},messagesInput:{placeholderOpen:"Type a message or press ''/'' to use the registered quick responses",placeholderClosed:"Reopen or accept this ticket to send a message.",signMessage:"Sign"},contactDrawer:{header:"Contact details",buttons:{edit:"Edit contact"},extraInfo:"Other information"},ticketOptionsMenu:{delete:"Delete",transfer:"Transfer",confirmationModal:{title:"Delete ticket #",titleFrom:"from contact ",message:"Attention! All ticket's related messages will be lost."},buttons:{delete:"Delete",cancel:"Cancel"}},confirmationModal:{buttons:{confirm:"Ok",cancel:"Cancel"}},messageOptionsMenu:{delete:"Delete",reply:"Reply",confirmationModal:{title:"Delete message?",message:"This action cannot be reverted."}},backendErrors:{ERR_NO_OTHER_WHATSAPP:"There must be at lest one default WhatsApp connection.",ERR_NO_DEF_WAPP_FOUND:"No default WhatsApp found. Check connections page.",ERR_WAPP_NOT_INITIALIZED:"This WhatsApp session is not initialized. Check connections page.",ERR_WAPP_CHECK_CONTACT:"Could not check WhatsApp contact. Check connections page.",ERR_WAPP_INVALID_CONTACT:"This is not a valid whatsapp number.",ERR_WAPP_DOWNLOAD_MEDIA:"Could not download media from WhatsApp. Check connections page.",ERR_INVALID_CREDENTIALS:"Authentication error. Please try again.",ERR_SENDING_WAPP_MSG:"Error sending WhatsApp message. Check connections page.",ERR_DELETE_WAPP_MSG:"Couldn't delete message from WhatsApp.",ERR_OTHER_OPEN_TICKET:"There's already an open ticket for this contact.",ERR_SESSION_EXPIRED:"Session expired. Please login.",ERR_USER_CREATION_DISABLED:"User creation was disabled by administrator.",ERR_NO_PERMISSION:"You don't have permission to access this resource.",ERR_DUPLICATED_CONTACT:"A contact with this number already exists.",ERR_NO_SETTING_FOUND:"No setting found with this ID.",ERR_NO_CONTACT_FOUND:"No contact found with this ID.",ERR_NO_TICKET_FOUND:"No ticket found with this ID.",ERR_NO_USER_FOUND:"No user found with this ID.",ERR_NO_WAPP_FOUND:"No WhatsApp found with this ID.",ERR_CREATING_MESSAGE:"Error while creating message on database.",ERR_CREATING_TICKET:"Error while creating ticket on database.",ERR_FETCH_WAPP_MSG:"Error fetching the message in WhtasApp, maybe it is too old.",ERR_QUEUE_COLOR_ALREADY_EXISTS:"This color is already in use, pick another one.",ERR_WAPP_GREETING_REQUIRED:"Greeting message is required if there is more than one queue."}}},es:{translations:{signup:{title:"Registro",toasts:{success:"\xa1El usuario ha sido creado satisfactoriamente! \xa1Ahora inicia sesi\xf3n!",fail:"Error creando el usuario. Verifica la data reportada."},form:{name:"Nombre",email:"Correo Electr\xf3nico",password:"Contrase\xf1a"},buttons:{submit:"Reg\xedstrate",login:"\xbfYa tienes una cuenta? \xa1Inicia sesi\xf3n!"}},login:{title:"Inicio de Sesi\xf3n",form:{email:"Correo Electr\xf3nico",password:"Contrase\xf1a"},buttons:{submit:"Ingresa",register:"\xbfNo tienes cuenta? \xa1Reg\xedstrate!"}},auth:{toasts:{success:"\xa1Inicio de sesi\xf3n exitoso!"}},dashboard:{charts:{perDay:{title:"Tickets hoy: "}},messages:{inAttendance:{title:"En servicio"},waiting:{title:"Esperando"},closed:{title:"Finalizado"}}},connections:{title:"Conexiones",toasts:{deleted:"\xa1La conexi\xf3n de WhatsApp ha sido borrada satisfactoriamente!"},confirmationModal:{deleteTitle:"Borrar",deleteMessage:"\xbfEst\xe1s seguro? Este proceso no puede ser revertido.",disconnectTitle:"Desconectar",disconnectMessage:"Est\xe1s seguro? Deber\xe1 volver a leer el c\xf3digo QR"},buttons:{add:"Agrega WhatsApp",disconnect:"Desconectar",tryAgain:"Int\xe9ntalo de nuevo",qrcode:"QR CODE",newQr:"Nuevo QR CODE",connecting:"Conectando"},toolTips:{disconnected:{title:"No se pudo iniciar la sesi\xf3n de WhatsApp",content:"Aseg\xfarese de que su tel\xe9fono celular est\xe9 conectado a Internet y vuelva a intentarlo o solicite un nuevo c\xf3digo QR"},qrcode:{title:"Esperando la lectura del c\xf3digo QR",content:"Haga clic en el bot\xf3n 'C\xd3DIGO QR' y lea el C\xf3digo QR con su tel\xe9fono celular para iniciar la sesi\xf3n"},connected:{title:"Conexi\xf3n establecida"},timeout:{title:"Se perdi\xf3 la conexi\xf3n con el tel\xe9fono celular",content:"Aseg\xfarese de que su tel\xe9fono celular est\xe9 conectado a Internet y que WhatsApp est\xe9 abierto, o haga clic en el bot\xf3n 'Desconectar' para obtener un nuevo c\xf3digo QR"}},table:{name:"Nombre",status:"Estado",lastUpdate:"\xdaltima Actualizaci\xf3n",default:"Por Defecto",actions:"Acciones",session:"Sesi\xf3n"}},whatsappModal:{title:{add:"Agrega WhatsApp",edit:"Edita WhatsApp"},form:{name:"Nombre",default:"Por Defecto"},buttons:{okAdd:"Agregar",okEdit:"Guardar",cancel:"Cancelar"},success:"WhatsApp guardado satisfactoriamente."},qrCode:{message:"L\xe9e el c\xf3digo QR para empezar la sesi\xf3n."},contacts:{title:"Contactos",toasts:{deleted:"\xa1Contacto borrado satisfactoriamente!"},searchPlaceholder:"Buscar...",confirmationModal:{deleteTitle:"Borrar",importTitlte:"Importar contactos",deleteMessage:"\xbfEst\xe1s seguro que deseas borrar este contacto? Todos los tickets relacionados se perder\xe1n.",importMessage:"\xbfQuieres importar todos los contactos desde tu tel\xe9fono?"},buttons:{import:"Importar Contactos",add:"Agregar Contacto"},table:{name:"Nombre",whatsapp:"WhatsApp",email:"Correo Electr\xf3nico",actions:"Acciones"}},contactModal:{title:{add:"Agregar contacto",edit:"Editar contacto"},form:{mainInfo:"Detalles del contacto",extraInfo:"Informaci\xf3n adicional",name:"Nombre",number:"N\xfamero de Whatsapp",email:"Correo Electr\xf3nico",extraName:"Nombre del Campo",extraValue:"Valor"},buttons:{addExtraInfo:"Agregar informaci\xf3n",okAdd:"Agregar",okEdit:"Guardar",cancel:"Cancelar"},success:"Contacto guardado satisfactoriamente."},quickAnswersModal:{title:{add:"Agregar respuesta r\xe1pida",edit:"Editar respuesta r\xe1pida"},form:{shortcut:"Atajo",message:"Respuesta r\xe1pida"},buttons:{okAdd:"Agregar",okEdit:"Guardar",cancel:"Cancelar"},success:"Respuesta r\xe1pida guardada correctamente."},queueModal:{title:{add:"Agregar cola",edit:"Editar cola"},form:{name:"Nombre",color:"Color",greetingMessage:"Mensaje de saludo"},buttons:{okAdd:"A\xf1adir",okEdit:"Ahorrar",cancel:"Cancelar"}},userModal:{title:{add:"Agregar usuario",edit:"Editar usuario"},form:{name:"Nombre",email:"Correo Electr\xf3nico",password:"Contrase\xf1a",profile:"Perfil",whatsapp:"Conexi\xf3n est\xe1ndar"},buttons:{okAdd:"Agregar",okEdit:"Guardar",cancel:"Cancelar"},success:"Usuario guardado satisfactoriamente."},chat:{noTicketMessage:"Selecciona un ticket para empezar a chatear."},ticketsManager:{buttons:{newTicket:"Nuevo"}},ticketsQueueSelect:{placeholder:"Linhas"},tickets:{toasts:{deleted:"El ticket en el que estabas ha sido borrado."},notification:{message:"Mensaje de"},tabs:{open:{title:"Bandeja"},closed:{title:"Resueltos"},search:{title:"Buscar"}},search:{placeholder:"Buscar tickets y mensajes."},buttons:{showAll:"Todos"}},transferTicketModal:{title:"Transferir Ticket",fieldLabel:"Escriba para buscar usuarios",fieldQueueLabel:"Transferir a la cola",fieldConnectionLabel:"Transferir to conexi\xf3n",fieldQueuePlaceholder:"Seleccione una cola",fieldConnectionPlaceholder:"Seleccione una conexi\xf3n",noOptions:"No se encontraron usuarios con ese nombre",buttons:{ok:"Transferir",cancel:"Cancelar"}},ticketsList:{pendingHeader:"Cola",assignedHeader:"Trabajando en",noTicketsTitle:"\xa1Nada ac\xe1!",connectionTitle:"Conexi\xf3n que se est\xe1 utilizando actualmente.",noTicketsMessage:"No se encontraron tickets con este estado o t\xe9rmino de b\xfasqueda",buttons:{accept:"Acceptar"}},newTicketModal:{title:"Crear Ticket",fieldLabel:"Escribe para buscar un contacto",add:"A\xf1adir",buttons:{ok:"Guardar",cancel:"Cancelar"}},mainDrawer:{listItems:{dashboard:"Dashboard",connections:"Conexiones",tickets:"Tickets",contacts:"Contactos",quickAnswers:"Respuestas r\xe1pidas",queues:"Linhas",administration:"Administraci\xf3n",users:"Usuarios",settings:"Configuraci\xf3n"},appBar:{user:{profile:"Perfil",logout:"Cerrar Sesi\xf3n"}}},notifications:{noTickets:"Sin notificaciones."},queues:{title:"Linhas",table:{name:"Nombre",color:"Color",greeting:"Mensaje de saludo",actions:"Comportamiento"},buttons:{add:"Agregar cola"},confirmationModal:{deleteTitle:"Eliminar",deleteMessage:"\xbfEst\xe1s seguro? \xa1Esta acci\xf3n no se puede revertir! Los tickets en esa cola seguir\xe1n existiendo, pero ya no tendr\xe1n ninguna cola asignada."}},queueSelect:{inputLabel:"Linhas"},quickAnswers:{title:"Respuestas r\xe1pidas",table:{shortcut:"Atajo",message:"Respuesta r\xe1pida",actions:"Acciones"},buttons:{add:"Agregar respuesta r\xe1pida"},toasts:{deleted:"Respuesta r\xe1pida eliminada correctamente"},searchPlaceholder:"Buscar ...",confirmationModal:{deleteTitle:"\xbfEst\xe1 seguro de que desea eliminar esta respuesta r\xe1pida?",deleteMessage:"Esta acci\xf3n no se puede deshacer."}},users:{title:"Usuarios",table:{name:"Nombre",email:"Correo Electr\xf3nico",profile:"Perfil",whatsapp:"Conexi\xf3n est\xe1ndar",actions:"Acciones"},buttons:{add:"Agregar usuario"},toasts:{deleted:"Usuario borrado satisfactoriamente."},confirmationModal:{deleteTitle:"Borrar",deleteMessage:"Toda la informaci\xf3n del usuario se perder\xe1. Los tickets abiertos de los usuarios se mover\xe1n a la cola."}},settings:{success:"Configuraci\xf3n guardada satisfactoriamente.",title:"Configuraci\xf3n",settings:{userCreation:{name:"Creaci\xf3n de usuarios",options:{enabled:"Habilitado",disabled:"Deshabilitado"}}}},messagesList:{header:{assignedTo:"Asignado a:",buttons:{return:"Devolver",resolve:"Resolver",reopen:"Reabrir",accept:"Aceptar"}}},messagesInput:{placeholderOpen:"Escriba un mensaje o presione '' / '' para usar las respuestas r\xe1pidas registradas",placeholderClosed:"Vuelva a abrir o acepte este ticket para enviar un mensaje.",signMessage:"Firmar"},contactDrawer:{header:"Detalles del contacto",buttons:{edit:"Editar contacto"},extraInfo:"Otra informaci\xf3n"},ticketOptionsMenu:{delete:"Borrar",transfer:"Transferir",confirmationModal:{title:"\xbfBorrar ticket #",titleFrom:"del contacto ",message:"\xa1Atenci\xf3n! Todos los mensajes Todos los mensajes relacionados con el ticket se perder\xe1n."},buttons:{delete:"Borrar",cancel:"Cancelar"}},confirmationModal:{buttons:{confirm:"Ok",cancel:"Cancelar"}},messageOptionsMenu:{delete:"Borrar",reply:"Responder",confirmationModal:{title:"\xbfBorrar mensaje?",message:"Esta acci\xf3n no puede ser revertida."}},backendErrors:{ERR_NO_OTHER_WHATSAPP:"Debe haber al menos una conexi\xf3n de WhatsApp predeterminada.",ERR_NO_DEF_WAPP_FOUND:"No se encontr\xf3 WhatsApp predeterminado. Verifique la p\xe1gina de conexiones.",ERR_WAPP_NOT_INITIALIZED:"Esta sesi\xf3n de WhatsApp no \u200b\u200best\xe1 inicializada. Verifique la p\xe1gina de conexiones.",ERR_WAPP_CHECK_CONTACT:"No se pudo verificar el contacto de WhatsApp. Verifique la p\xe1gina de conexiones.",ERR_WAPP_INVALID_CONTACT:"Este no es un n\xfamero de whatsapp v\xe1lido.",ERR_WAPP_DOWNLOAD_MEDIA:"No se pudieron descargar los medios de WhatsApp. Verifique la p\xe1gina de conexiones.",ERR_INVALID_CREDENTIALS:"Error de autenticaci\xf3n. Vuelva a intentarlo.",ERR_SENDING_WAPP_MSG:"Error al enviar el mensaje de WhatsApp. Verifique la p\xe1gina de conexiones.",ERR_DELETE_WAPP_MSG:"No se pudo borrar el mensaje de WhatsApp.",ERR_OTHER_OPEN_TICKET:"Ya hay un ticket abierto para este contacto.",ERR_SESSION_EXPIRED:"Sesi\xf3n caducada. Inicie sesi\xf3n.",ERR_USER_CREATION_DISABLED:"La creaci\xf3n de usuarios fue deshabilitada por el administrador.",ERR_NO_PERMISSION:"No tienes permiso para acceder a este recurso.",ERR_DUPLICATED_CONTACT:"Ya existe un contacto con este n\xfamero.",ERR_NO_SETTING_FOUND:"No se encontr\xf3 ninguna configuraci\xf3n con este ID.",ERR_NO_CONTACT_FOUND:"No se encontr\xf3 ning\xfan contacto con este ID.",ERR_NO_TICKET_FOUND:"No se encontr\xf3 ning\xfan ticket con este ID.",ERR_NO_USER_FOUND:"No se encontr\xf3 ning\xfan usuario con este ID.",ERR_NO_WAPP_FOUND:"No se encontr\xf3 WhatsApp con este ID.",ERR_CREATING_MESSAGE:"Error al crear el mensaje en la base de datos.",ERR_CREATING_TICKET:"Error al crear el ticket en la base de datos.",ERR_FETCH_WAPP_MSG:"Error al obtener el mensaje en WhtasApp, tal vez sea demasiado antiguo.",ERR_QUEUE_COLOR_ALREADY_EXISTS:"Este color ya est\xe1 en uso, elija otro.",ERR_WAPP_GREETING_REQUIRED:"El mensaje de saludo es obligatorio cuando hay m\xe1s de una cola."}}}};h.a.use(b.a).init({debug:!1,defaultNS:["translations"],fallbackLng:"en",ns:["translations"],resources:f});var v=a(496);var y=a.n(v).a.create({baseURL:g(),withCredentials:!0});var C=e=>{var t,a;const n=(null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||e.response.data.error;n?h.a.exists("backendErrors.".concat(n))?d.b.error(h.a.t("backendErrors.".concat(n)),{toastId:n}):d.b.error(n,{toastId:n}):d.b.error("An error occurred!")};var k=()=>{const e=Object(i.g)(),[t,a]=Object(n.useState)(!1),[o,r]=Object(n.useState)(!0),[l,s]=Object(n.useState)({});y.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(JSON.parse(t)),a(!0)),e},e=>{Promise.reject(e)}),y.interceptors.response.use(e=>e,async e=>{var t,n;const o=e.config;if(403===(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)&&!o._retry){o._retry=!0;const{data:e}=await y.post("/auth/refresh_token");return e&&(localStorage.setItem("token",JSON.stringify(e.token)),y.defaults.headers.Authorization="Bearer ".concat(e.token)),y(o)}return 401===(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status)&&(localStorage.removeItem("token"),y.defaults.headers.Authorization=void 0,a(!1)),Promise.reject(e)}),Object(n.useEffect)(()=>{const e=localStorage.getItem("token");(async()=>{if(e)try{const{data:e}=await y.post("/auth/refresh_token");y.defaults.headers.Authorization="Bearer ".concat(e.token),a(!0),s(e.user)}catch(t){C(t)}r(!1)})()},[]),Object(n.useEffect)(()=>{const e=E();return e.on("user",e=>{"update"===e.action&&e.user.id===l.id&&s(e.user)}),()=>{e.disconnect()}},[l]);return{isAuth:t,user:l,loading:o,handleLogin:async t=>{r(!0);try{const{data:n}=await y.post("/auth/login",t);localStorage.setItem("token",JSON.stringify(n.token)),y.defaults.headers.Authorization="Bearer ".concat(n.token),s(n.user),a(!0),d.b.success(h.a.t("auth.toasts.success")),e.push("/tickets"),r(!1)}catch(n){C(n),r(!1)}},handleLogout:async()=>{r(!0);try{await y.delete("/auth/logout"),a(!1),s({}),localStorage.removeItem("token"),y.defaults.headers.Authorization=void 0,r(!1),e.push("/login")}catch(t){C(t),r(!1)}}}};const O=Object(n.createContext)(),w=e=>{let{children:t}=e;const{loading:a,user:n,isAuth:r,handleLogin:l,handleLogout:s}=k();return o.a.createElement(O.Provider,{value:{loading:a,user:n,isAuth:r,handleLogin:l,handleLogout:s}},t)},T=(e,t)=>{if("LOAD_WHATSAPPS"===t.type){return[...t.payload]}if("UPDATE_WHATSAPPS"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,[...e]):[a,...e]}if("UPDATE_SESSION"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n].status=a.status,e[n].updatedAt=a.updatedAt,e[n].qrcode=a.qrcode,e[n].retries=a.retries,[...e]):[...e]}if("DELETE_WHATSAPPS"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]};var x=()=>{const[e,t]=Object(n.useReducer)(T,[]),[a,o]=Object(n.useState)(!0);return Object(n.useEffect)(()=>{o(!0);(async()=>{try{const{data:e}=await y.get("/whatsapp/");t({type:"LOAD_WHATSAPPS",payload:e}),o(!1)}catch(e){o(!1),C(e)}})()},[]),Object(n.useEffect)(()=>{const e=E();return e.on("whatsapp",e=>{"update"===e.action&&t({type:"UPDATE_WHATSAPPS",payload:e.whatsapp})}),e.on("whatsapp",e=>{"delete"===e.action&&t({type:"DELETE_WHATSAPPS",payload:e.whatsappId})}),e.on("whatsappSession",e=>{"update"===e.action&&t({type:"UPDATE_SESSION",payload:e.session})}),()=>{e.disconnect()}},[]),{whatsApps:e,loading:a}};const S=Object(n.createContext)(),A=e=>{let{children:t}=e;const{loading:a,whatsApps:n}=x();return o.a.createElement(S.Provider,{value:{whatsApps:n,loading:a}},t)};var N=a(3),M=a(940),I=a(1014),R=a(884),j=a(935),D=a(946),P=a(956),W=a(957),_=a(98),q=a(551),L=a(947),B=a(519),F=a.n(B),z=a(518),U=a.n(z),H=a(520),Q=a.n(H),G=a(934),V=a(881),K=a(932),Y=a(933),J=a(936),X=a(937),Z=a(938),$=a(939),ee=a(505),te=a.n(ee),ae=a(502),ne=a.n(ae),oe=a(500),re=a.n(oe),le=a(506),se=a.n(le),ce=a(507),ie=a.n(ce),de=a(504),me=a.n(de),ue=a(503),pe=a.n(ue),ge=a(508),Ee=a.n(ge),he=a(501),be=a.n(he),fe=a(263),ve=a.n(fe);var ye={user:{static:[]},admin:{static:["drawer-admin-items:view","tickets-manager:showall","user-modal:editProfile","user-modal:editQueues","ticket-options:deleteTicket","ticket-options:transferWhatsapp","contacts-page:deleteContact"]}};const Ce=e=>{let{role:t,perform:a,data:n,yes:o,no:r}=e;return((e,t,a)=>{const n=ye[e];if(!n)return!1;const o=n.static;if(o&&o.includes(t))return!0;const r=n.dynamic;if(r){const e=r[t];return!!e&&e(a)}return!1})(t,a,n)?o():r()};function ke(e){const{icon:t,primary:a,to:n,className:r}=e,l=o.a.useMemo(()=>o.a.forwardRef((e,t)=>o.a.createElement(c.b,Object.assign({to:n,ref:t},e))),[n]);return o.a.createElement("li",null,o.a.createElement(V.a,{button:!0,component:l,className:r},t?o.a.createElement(K.a,null,t):null,o.a.createElement(Y.a,{primary:a})))}Ce.defaultProps={yes:()=>null,no:()=>null};var Oe=e=>{const{drawerClose:t}=e,{whatsApps:a}=Object(n.useContext)(S),{user:r}=Object(n.useContext)(O),[l,s]=Object(n.useState)(!1);return Object(n.useEffect)(()=>{const e=setTimeout(()=>{if(a.length>0){a.filter(e=>"qrcode"===e.status||"PAIRING"===e.status||"DISCONNECTED"===e.status||"TIMEOUT"===e.status||"OPENING"===e.status).length>0?s(!0):s(!1)}},2e3);return()=>clearTimeout(e)},[a]),o.a.createElement("div",{onClick:t},o.a.createElement(ke,{to:"/",primary:"Dashboard",icon:o.a.createElement(re.a,null)}),o.a.createElement(ke,{to:"/connections",primary:h.a.t("mainDrawer.listItems.connections"),icon:o.a.createElement(G.a,{overlap:"rectangular",badgeContent:l?"!":0,color:"error"},o.a.createElement(be.a,null))}),o.a.createElement(ke,{to:"/tickets",primary:h.a.t("mainDrawer.listItems.tickets"),icon:o.a.createElement(ve.a,null)}),o.a.createElement(ke,{to:"/contacts",primary:h.a.t("mainDrawer.listItems.contacts"),icon:o.a.createElement(ne.a,null)}),o.a.createElement(ke,{to:"/quickAnswers",primary:h.a.t("mainDrawer.listItems.quickAnswers"),icon:o.a.createElement(pe.a,null)}),o.a.createElement(Ce,{role:r.profile,perform:"drawer-admin-items:view",yes:()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(j.a,null),o.a.createElement(J.a,{inset:!0},h.a.t("mainDrawer.listItems.administration")),o.a.createElement(ke,{to:"/users",primary:h.a.t("mainDrawer.listItems.users"),icon:o.a.createElement(me.a,null)}),o.a.createElement(ke,{to:"/queues",primary:h.a.t("mainDrawer.listItems.queues"),icon:o.a.createElement(te.a,null)}),o.a.createElement(ke,{to:"/schedules",primary:h.a.t("mainDrawer.listItems.schedules"),icon:o.a.createElement(se.a,null)}),o.a.createElement(ke,{to:"/tags",primary:h.a.t("mainDrawer.listItems.tags"),icon:o.a.createElement(ie.a,null)}),o.a.createElement(ke,{to:"/BulkMessage",primary:"Bulk Message",icon:o.a.createElement(X.a,null)}),o.a.createElement(ke,{to:"/SettingsMessage",primary:"Configura\xe7\xf5es Envio",icon:o.a.createElement(Z.a,null)}),o.a.createElement(ke,{to:"/ShippingReport",primary:"Relat\xf3rio Envio",icon:o.a.createElement($.a,null)}),o.a.createElement(ke,{to:"/settings",primary:h.a.t("mainDrawer.listItems.settings"),icon:o.a.createElement(Ee.a,null)}))}))},we=a(999),Te=a(509),xe=a(945),Se=a(513),Ae=a.n(Se),Ne=a(1010),Me=a(1011),Ie=a(288),Re=a(944),je=a(1009),De=a(941),Pe=a(942);const We=Object(M.a)(e=>({button:{position:"relative"},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}));var _e=e=>{let{loading:t,children:a,...n}=e;const r=We();return o.a.createElement(De.a,Object.assign({className:r.button,disabled:t},n),a,t&&o.a.createElement(Pe.a,{size:24,className:r.buttonProgress}))},qe=a(510);const Le=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Be=["a","b","strong","em","u","code","del"],Fe=e=>{let{children:t,...a}=e;return o.a.createElement("a",Object.assign({},a,{target:"_blank",rel:"noopener noreferrer"}),t)};var ze=e=>{let{children:t}=e;const a=/\*(.*?)\*/g,n=/~(.*?)~/g;t&&t.includes("BEGIN:VCARD")&&(t=null),t&&t.includes("data:image/")&&(t=null),t&&a.test(t)&&(t=t.replace(a,"**$1**")),t&&n.test(t)&&(t=t.replace(n,"~~$1~~"));const r=o.a.useMemo(()=>{const e={disableParsingRawHTML:!0,forceInline:!0,overrides:{a:{component:Fe}}};return Le.forEach(t=>{Be.includes(t)||(e.overrides[t]=e=>e.children||null)}),e},[]);return t?o.a.createElement(qe.a,{options:r},t):null},Ue=a(943);const He=Object(M.a)(e=>({ticket:{position:"relative"},pendingTicket:{cursor:"unset"},noTicketsDiv:{display:"flex",height:"100px",margin:40,flexDirection:"column",alignItems:"center",justifyContent:"center"},noTicketsText:{textAlign:"center",color:"rgb(104, 121, 146)",fontSize:"14px",lineHeight:"1.4"},noTicketsTitle:{textAlign:"center",fontSize:"16px",fontWeight:"600",margin:"0px"},contactNameWrapper:{display:"flex",justifyContent:"space-between"},lastMessageTime:{justifySelf:"flex-end"},closedBadge:{alignSelf:"center",justifySelf:"flex-end",marginRight:32,marginLeft:"auto"},contactLastMessage:{paddingRight:20},newMessagesCount:{alignSelf:"center",marginRight:8,marginLeft:"auto"},badgeStyle:{color:"white",backgroundColor:Ie.a[500]},acceptButton:{position:"absolute",left:"50%"},ticketQueueColor:{flex:"none",width:"8px",height:"100%",position:"absolute",top:"0%",left:"0%"},userTag:{position:"absolute",marginRight:5,right:5,bottom:5,background:"#2576D2",color:"#ffffff",border:"1px solid #CCC",padding:1,paddingLeft:5,paddingRight:5,borderRadius:10,fontSize:"0.9em"}}));var Qe=e=>{var t,a,r,l;let{ticket:s}=e;const c=He(),d=Object(i.g)(),[m,u]=Object(n.useState)(!1),{ticketId:p}=Object(i.h)(),g=Object(n.useRef)(!0),{user:E}=Object(n.useContext)(O);Object(n.useEffect)(()=>()=>{g.current=!1},[]);return o.a.createElement(o.a.Fragment,{key:s.id},o.a.createElement(V.a,{dense:!0,button:!0,onClick:e=>{var t;"pending"!==s.status&&(t=s.id,d.push("/tickets/".concat(t)))},selected:p&&+p===s.id,className:Object(N.a)(c.ticket,{[c.pendingTicket]:"pending"===s.status})},o.a.createElement(Ue.a,{arrow:!0,placement:"right",title:(null===(t=s.queue)||void 0===t?void 0:t.name)||"Sem fila"},o.a.createElement("span",{style:{backgroundColor:(null===(a=s.queue)||void 0===a?void 0:a.color)||"#7C7C7C"},className:c.ticketQueueColor})),o.a.createElement(Re.a,null,o.a.createElement(je.a,{src:null===s||void 0===s||null===(r=s.contact)||void 0===r?void 0:r.profilePicUrl})),o.a.createElement(Y.a,{disableTypography:!0,primary:o.a.createElement("span",{className:c.contactNameWrapper},o.a.createElement(_.a,{noWrap:!0,component:"span",variant:"body2",color:"textPrimary"},s.contact.name),"closed"===s.status&&o.a.createElement(G.a,{className:c.closedBadge,badgeContent:"closed",color:"primary"}),s.lastMessage&&o.a.createElement(_.a,{className:c.lastMessageTime,component:"span",variant:"body2",color:"textSecondary"},Object(Ne.a)(Object(Me.a)(s.updatedAt),new Date)?o.a.createElement(o.a.Fragment,null,Object(we.a)(Object(Me.a)(s.updatedAt),"HH:mm")):o.a.createElement(o.a.Fragment,null,Object(we.a)(Object(Me.a)(s.updatedAt),"dd/MM/yyyy"))),s.whatsappId&&o.a.createElement("div",{className:c.userTag,title:h.a.t("ticketsList.connectionTitle")},null===(l=s.whatsapp)||void 0===l?void 0:l.name),"whatsapp"!==s.channel&&o.a.createElement("div",{className:c.userTag,title:h.a.t("ticketsList.connectionTitle")},s.channel)),secondary:o.a.createElement("span",{className:c.contactNameWrapper},o.a.createElement(_.a,{className:c.contactLastMessage,noWrap:!0,component:"span",variant:"body2",color:"textSecondary"},s.lastMessage?o.a.createElement(ze,null,s.lastMessage):o.a.createElement("br",null)),o.a.createElement(G.a,{className:c.newMessagesCount,badgeContent:s.unreadMessages,classes:{badge:c.badgeStyle}}))}),"pending"===s.status&&o.a.createElement(_e,{color:"primary",variant:"contained",className:c.acceptButton,size:"small",loading:m,onClick:e=>(async e=>{u(!0);try{await y.put("/tickets/".concat(e),{status:"open",userId:null===E||void 0===E?void 0:E.id})}catch(t){u(!1),C(t)}g.current&&u(!1),d.push("/tickets/".concat(e))})(s.id)},h.a.t("ticketsList.buttons.accept"))),o.a.createElement(j.a,{variant:"inset",component:"li"}))};var Ge=e=>{let{searchParam:t,pageNumber:a,status:o,date:r,showAll:l,queueIds:s,withUnreadMessages:c,tags:i}=e;const[d,m]=Object(n.useState)(!0),[u,g]=Object(n.useState)(!1),[E,h]=Object(n.useState)([]),[b,f]=Object(n.useState)(0);return Object(n.useEffect)(()=>{m(!0);const e=setTimeout(()=>{const e=async e=>{await y.put("/tickets/".concat(e.id),{status:"closed",userId:e.userId||null})};(async()=>{try{const{data:n}=await y.get("/tickets",{params:{searchParam:t,pageNumber:a,status:o,date:r,showAll:l,queueIds:s,withUnreadMessages:c,tags:i}});h(n.tickets);let d=p("REACT_APP_HOURS_CLOSE_TICKETS_AUTO");if("open"===o&&d&&""!==d&&"0"!==d&&Number(d)>0){let t=new Date;t.setHours(t.getHours()-Number(d)),n.tickets.forEach(a=>{if("closed"!==a.status){new Date(a.updatedAt)<t&&e(a)}})}g(n.hasMore),f(n.count),m(!1)}catch(n){m(!1),C(n)}})()},500);return()=>clearTimeout(e)},[t,a,o,r,l,s,c,i]),{tickets:E,loading:d,hasMore:u,count:b}},Ve=a(512),Ke=a.n(Ve);const Ye=Object(M.a)(e=>({tabContainer:{overflowY:"auto",maxHeight:350,...e.scrollbarStyles},popoverPaper:{width:"100%",maxWidth:350,marginLeft:e.spacing(2),marginRight:e.spacing(1),[e.breakpoints.down("sm")]:{maxWidth:270}},noShadow:{boxShadow:"none !important"}}));var Je=()=>{const e=Ye(),t=Object(i.g)(),{user:a}=Object(n.useContext)(O),r=+t.location.pathname.split("/")[2],l=Object(n.useRef)(r),s=Object(n.useRef)(),[c,d]=Object(n.useState)(!1),[m,u]=Object(n.useState)([]),[,p]=Object(n.useState)([]),{tickets:g}=Ge({withUnreadMessages:"true"}),[b]=Object(Te.a)(Ke.a),f=Object(n.useRef)(),v=Object(n.useRef)(t);Object(n.useEffect)(()=>{f.current=b,"Notification"in window?Notification.requestPermission():console.log("This browser doesn't support notifications")},[b]),Object(n.useEffect)(()=>{u(g)},[g]),Object(n.useEffect)(()=>{l.current=r},[r]),Object(n.useEffect)(()=>{const e=E();return e.on("ready",()=>e.emit("joinNotification")),e.on("ticket",e=>{"updateUnread"!==e.action&&"delete"!==e.action||(u(t=>{const a=t.findIndex(t=>t.id===e.ticketId);return-1!==a?(t.splice(a,1),[...t]):t}),p(t=>{const a=t.findIndex(t=>t.tag===String(e.ticketId));return-1!==a?(t[a].close(),t.splice(a,1),[...t]):t}))}),e.on("appMessage",e=>{if("create"===e.action&&!e.message.read&&(e.ticket.userId===(null===a||void 0===a?void 0:a.id)||!e.ticket.userId)){u(t=>{const a=t.findIndex(t=>t.id===e.ticket.id);return-1!==a?(t[a]=e.ticket,[...t]):[e.ticket,...t]});if(e.message.ticketId===l.current&&"visible"===document.visibilityState||e.ticket.userId&&e.ticket.userId!==(null===a||void 0===a?void 0:a.id)||e.ticket.isGroup)return;y(e)}}),()=>{e.disconnect()}},[a]);const y=e=>{const{message:t,contact:a,ticket:n}=e,o={body:"".concat(t.body," - ").concat(Object(we.a)(new Date,"HH:mm")),icon:a.profilePicUrl,tag:n.id,renotify:!0},r=new Notification("".concat(h.a.t("tickets.notification.message")," ").concat(a.name),o);r.onclick=e=>{e.preventDefault(),window.focus(),v.current.push("/tickets/".concat(n.id))},p(e=>{const t=e.findIndex(e=>e.tag===r.tag);return-1!==t?(e[t]=r,[...e]):[r,...e]}),f.current()},C=()=>{d(!1)},k=e=>{let{children:t}=e;return o.a.createElement("div",{onClick:C},t)};return o.a.createElement(o.a.Fragment,null,o.a.createElement(R.a,{onClick:()=>{d(e=>!e)},ref:s,"aria-label":"Open Notifications",color:"inherit"},o.a.createElement(G.a,{badgeContent:m.length,color:"secondary"},o.a.createElement(Ae.a,null))),o.a.createElement(xe.a,{disableScrollLock:!0,open:c,anchorEl:s.current,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},classes:{paper:e.popoverPaper},onClose:C},o.a.createElement(D.a,{dense:!0,className:e.tabContainer},0===m.length?o.a.createElement(V.a,null,o.a.createElement(Y.a,null,h.a.t("notifications.noTickets"))):m.map(e=>o.a.createElement(k,{key:e.id},o.a.createElement(Qe,{ticket:e}))))))},Xe=a(19),Ze=a(11),$e=a(948),et=a(949),tt=a(950),at=a(951),nt=a(952),ot=a(885),rt=a(886),lt=a(893),st=a(955),ct=a(953),it=a(954),dt=a(1013);const mt=Object(M.a)(e=>({chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2}}));var ut=e=>{let{selectedQueueIds:t,onChange:a}=e;const r=mt(),[l,s]=Object(n.useState)([]);Object(n.useEffect)(()=>{(async()=>{try{const{data:e}=await y.get("/queue");s(e)}catch(e){C(e)}})()},[]);return o.a.createElement("div",{style:{marginTop:6}},o.a.createElement(ot.a,{fullWidth:!0,margin:"dense",variant:"outlined"},o.a.createElement(rt.a,null,h.a.t("queueSelect.inputLabel")),o.a.createElement(lt.a,{multiple:!0,labelWidth:60,value:t,onChange:e=>{a(e.target.value)},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},getContentAnchorEl:null},renderValue:e=>o.a.createElement("div",{className:r.chips},(null===e||void 0===e?void 0:e.length)>0&&e.map(e=>{const t=l.find(t=>t.id===e);return t?o.a.createElement(dt.a,{key:e,style:{backgroundColor:t.color},variant:"outlined",label:t.name,className:r.chip}):null}))},l.map(e=>o.a.createElement(L.a,{key:e.id,value:e.id},e.name)))))};const pt=Object(M.a)(e=>({root:{display:"flex",flexWrap:"wrap"},multFieldLine:{display:"flex","& > *:not(:last-child)":{marginRight:e.spacing(1)}},btnWrapper:{position:"relative"},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},formControl:{margin:e.spacing(1),minWidth:120}})),gt=Xe.c().shape({name:Xe.d().min(2,"Too Short!").max(50,"Too Long!").required("Required"),password:Xe.d().min(5,"Too Short!").max(50,"Too Long!"),email:Xe.d().email("Invalid email").required("Required")});var Et=e=>{let{open:t,onClose:a,userId:r}=e;const l=pt(),s={name:"",email:"",password:"",profile:"user"},{user:c}=Object(n.useContext)(O),[i,m]=Object(n.useState)(s),[u,p]=Object(n.useState)([]),[g,E]=Object(n.useState)(!1),[b,f]=Object(n.useState)(!1),{loading:v,whatsApps:k}=x();Object(n.useEffect)(()=>{(async()=>{if(r)try{var e;const{data:t}=await y.get("/users/".concat(r));m(e=>({...e,...t}));const a=null===(e=t.queues)||void 0===e?void 0:e.map(e=>e.id);p(a),f(t.whatsappId?t.whatsappId:"")}catch(t){C(t)}})()},[r,t]);const w=()=>{a(),m(s)};return o.a.createElement("div",{className:l.root},o.a.createElement($e.a,{open:t,onClose:w,maxWidth:"xs",fullWidth:!0,scroll:"paper"},o.a.createElement(et.a,{id:"form-dialog-title"},"".concat(r?h.a.t("userModal.title.edit"):h.a.t("userModal.title.add"))),o.a.createElement(Ze.d,{initialValues:i,enableReinitialize:!0,validationSchema:gt,onSubmit:(e,t)=>{setTimeout(()=>{(async e=>{const t={...e,whatsappId:b,queueIds:u};try{r?await y.put("/users/".concat(r),t):await y.post("/users",t),d.b.success(h.a.t("userModal.success"))}catch(a){C(a)}w()})(e),t.setSubmitting(!1)},400)}},e=>{let{touched:t,errors:a,isSubmitting:n}=e;return o.a.createElement(Ze.c,null,o.a.createElement(tt.a,{dividers:!0},o.a.createElement("div",{className:l.multFieldLine},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("userModal.form.name"),autoFocus:!0,name:"name",error:t.name&&Boolean(a.name),helperText:t.name&&a.name,variant:"outlined",margin:"dense",fullWidth:!0}),o.a.createElement(Ze.a,{as:at.a,name:"password",variant:"outlined",margin:"dense",label:h.a.t("userModal.form.password"),error:t.password&&Boolean(a.password),helperText:t.password&&a.password,type:g?"text":"password",InputProps:{endAdornment:o.a.createElement(nt.a,{position:"end"},o.a.createElement(R.a,{"aria-label":"toggle password visibility",onClick:()=>E(e=>!e)},g?o.a.createElement(ct.a,null):o.a.createElement(it.a,null)))},fullWidth:!0})),o.a.createElement("div",{className:l.multFieldLine},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("userModal.form.email"),name:"email",error:t.email&&Boolean(a.email),helperText:t.email&&a.email,variant:"outlined",margin:"dense",fullWidth:!0}),o.a.createElement(ot.a,{variant:"outlined",className:l.formControl,margin:"dense"},o.a.createElement(Ce,{role:c.profile,perform:"user-modal:editProfile",yes:()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(rt.a,{id:"profile-selection-input-label"},h.a.t("userModal.form.profile")),o.a.createElement(Ze.a,{as:lt.a,label:h.a.t("userModal.form.profile"),name:"profile",labelId:"profile-selection-label",id:"profile-selection",required:!0},o.a.createElement(L.a,{value:"admin"},"Admin"),o.a.createElement(L.a,{value:"user"},"User")))}))),o.a.createElement(Ce,{role:c.profile,perform:"user-modal:editQueues",yes:()=>o.a.createElement(ut,{selectedQueueIds:u,onChange:e=>p(e)})}),o.a.createElement(Ce,{role:c.profile,perform:"user-modal:editQueues",yes:()=>!v&&o.a.createElement(ot.a,{variant:"outlined",margin:"dense",className:l.maxWidth,fullWidth:!0},o.a.createElement(rt.a,null,h.a.t("userModal.form.whatsapp")),o.a.createElement(Ze.a,{as:lt.a,value:b,onChange:e=>f(e.target.value),label:h.a.t("userModal.form.whatsapp")},o.a.createElement(L.a,{value:""},"\xa0"),k.map(e=>o.a.createElement(L.a,{key:e.id,value:e.id},e.name))))})),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:w,color:"secondary",disabled:n,variant:"outlined"},h.a.t("userModal.buttons.cancel")),o.a.createElement(De.a,{type:"submit",color:"primary",disabled:n,variant:"contained",className:l.btnWrapper},"".concat(r?h.a.t("userModal.buttons.okEdit"):h.a.t("userModal.buttons.okAdd")),n&&o.a.createElement(Pe.a,{size:24,className:l.buttonProgress}))))})))},ht=a(890);const bt=Object(M.a)(e=>({backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}));var ft=()=>{const e=bt();return o.a.createElement(ht.a,{className:e.backdrop,open:!0},o.a.createElement(Pe.a,{color:"inherit"}))};const vt=Object(M.a)(e=>({root:{display:"flex",height:"100vh",[e.breakpoints.down("sm")]:{height:"calc(100vh - 56px)"}},toolbar:{paddingRight:24},toolbarIcon:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px",minHeight:"48px"},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1},drawerPaper:{position:"relative",whiteSpace:"nowrap",width:240,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerPaperClose:{overflowX:"hidden",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),width:e.spacing(7),[e.breakpoints.up("sm")]:{width:e.spacing(9)}},appBarSpacer:{minHeight:"48px"},content:{flex:1,overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"}}));var yt=e=>{let{children:t}=e;const a=vt(),[r,l]=Object(n.useState)(!1),[s,c]=Object(n.useState)(null),[i,d]=Object(n.useState)(!1),{handleLogout:m,loading:u}=Object(n.useContext)(O),[p,g]=Object(n.useState)(!1),[E,b]=Object(n.useState)("permanent"),{user:f}=Object(n.useContext)(O);Object(n.useEffect)(()=>{document.body.offsetWidth>600&&g(!0)},[]),Object(n.useEffect)(()=>{document.body.offsetWidth<600?b("temporary"):b("permanent")},[p]);const v=()=>{c(null),d(!1)};return u?o.a.createElement(ft,null):o.a.createElement("div",{className:a.root},o.a.createElement(I.a,{variant:E,className:p?a.drawerPaper:a.drawerPaperClose,classes:{paper:Object(N.a)(a.drawerPaper,!p&&a.drawerPaperClose)},open:p},o.a.createElement("div",{className:a.toolbarIcon},o.a.createElement(R.a,{onClick:()=>g(!p)},o.a.createElement(U.a,null))),o.a.createElement(j.a,null),o.a.createElement(D.a,null,o.a.createElement(Oe,{drawerClose:()=>{document.body.offsetWidth<600&&g(!1)}})),o.a.createElement(j.a,null)),o.a.createElement(Et,{open:r,onClose:()=>l(!1),userId:null===f||void 0===f?void 0:f.id}),o.a.createElement(P.a,{position:"absolute",className:Object(N.a)(a.appBar,p&&a.appBarShift),color:"primary"},o.a.createElement(W.a,{variant:"dense",className:a.toolbar},o.a.createElement(R.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:()=>g(!p),className:Object(N.a)(a.menuButton,p&&a.menuButtonHidden)},o.a.createElement(F.a,null)),o.a.createElement(_.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:a.title},"WhaTicket"),f.id&&o.a.createElement(Je,null),o.a.createElement("div",null,o.a.createElement(R.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:e=>{c(e.currentTarget),d(!0)},color:"inherit"},o.a.createElement(Q.a,null)),o.a.createElement(q.a,{id:"menu-appbar",anchorEl:s,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:v},o.a.createElement(L.a,{onClick:()=>{l(!0),v()}},h.a.t("mainDrawer.appBar.user.profile")),o.a.createElement(L.a,{onClick:()=>{v(),m()}},h.a.t("mainDrawer.appBar.user.logout")))))),o.a.createElement("main",{className:a.content},o.a.createElement("div",{className:a.appBarSpacer}),t||null))},Ct=a(289),kt=a(970),Ot=a(971),wt=a(959),Tt=a(960),xt=a(972),St=a(966),At=a(967),Nt=a(968),Mt=a(969),It=a(973),Rt=a(974),jt=a(975),Dt=a(958);const Pt=Object(M.a)(e=>({mainContainer:{flex:1,padding:16,height:"calc(100% - 48px)"},contentWrapper:{height:"100%",overflowY:"hidden",display:"flex",flexDirection:"column"}}));var Wt=e=>{let{children:t}=e;const a=Pt();return o.a.createElement(Dt.a,{className:a.mainContainer,maxWidth:!1},o.a.createElement("div",{className:a.contentWrapper},t))};const _t=Object(M.a)(e=>({contactsHeader:{display:"flex",alignItems:"center",padding:"0px 6px 6px 6px"}}));var qt=e=>{let{children:t}=e;const a=_t();return o.a.createElement("div",{className:a.contactsHeader},t)};const Lt=Object(M.a)(e=>({MainHeaderButtonsWrapper:{flex:"none",marginLeft:"auto","& > *":{margin:e.spacing(1)}}}));var Bt=e=>{let{children:t}=e;const a=Lt();return o.a.createElement("div",{className:a.MainHeaderButtonsWrapper},t)};function Ft(e){return o.a.createElement(_.a,{variant:"h5",color:"primary",gutterBottom:!0},e.children)}var zt=a(961);const Ut=Object(M.a)(e=>({customTableCell:{display:"flex",alignItems:"center",justifyContent:"center"}}));var Ht=e=>{let{avatar:t,columns:a}=e;const n=Ut();return o.a.createElement(o.a.Fragment,null,o.a.createElement(wt.a,null,t&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Tt.a,{style:{paddingRight:0}},o.a.createElement(zt.a,{animation:"wave",variant:"circle",width:40,height:40})),o.a.createElement(Tt.a,null,o.a.createElement(zt.a,{animation:"wave",height:30,width:80}))),Array.from({length:a},(e,t)=>o.a.createElement(Tt.a,{align:"center",key:t},o.a.createElement("div",{className:n.customTableCell},o.a.createElement(zt.a,{align:"center",animation:"wave",height:30,width:80}))))))},Qt=a(962),Gt=a(963),Vt=a(964),Kt=a(965),Yt=a(1005);const Jt=Object(M.a)(e=>({root:{display:"flex",flexWrap:"wrap"},multFieldLine:{display:"flex","& > *:not(:last-child)":{marginRight:e.spacing(1)}},btnWrapper:{position:"relative"},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},expediente:{display:"flex",flexWrap:"wrap"},tituloReceberMsg:{fontSize:12,marginLeft:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(1)},reabrirTicket:{fontSize:12,display:"flex",marginLeft:e.spacing(2)},textSize:{fontSize:12},paperReceberMsg:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},diasSemana:{marginLeft:e.spacing(1)},hora:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(1),width:250},textoExpediente:{marginTop:e.spacing(2),marginLeft:e.spacing(1),marginBottom:e.spacing(3),width:"100%"}})),Xt=Xe.c().shape({name:Xe.d().min(2,"Too Short!").max(50,"Too Long!").required("Required")});var Zt=o.a.memo(e=>{let{open:t,onClose:a,whatsAppId:r}=e;const l=Jt(),s={name:"",greetingMessage:"",farewellMessage:"",isDefault:!1,isMultidevice:!0,transferTicketMessage:""},[c,i]=Object(n.useState)(s),[m,u]=Object(n.useState)([]),[p,g]=Object(n.useState)(!1),[E,b]=Object(n.useState)(""),[f,v]=Object(n.useState)("08:00"),[k,O]=Object(n.useState)("17:30"),[w,T]=Object(n.useState)("08:00"),[x,S]=Object(n.useState)("17:30"),[A,N]=Object(n.useState)(!0),[M,I]=Object(n.useState)(!0),[R,j]=Object(n.useState)(!0),[D,P]=Object(n.useState)(!0),[W,_]=Object(n.useState)(!0),[q,L]=Object(n.useState)(!1),[B,F]=Object(n.useState)(!1);Object(n.useEffect)(()=>{(async()=>{if(r)try{var e;const{data:t}=await y.get("whatsapp/".concat(r));i(t),N(t.monday),I(t.tuesday),j(t.wednesday),P(t.thursday),_(t.friday),L(t.saturday),F(t.sunday),g(t.defineWorkHours),b(t.outOfWorkMessage),v(t.startWorkHour),O(t.endWorkHour),T(t.startWorkHourWeekend),S(t.endWorkHourWeekend);const a=null===(e=t.queues)||void 0===e?void 0:e.map(e=>e.id);u(a)}catch(t){C(t)}})()},[r]);const z=e=>{"MON"===e.target.value&&N(e.target.checked),"TUE"===e.target.value&&I(e.target.checked),"WED"===e.target.value&&j(e.target.checked),"THU"===e.target.value&&P(e.target.checked),"FRI"===e.target.value&&_(e.target.checked),"SAT"===e.target.value&&L(e.target.checked),"SUN"===e.target.value&&F(e.target.checked),"defineWorkHours"===e.target.value&&g(e.target.checked)},U=()=>{a(),i(s)};return o.a.createElement("div",{className:l.root},o.a.createElement($e.a,{open:t,onClose:U,maxWidth:"sm",fullWidth:!0,scroll:"paper"},o.a.createElement(et.a,null,r?h.a.t("whatsappModal.title.edit"):h.a.t("whatsappModal.title.add")),o.a.createElement(Ze.d,{initialValues:c,enableReinitialize:!0,validationSchema:Xt,onSubmit:(e,t)=>{setTimeout(()=>{(async e=>{const t={...e,queueIds:m,startWorkHour:f,endWorkHour:k,defineWorkHours:p,outOfWorkMessage:E,startWorkHourWeekend:w,endWorkHourWeekend:x,monday:A,tuesday:M,wednesday:R,thursday:D,friday:W,saturday:q,sunday:B};try{r?await y.put("/whatsapp/".concat(r),t):await y.post("/whatsapp",t),d.b.success(h.a.t("whatsappModal.success")),U()}catch(a){C(a)}})(e),t.setSubmitting(!1)},400)}},e=>{let{values:t,touched:a,errors:n,isSubmitting:s}=e;return o.a.createElement(Ze.c,null,o.a.createElement(tt.a,{dividers:!0},o.a.createElement("div",{className:l.multFieldLine},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("whatsappModal.form.name"),autoFocus:!0,name:"name",error:a.name&&Boolean(n.name),helperText:a.name&&n.name,variant:"outlined",margin:"dense",className:l.textField}),o.a.createElement(Qt.a,{control:o.a.createElement(Ze.a,{as:Gt.a,color:"primary",name:"isDefault",checked:t.isDefault}),label:h.a.t("whatsappModal.form.default")})),o.a.createElement("div",null,o.a.createElement(Ze.a,{as:at.a,label:h.a.t("queueModal.form.greetingMessage"),type:"greetingMessage",multiline:!0,rows:5,fullWidth:!0,name:"greetingMessage",error:a.greetingMessage&&Boolean(n.greetingMessage),helperText:a.greetingMessage&&n.greetingMessage,variant:"outlined",margin:"dense"})),o.a.createElement("div",null,o.a.createElement(Ze.a,{as:at.a,label:h.a.t("whatsappModal.form.farewellMessage"),type:"farewellMessage",multiline:!0,rows:5,fullWidth:!0,name:"farewellMessage",error:a.farewellMessage&&Boolean(n.farewellMessage),helperText:a.farewellMessage&&n.farewellMessage,variant:"outlined",margin:"dense"})),o.a.createElement("div",null,o.a.createElement(Ze.a,{as:at.a,label:"Mensagem de trasnferencia de atendimento",type:"transferTicketMessage",multiline:!0,rows:5,fullWidth:!0,name:"transferTicketMessage",error:a.transferTicketMessage&&Boolean(n.transferTicketMessage),helperText:a.transferTicketMessage&&n.transferTicketMessage,variant:"outlined",margin:"dense"})),o.a.createElement("div",null,!0===p?o.a.createElement("div",null,o.a.createElement(at.a,{label:h.a.t("queueModal.form.outOfWorkMessage"),rows:4,multiline:!0,fullWidth:!0,name:"outOfWorkMessage",value:E,error:a.outOfWorkMessage&&Boolean(n.outOfWorkMessage),helperText:a.outOfWorkMessage&&n.outOfWorkMessage,variant:"outlined",margin:"dense",onChange:e=>b(e.target.value)})):"",o.a.createElement(Vt.a,{container:!0,spacing:2},o.a.createElement(Vt.a,{item:!0,xs:12,sm:12,className:l.diasSemana},o.a.createElement(ot.a,{component:"fieldset"},o.a.createElement(Kt.a,{"aria-label":"position",row:!0,sx:{width:{xs:100,sm:200,md:300,lg:600,xl:700}}},o.a.createElement(Ue.a,{title:"\nDesmarque esta op\xe7\xe3o para definir um hor\xe1rio de expediente para os atendimentos.\nQuando um usu\xe1rio escolher ser direcionado a um atendente, o sistema ir\xe1\nverificar o hor\xe1rio e o dia, se estiver fora do expediente, envia um aviso\nao usu\xe1rio e n\xe3o direciona ao atendente escolhido.\n",placement:"top"},o.a.createElement(Qt.a,{value:"defineWorkHours",control:o.a.createElement(Yt.a,{size:"small",checked:p,onChange:z}),label:"Definir hor\xe1rio de expediente",labelPlacement:"end"}))))),!0===p?o.a.createElement(o.a.Fragment,null,o.a.createElement(Vt.a,{item:!0,xs:12,sm:6},o.a.createElement(at.a,{className:l.hora,type:"time",label:h.a.t("queueModal.form.startWorkHour"),name:"startWorkHour",value:f,onChange:e=>v(e.target.value)})),o.a.createElement(Vt.a,{item:!0,xs:12,sm:6},o.a.createElement(at.a,{className:l.hora,type:"time",label:h.a.t("queueModal.form.endWorkHour"),name:"endWorkHour",value:k,onChange:e=>O(e.target.value)}))):""),!0===p?o.a.createElement(o.a.Fragment,null,o.a.createElement(Vt.a,{item:!0,xs:12,sm:12,className:l.diasSemana},o.a.createElement(ot.a,{component:"fieldset"},o.a.createElement(Kt.a,{"aria-label":"position",row:!0,sx:{width:{xs:100,sm:200,md:300,lg:600,xl:700}}},o.a.createElement(Qt.a,{value:"MON",control:o.a.createElement(Yt.a,{size:"small",checked:A,onChange:z}),label:h.a.t("queueModal.form.monday"),labelPlacement:"end"}),o.a.createElement(Qt.a,{value:"TUE",control:o.a.createElement(Yt.a,{size:"small",checked:M,onChange:z}),label:h.a.t("queueModal.form.tuesday"),labelPlacement:"end"}),o.a.createElement(Qt.a,{value:"WED",control:o.a.createElement(Yt.a,{size:"small",checked:R,onChange:z}),label:h.a.t("queueModal.form.wednesday"),labelPlacement:"end"}),o.a.createElement(Qt.a,{value:"THU",control:o.a.createElement(Yt.a,{size:"small",checked:D,onChange:z}),label:h.a.t("queueModal.form.thursday"),labelPlacement:"end"}),o.a.createElement(Qt.a,{value:"FRI",control:o.a.createElement(Yt.a,{size:"small",checked:W,onChange:z}),label:h.a.t("queueModal.form.friday"),labelPlacement:"end"}))))):"",!0===p?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ct.a,null,o.a.createElement(Vt.a,{container:!0,spacing:2,style:{marginTop:10}},o.a.createElement(Vt.a,{item:!0,xs:12,sm:6},o.a.createElement(at.a,{className:l.hora,type:"time",label:h.a.t("queueModal.form.startWorkHour"),name:"StartWorkHourWeekend",value:w,onChange:e=>T(e.target.value)})),o.a.createElement(Vt.a,{item:!0,xs:12,sm:6},o.a.createElement(at.a,{className:l.hora,type:"time",label:h.a.t("queueModal.form.endWorkHour"),name:"EndWorkHourWeekend",value:x,onChange:e=>S(e.target.value)}))),o.a.createElement(Vt.a,{item:!0,xs:12,sm:12,className:l.diasSemana},o.a.createElement(ot.a,{component:"fieldset"},o.a.createElement(Kt.a,{"aria-label":"position",row:!0,sx:{width:{xs:100,sm:200,md:300,lg:600,xl:700}}},o.a.createElement(Qt.a,{value:"SAT",control:o.a.createElement(Yt.a,{size:"small",checked:q,onChange:z}),label:h.a.t("queueModal.form.saturday"),labelPlacement:"end"}),o.a.createElement(Qt.a,{value:"SUN",control:o.a.createElement(Yt.a,{size:"small",checked:B,onChange:z}),label:h.a.t("queueModal.form.sunday"),labelPlacement:"end"})))))):""),o.a.createElement(ut,{selectedQueueIds:m,onChange:e=>u(e)})),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:U,color:"secondary",disabled:s,variant:"outlined"},h.a.t("whatsappModal.buttons.cancel")),o.a.createElement(De.a,{type:"submit",color:"primary",disabled:s,variant:"contained",className:l.btnWrapper},r?h.a.t("whatsappModal.buttons.okEdit"):h.a.t("whatsappModal.buttons.okAdd"),s&&o.a.createElement(Pe.a,{size:24,className:l.buttonProgress}))))})))});var $t=e=>{let{title:t,children:a,open:n,onClose:r,onConfirm:l}=e;return o.a.createElement($e.a,{open:n,onClose:()=>r(!1),"aria-labelledby":"confirm-dialog"},o.a.createElement(et.a,{id:"confirm-dialog"},t),o.a.createElement(tt.a,{dividers:!0},o.a.createElement(_.a,null,a)),o.a.createElement(st.a,null,o.a.createElement(De.a,{variant:"contained",onClick:()=>r(!1),color:"default"},h.a.t("confirmationModal.buttons.cancel")),o.a.createElement(De.a,{variant:"contained",onClick:()=>{r(!1),l()},color:"secondary"},h.a.t("confirmationModal.buttons.confirm"))))},ea=a(521),ta=a.n(ea);var aa=o.a.memo(e=>{let{open:t,onClose:a,whatsAppId:r}=e;const[l,s]=Object(n.useState)("");return Object(n.useEffect)(()=>{(async()=>{if(r)try{const{data:e}=await y.get("/whatsapp/".concat(r));s(e.qrcode)}catch(e){C(e)}})()},[r]),Object(n.useEffect)(()=>{if(!r)return;const e=E();return e.on("whatsappSession",e=>{"update"===e.action&&e.session.id===r&&s(e.session.qrcode),"update"===e.action&&""===e.session.qrcode&&a()}),()=>{e.disconnect()}},[r,a]),o.a.createElement($e.a,{open:t,onClose:a,maxWidth:"lg",scroll:"paper"},o.a.createElement(tt.a,null,o.a.createElement(Ct.a,{elevation:0},o.a.createElement(_.a,{color:"primary",gutterBottom:!0},h.a.t("qrCode.message")),l?o.a.createElement(ta.a,{value:l,size:256}):o.a.createElement("span",null,"Waiting for QR Code"))))});const na=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles},customTableCell:{display:"flex",alignItems:"center",justifyContent:"center"},tooltip:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",fontSize:e.typography.pxToRem(14),border:"1px solid #dadde9",maxWidth:450},tooltipPopper:{textAlign:"center"},buttonProgress:{color:Ie.a[500]}})),oa=e=>{let{title:t,content:a,children:n}=e;const r=na();return o.a.createElement(Ue.a,{arrow:!0,classes:{tooltip:r.tooltip,popper:r.tooltipPopper},title:o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,{gutterBottom:!0,color:"inherit"},t),a&&o.a.createElement(_.a,null,a))},n)};var ra=()=>{const e=na(),{whatsApps:t,loading:a}=Object(n.useContext)(S),[r,l]=Object(n.useState)(!1),[s,c]=Object(n.useState)(!1),[i,m]=Object(n.useState)(null),[u,p]=Object(n.useState)(!1),g={action:"",title:"",message:"",whatsAppId:"",open:!1},[E,b]=Object(n.useState)(g),f=Object(n.useCallback)(()=>{l(!1),m(null)},[m,l]),v=Object(n.useCallback)(()=>{m(null),c(!1)},[c,m]),k=(e,t)=>{"disconnect"===e&&b({action:e,title:h.a.t("connections.confirmationModal.disconnectTitle"),message:h.a.t("connections.confirmationModal.disconnectMessage"),whatsAppId:t}),"delete"===e&&b({action:e,title:h.a.t("connections.confirmationModal.deleteTitle"),message:h.a.t("connections.confirmationModal.deleteMessage"),whatsAppId:t}),p(!0)},O=e=>o.a.createElement(o.a.Fragment,null,"qrcode"===e.status&&o.a.createElement(De.a,{size:"small",variant:"contained",color:"primary",onClick:()=>(e=>{m(e),c(!0)})(e)},h.a.t("connections.buttons.qrcode")),"DISCONNECTED"===e.status&&o.a.createElement(o.a.Fragment,null,o.a.createElement(De.a,{size:"small",variant:"outlined",color:"primary",onClick:()=>(async e=>{try{await y.post("/whatsappsession/".concat(e))}catch(t){C(t)}})(e.id)},h.a.t("connections.buttons.tryAgain"))," ",o.a.createElement(De.a,{size:"small",variant:"outlined",color:"secondary",onClick:()=>(async e=>{try{await y.put("/whatsappsession/".concat(e))}catch(t){C(t)}})(e.id)},h.a.t("connections.buttons.newQr"))),("CONNECTED"===e.status||"PAIRING"===e.status||"TIMEOUT"===e.status)&&o.a.createElement(De.a,{size:"small",variant:"outlined",color:"secondary",onClick:()=>{k("disconnect",e.id)}},h.a.t("connections.buttons.disconnect")),"OPENING"===e.status&&o.a.createElement(De.a,{size:"small",variant:"outlined",disabled:!0,color:"default"},h.a.t("connections.buttons.connecting")));return o.a.createElement(Wt,null,o.a.createElement($t,{title:E.title,open:u,onClose:p,onConfirm:async()=>{if("disconnect"===E.action)try{await y.delete("/whatsappsession/".concat(E.whatsAppId))}catch(e){C(e)}if("delete"===E.action)try{await y.delete("/whatsapp/".concat(E.whatsAppId)),d.b.success(h.a.t("connections.toasts.deleted"))}catch(e){C(e)}b(g)}},E.message),o.a.createElement(aa,{open:s,onClose:v,whatsAppId:!r&&(null===i||void 0===i?void 0:i.id)}),o.a.createElement(Zt,{open:r,onClose:f,whatsAppId:!s&&(null===i||void 0===i?void 0:i.id)}),o.a.createElement(qt,null,o.a.createElement(Ft,null,h.a.t("connections.title")),o.a.createElement(Bt,null,o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:()=>{m(null),l(!0)}},h.a.t("connections.buttons.add")))),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined"},o.a.createElement(kt.a,{size:"small"},o.a.createElement(Ot.a,null,o.a.createElement(wt.a,null,o.a.createElement(Tt.a,{align:"center"},h.a.t("connections.table.name")),o.a.createElement(Tt.a,{align:"center"},h.a.t("connections.table.status")),o.a.createElement(Tt.a,{align:"center"},h.a.t("connections.table.session")),o.a.createElement(Tt.a,{align:"center"},h.a.t("connections.table.lastUpdate")),o.a.createElement(Tt.a,{align:"center"},h.a.t("connections.table.default")),o.a.createElement(Tt.a,{align:"center"},h.a.t("connections.table.actions")))),o.a.createElement(xt.a,null,a?o.a.createElement(Ht,null):o.a.createElement(o.a.Fragment,null,(null===t||void 0===t?void 0:t.length)>0&&t.map(t=>o.a.createElement(wt.a,{key:t.id},o.a.createElement(Tt.a,{align:"center"},t.name),o.a.createElement(Tt.a,{align:"center"},(t=>o.a.createElement("div",{className:e.customTableCell},"DISCONNECTED"===t.status&&o.a.createElement(oa,{title:h.a.t("connections.toolTips.disconnected.title"),content:h.a.t("connections.toolTips.disconnected.content")},o.a.createElement(St.a,{color:"secondary"})),"OPENING"===t.status&&o.a.createElement(Pe.a,{size:24,className:e.buttonProgress}),"qrcode"===t.status&&o.a.createElement(oa,{title:h.a.t("connections.toolTips.qrcode.title"),content:h.a.t("connections.toolTips.qrcode.content")},o.a.createElement(At.a,null)),"CONNECTED"===t.status&&o.a.createElement(oa,{title:h.a.t("connections.toolTips.connected.title")},o.a.createElement(Nt.a,{style:{color:Ie.a[500]}})),("TIMEOUT"===t.status||"PAIRING"===t.status)&&o.a.createElement(oa,{title:h.a.t("connections.toolTips.timeout.title"),content:h.a.t("connections.toolTips.timeout.content")},o.a.createElement(Mt.a,{color:"secondary"}))))(t)),o.a.createElement(Tt.a,{align:"center"},O(t)),o.a.createElement(Tt.a,{align:"center"},Object(we.a)(Object(Me.a)(t.updatedAt),"dd/MM/yy HH:mm")),o.a.createElement(Tt.a,{align:"center"},t.isDefault&&o.a.createElement("div",{className:e.customTableCell},o.a.createElement(It.a,{style:{color:Ie.a[500]}}))),o.a.createElement(Tt.a,{align:"center"},o.a.createElement(R.a,{size:"small",onClick:()=>(e=>{m(e),l(!0)})(t)},o.a.createElement(Rt.a,null)),o.a.createElement(R.a,{size:"small",onClick:e=>{k("delete",t.id)}},o.a.createElement(jt.a,null))))))))))},la=a(71),sa=a.n(la),ca=a(63),ia=a.n(ca),da=a(81),ma=a.n(da);const ua=Object(M.a)(e=>({root:{display:"flex",flexWrap:"wrap"},textField:{marginRight:e.spacing(1),flex:1},extraAttr:{display:"flex",justifyContent:"center",alignItems:"center"},btnWrapper:{position:"relative"},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})),pa=Xe.c().shape({name:Xe.d().min(2,"Too Short!").max(50,"Too Long!").required("Required"),number:Xe.d().min(8,"Too Short!").max(50,"Too Long!"),email:Xe.d().email("Invalid email")});var ga=e=>{let{open:t,onClose:a,contactId:r,initialValues:l,onSave:s}=e;const c=ua(),i=Object(n.useRef)(!0),m={name:"",number:"",email:""},[u,p]=Object(n.useState)(m);Object(n.useEffect)(()=>()=>{i.current=!1},[]),Object(n.useEffect)(()=>{(async()=>{if(l&&p(e=>({...e,...l})),r)try{const{data:e}=await y.get("/contacts/".concat(r));i.current&&p(e)}catch(e){C(e)}})()},[r,t,l]);const g=()=>{a(),p(m)};return o.a.createElement("div",{className:c.root},o.a.createElement($e.a,{open:t,onClose:g,maxWidth:"lg",scroll:"paper"},o.a.createElement(et.a,{id:"form-dialog-title"},"".concat(r?h.a.t("contactModal.title.edit"):h.a.t("contactModal.title.add"))),o.a.createElement(Ze.d,{initialValues:u,enableReinitialize:!0,validationSchema:pa,onSubmit:(e,t)=>{setTimeout(()=>{(async e=>{try{if(r)await y.put("/contacts/".concat(r),e),g();else{const{data:t}=await y.post("/contacts",e);s&&s(t),g()}d.b.success(h.a.t("contactModal.success"))}catch(t){C(t)}})(e),t.setSubmitting(!1)},400)}},e=>{let{values:t,errors:a,touched:n,isSubmitting:l}=e;return o.a.createElement(Ze.c,null,o.a.createElement(tt.a,{dividers:!0},o.a.createElement(_.a,{variant:"subtitle1",gutterBottom:!0},h.a.t("contactModal.form.mainInfo")),o.a.createElement(Ze.a,{as:at.a,label:h.a.t("contactModal.form.name"),name:"name",autoFocus:!0,error:n.name&&Boolean(a.name),helperText:n.name&&a.name,variant:"outlined",margin:"dense",className:c.textField}),o.a.createElement(Ze.a,{as:at.a,label:h.a.t("contactModal.form.number"),name:"number",error:n.number&&Boolean(a.number),helperText:n.number&&a.number,placeholder:"5513912344321",variant:"outlined",margin:"dense"}),o.a.createElement("div",null,o.a.createElement(Ze.a,{as:at.a,label:h.a.t("contactModal.form.email"),name:"email",error:n.email&&Boolean(a.email),helperText:n.email&&a.email,placeholder:"Email address",fullWidth:!0,margin:"dense",variant:"outlined"})),o.a.createElement(_.a,{style:{marginBottom:8,marginTop:12},variant:"subtitle1"},h.a.t("contactModal.form.extraInfo")),o.a.createElement(Ze.b,{name:"extraInfo"},e=>{let{push:a,remove:n}=e;return o.a.createElement(o.a.Fragment,null,t.extraInfo&&t.extraInfo.length>0&&t.extraInfo.map((e,t)=>o.a.createElement("div",{className:c.extraAttr,key:"".concat(t,"-info")},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("contactModal.form.extraName"),name:"extraInfo[".concat(t,"].name"),variant:"outlined",margin:"dense",className:c.textField}),o.a.createElement(Ze.a,{as:at.a,label:h.a.t("contactModal.form.extraValue"),name:"extraInfo[".concat(t,"].value"),variant:"outlined",margin:"dense",className:c.textField}),o.a.createElement(R.a,{size:"small",onClick:()=>n(t)},o.a.createElement(ia.a,null)))),o.a.createElement("div",{className:c.extraAttr},o.a.createElement(De.a,{style:{flex:1,marginTop:8},variant:"outlined",color:"primary",onClick:()=>a({name:"",value:""})},"+ ".concat(h.a.t("contactModal.buttons.addExtraInfo")))))})),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:g,color:"secondary",disabled:l,variant:"outlined"},h.a.t("contactModal.buttons.cancel")),o.a.createElement(De.a,{type:"submit",color:"primary",disabled:l,variant:"contained",className:c.btnWrapper},"".concat(r?h.a.t("contactModal.buttons.okEdit"):h.a.t("contactModal.buttons.okAdd")),l&&o.a.createElement(Pe.a,{size:24,className:c.buttonProgress}))))})))};const Ea=(e,t)=>{if("LOAD_CONTACTS"===t.type){const a=t.payload,n=[];return a.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:n.push(t)}),[...e,...n]}if("UPDATE_CONTACTS"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,[...e]):[a,...e]}if("DELETE_CONTACT"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]},ha=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}}));var ba=()=>{const e=ha(),t=Object(i.g)(),{user:a}=Object(n.useContext)(O),[r,l]=Object(n.useState)(!1),[s,c]=Object(n.useState)(1),[m,u]=Object(n.useState)(""),[p,g]=Object(n.useReducer)(Ea,[]),[b,f]=Object(n.useState)(null),[v,k]=Object(n.useState)(!1),[w,T]=Object(n.useState)(null),[x,S]=Object(n.useState)(!1),[A,N]=Object(n.useState)(!1);Object(n.useEffect)(()=>{g({type:"RESET"}),c(1)},[m]),Object(n.useEffect)(()=>{l(!0);const e=setTimeout(()=>{(async()=>{try{const{data:e}=await y.get("/contacts/",{params:{searchParam:m,pageNumber:s}});g({type:"LOAD_CONTACTS",payload:e.contacts}),N(e.hasMore),l(!1)}catch(e){C(e)}})()},500);return()=>clearTimeout(e)},[m,s]),Object(n.useEffect)(()=>{const e=E();return e.on("contact",e=>{"update"!==e.action&&"create"!==e.action||g({type:"UPDATE_CONTACTS",payload:e.contact}),"delete"===e.action&&g({type:"DELETE_CONTACT",payload:+e.contactId})}),()=>{e.disconnect()}},[]);return o.a.createElement(Wt,{className:e.mainContainer},o.a.createElement(ga,{open:v,onClose:()=>{f(null),k(!1)},"aria-labelledby":"form-dialog-title",contactId:b}),o.a.createElement($t,{title:w?"".concat(h.a.t("contacts.confirmationModal.deleteTitle")," ").concat(w.name,"?"):"".concat(h.a.t("contacts.confirmationModal.importTitlte")),open:x,onClose:S,onConfirm:e=>w?(async e=>{try{await y.delete("/contacts/".concat(e)),d.b.success(h.a.t("contacts.toasts.deleted"))}catch(t){C(t)}T(null),u(""),c(1)})(w.id):(async()=>{try{await y.post("/contacts/import"),t.go(0)}catch(e){C(e)}})()},"".concat(w?h.a.t("contacts.confirmationModal.deleteMessage"):h.a.t("contacts.confirmationModal.importMessage"))),o.a.createElement(qt,null,o.a.createElement(Ft,null,h.a.t("contacts.title")),o.a.createElement(Bt,null,o.a.createElement(at.a,{placeholder:h.a.t("contacts.searchPlaceholder"),type:"search",value:m,onChange:e=>{u(e.target.value.toLowerCase())},InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},o.a.createElement(sa.a,{style:{color:"gray"}}))}}),o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:e=>S(!0)},h.a.t("contacts.buttons.import")),o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:()=>{f(null),k(!0)}},h.a.t("contacts.buttons.add")))),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!A||r)return;const{scrollTop:t,scrollHeight:a,clientHeight:n}=e.currentTarget;a-(t+100)<n&&c(e=>e+1)}},o.a.createElement(kt.a,{size:"small"},o.a.createElement(Ot.a,null,o.a.createElement(wt.a,null,o.a.createElement(Tt.a,{padding:"checkbox"}),o.a.createElement(Tt.a,null,h.a.t("contacts.table.name")),o.a.createElement(Tt.a,{align:"center"},h.a.t("contacts.table.whatsapp")),o.a.createElement(Tt.a,{align:"center"},h.a.t("contacts.table.email")),o.a.createElement(Tt.a,{align:"center"},h.a.t("contacts.table.actions")))),o.a.createElement(xt.a,null,o.a.createElement(o.a.Fragment,null,p.map(e=>o.a.createElement(wt.a,{key:e.id},o.a.createElement(Tt.a,{style:{paddingRight:0}},o.a.createElement(je.a,{src:e.profilePicUrl})),o.a.createElement(Tt.a,null,e.name),o.a.createElement(Tt.a,{align:"center"},e.number),o.a.createElement(Tt.a,{align:"center"},e.email),o.a.createElement(Tt.a,{align:"center"},o.a.createElement(R.a,{size:"small",onClick:()=>(async e=>{if(e){l(!0);try{const{data:n}=await y.post("/tickets",{contactId:e,userId:null===a||void 0===a?void 0:a.id,status:"open"});t.push("/tickets/".concat(n.id))}catch(n){C(n)}l(!1)}})(e.id)},o.a.createElement(ve.a,null)),o.a.createElement(R.a,{size:"small",onClick:()=>{return t=e.id,f(t),void k(!0);var t}},o.a.createElement(ma.a,null)),o.a.createElement(Ce,{role:a.profile,perform:"contacts-page:deleteContact",yes:()=>o.a.createElement(R.a,{size:"small",onClick:t=>{S(!0),T(e)}},o.a.createElement(ia.a,null))})))),r&&o.a.createElement(Ht,{avatar:!0,columns:3}))))))},fa=a(33),va=a(977),ya=a(1e3),Ca=a(978),ka=a(529),Oa=a(530),wa=a(103),Ta=a(282),xa=a(976);var Sa=e=>o.a.createElement(_.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},e.children);var Aa=()=>{const e=Object(fa.a)(),t=Object(n.useRef)((new Date).toISOString()),{tickets:a}=Ge({date:t.current}),[r,l]=Object(n.useState)([{time:"08:00",amount:0},{time:"09:00",amount:0},{time:"10:00",amount:0},{time:"11:00",amount:0},{time:"12:00",amount:0},{time:"13:00",amount:0},{time:"14:00",amount:0},{time:"15:00",amount:0},{time:"16:00",amount:0},{time:"17:00",amount:0},{time:"18:00",amount:0},{time:"19:00",amount:0}]);return Object(n.useEffect)(()=>{l(e=>{let t=[...e];return t.forEach(e=>{a.forEach(t=>{Object(we.a)(Object(xa.a)(Object(Me.a)(t.createdAt)),"HH:mm")===e.time&&e.amount++})}),t})},[a]),o.a.createElement(o.a.Fragment,null,o.a.createElement(Sa,null,"".concat(h.a.t("dashboard.charts.perDay.title")).concat(a.length)),o.a.createElement(va.a,null,o.a.createElement(ya.a,{data:r,barSize:40,width:730,height:250,margin:{top:16,right:16,bottom:0,left:24}},o.a.createElement(Ca.a,{strokeDasharray:"3 3"}),o.a.createElement(ka.a,{dataKey:"time",stroke:e.palette.text.secondary}),o.a.createElement(Oa.a,{type:"number",allowDecimals:!1,stroke:e.palette.text.secondary},o.a.createElement(wa.a,{angle:270,position:"left",style:{textAnchor:"middle",fill:e.palette.text.primary}},"Tickets")),o.a.createElement(Ta.a,{dataKey:"amount",fill:e.palette.primary.main}))))};const Na=Object(M.a)(e=>({container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},fixedHeightPaper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",height:240},customFixedHeightPaper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",height:120},customFixedHeightPaperLg:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column",height:"100%"}}));var Ma=()=>{const e=Na(),{user:t}=Object(n.useContext)(O);var a=[];t.queues&&t.queues.length>0&&(a=t.queues.map(e=>e.id));const r=(e,t,n)=>{const{count:o}=Ge({status:e,showAll:t,withUnreadMessages:n,queueIds:JSON.stringify(a)});return o};return o.a.createElement("div",null,o.a.createElement(Dt.a,{maxWidth:"lg",className:e.container},o.a.createElement(Vt.a,{container:!0,spacing:3},o.a.createElement(Vt.a,{item:!0,xs:4},o.a.createElement(Ct.a,{className:e.customFixedHeightPaper,style:{overflow:"hidden"}},o.a.createElement(_.a,{component:"h3",variant:"h6",color:"primary",paragraph:!0},h.a.t("dashboard.messages.inAttendance.title")),o.a.createElement(Vt.a,{item:!0},o.a.createElement(_.a,{component:"h1",variant:"h4"},r("open","true","false"))))),o.a.createElement(Vt.a,{item:!0,xs:4},o.a.createElement(Ct.a,{className:e.customFixedHeightPaper,style:{overflow:"hidden"}},o.a.createElement(_.a,{component:"h3",variant:"h6",color:"primary",paragraph:!0},h.a.t("dashboard.messages.waiting.title")),o.a.createElement(Vt.a,{item:!0},o.a.createElement(_.a,{component:"h1",variant:"h4"},r("pending","true","false"))))),o.a.createElement(Vt.a,{item:!0,xs:4},o.a.createElement(Ct.a,{className:e.customFixedHeightPaper,style:{overflow:"hidden"}},o.a.createElement(_.a,{component:"h3",variant:"h6",color:"primary",paragraph:!0},h.a.t("dashboard.messages.closed.title")),o.a.createElement(Vt.a,{item:!0},o.a.createElement(_.a,{component:"h1",variant:"h4"},r("closed","true","false"))))),o.a.createElement(Vt.a,{item:!0,xs:12},o.a.createElement(Ct.a,{className:e.fixedHeightPaper},o.a.createElement(Aa,null))))))},Ia=a(981),Ra=a(1001),ja=a(980);const Da=Object(M.a)(e=>({paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}));var Pa=()=>{const e=Da(),[t,a]=Object(n.useState)({email:"",password:""}),[r,l]=Object(n.useState)(!1),{handleLogin:i}=Object(n.useContext)(O),d=e=>{a({...t,[e.target.name]:e.target.value})};return o.a.createElement(Dt.a,{component:"main",maxWidth:"xs"},o.a.createElement(s.a,null),o.a.createElement("div",{className:e.paper},o.a.createElement(je.a,{className:e.avatar},o.a.createElement(ja.a,null)),o.a.createElement(_.a,{component:"h1",variant:"h5"},h.a.t("login.title")),o.a.createElement("form",{className:e.form,noValidate:!0,onSubmit:e=>{e.preventDefault(),i(t)}},o.a.createElement(at.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:h.a.t("login.form.email"),name:"email",value:t.email,onChange:d,autoComplete:"email",autoFocus:!0}),o.a.createElement(at.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:h.a.t("login.form.password"),id:"password",value:t.password,onChange:d,autoComplete:"current-password",type:r?"text":"password",InputProps:{endAdornment:o.a.createElement(nt.a,{position:"end"},o.a.createElement(R.a,{"aria-label":"toggle password visibility",onClick:()=>l(e=>!e)},r?o.a.createElement(ct.a,null):o.a.createElement(it.a,null)))}}),o.a.createElement(De.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},h.a.t("login.buttons.submit")),o.a.createElement(Vt.a,{container:!0},o.a.createElement(Vt.a,{item:!0},o.a.createElement(Ia.a,{href:"#",variant:"body2",component:c.b,to:"/signup"},h.a.t("login.buttons.register")))))),o.a.createElement(Ra.a,{mt:8}))},Wa=a(196),_a=a.n(Wa),qa=a(217),La=a.n(qa),Ba=a(546);var Fa=e=>{let{onChange:t,currentColor:a,handleClose:r,open:l}=e;const[s,c]=Object(n.useState)(a);return o.a.createElement($e.a,{onClose:r,"aria-labelledby":"simple-dialog-title",open:l,maxWidth:"xs",paperFullWidth:!0},o.a.createElement(Ba.a,{width:"100%",triangle:"hide",color:s,colors:["#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB","#4D4D4D","#999999","#FFFFFF","#F44E3B","#FE9200","#FCDC00","#DBDF00","#A4DD00","#68CCCA","#73D8FF","#AEA1FF","#FDA1FF","#333333","#808080","#cccccc","#D33115","#E27300","#FCC400","#B0BC00","#68BC00","#16A5A5","#009CE0","#7B64FF","#FA28FF","#666666","#B3B3B3","#9F0500","#C45100","#FB9E00","#808900","#194D33","#0C797D","#0062B1","#653294","#AB149E"],onChange:e=>{c(e.hex),r()},onChangeComplete:e=>t(e.hex)}))},za=a(983),Ua=a(1015),Ha=a(982),Qa=a(1006),Ga=a(1016);const Va=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles},customTableCell:{display:"flex",alignItems:"center",justifyContent:"center"},tooltip:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",fontSize:e.typography.pxToRem(14),border:"1px solid #dadde9",maxWidth:450},tooltipPopper:{textAlign:"center"},buttonProgress:{color:Ie.a[500]}}));var Ka=e=>{let{title:t,content:a,children:n}=e;const r=Va();return o.a.createElement(Ue.a,{arrow:!0,classes:{tooltip:r.tooltip,popper:r.tooltipPopper},title:o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,{gutterBottom:!0,color:"inherit"},t),a&&o.a.createElement(_.a,null,a))},n)};const Ya=Xe.c().shape({options:Xe.a().of(Xe.c().shape({name:Xe.d().min(4,"too short").required("Required")})).required("Must have friends")}),Ja=Object(M.a)(e=>({greetingMessage:{cursor:"pointer",display:"flex",alignItems:"center","& > *:not(:last-child)":{marginRight:e.spacing(1)}},Box:{cursor:"pointer",alignItems:"center"}}));function Xa(e){const t={name:"",greetingMessage:"",options:[]},a=Ja(),[n,r]=o.a.useState(-1),[l,s]=o.a.useState(t),[c,i]=o.a.useState(!1),[m,u]=o.a.useState(!0),[p,g]=o.a.useState(null),[E,b]=o.a.useState(null),[f,v]=o.a.useState(null),[k,O]=o.a.useState(!1),w=async a=>{try{e.chatBotId?await y.put("/chatbot/".concat(e.chatBotId),a):await y.post("/chatbot",a),d.b.success("Bot saved successfully");const{data:n}=await y.get("/chatbot/".concat(e.chatBotId));s(t),s(n),g(null),b(null),s(n)}catch(n){C(n)}};o.a.useEffect(()=>{i(!0);const t=setTimeout(()=>{(async()=>{try{const{data:t}=await y.get("/chatbot/".concat(e.chatBotId));s(t),i(!1)}catch(t){console.log(t)}})()},500);return()=>clearTimeout(t)},[e.chatBotId]),o.a.useEffect(()=>{u(n!==p)},[p,n]);return o.a.createElement("div",{className:a.root},o.a.createElement($t,{title:f&&"".concat(h.a.t("queues.confirmationModal.deleteTitle")," ").concat(f.name,"?"),open:k,onClose:()=>{O(!1),v(null)},onConfirm:()=>(async a=>{try{await y.delete("/chatbot/".concat(a));const{data:n}=await y.get("/chatbot/".concat(e.chatBotId));s(t),s(n),g(null),b(null),s(n),d.b.success(h.a.t("Queue deleted successfully!"))}catch(n){C(n)}v(null)})(f.id)},h.a.t("Tem certeza? Todas as op\xe7\xf5es internas tamb\xe9m ser\xe3o exclu\xeddas")),!c&&o.a.createElement("div",null,o.a.createElement(Ze.d,{initialValues:l,validateOnChange:!1,enableReinitialize:!0,validationSchema:Ya,render:e=>{let{touched:t,errors:s,isSubmitting:c,values:i,handleSubmit:d}=e;return o.a.createElement(Ze.b,{name:"options"},e=>{let{push:d,remove:h}=e;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ua.a,{nonLinear:!0,activeStep:n,orientation:"vertical"},i.options&&i.options.length>0&&i.options.map((e,n)=>{var d,f,y,C,k,T,x;return o.a.createElement(Ha.a,{key:"".concat(e.id?e.id:n,"-options"),onClick:()=>r(n)},o.a.createElement(Qa.a,{key:"".concat(e.id,"-options")},p!==n&&(null===(d=l.options[n])||void 0===d?void 0:d.name)?o.a.createElement("div",{className:a.greetingMessage,variant:"body1"},i.options[n].name,o.a.createElement(R.a,{size:"small",onClick:()=>{g(n),u(!1)}},o.a.createElement(ma.a,null)),o.a.createElement(R.a,{onClick:()=>{v(e),O(!0)},size:"small"},o.a.createElement(ia.a,null))):o.a.createElement(o.a.Fragment,null,o.a.createElement(Ze.a,{as:at.a,name:"options[".concat(n,"].name"),variant:"standard",color:"primary",disabled:c,autoFocus:!0,error:(null===t||void 0===t||null===(f=t.options)||void 0===f||null===(y=f[n])||void 0===y?void 0:y.name)&&Boolean(null===(C=s.options)||void 0===C||null===(k=C[n])||void 0===k?void 0:k.name),className:a.textField}),o.a.createElement(Qt.a,{control:o.a.createElement(Ze.a,{as:Gt.a,color:"primary",name:"options[".concat(n,"].isAgent"),checked:i.options[n].isAgent||!1}),label:"Atendente"}),o.a.createElement(R.a,{size:"small",onClick:()=>i.options[n].name?w(i):null,disabled:c},o.a.createElement(_a.a,null)),o.a.createElement(R.a,{size:"small",onClick:()=>h(n),disabled:c},o.a.createElement(ia.a,null)))),m&&l.options[n]&&o.a.createElement(Ga.a,null,o.a.createElement(o.a.Fragment,null,E!==n?o.a.createElement("div",{className:a.greetingMessage},o.a.createElement(_.a,{color:"textSecondary",variant:"body1"},"Message:"),i.options[n].greetingMessage,!(null===(T=l.options[n])||void 0===T?void 0:T.greetingMessage)&&o.a.createElement(Ka,{title:"A mensagem \xe9 obrigat\xf3ria para seguir ao pr\xf3ximo n\xedvel",content:"Se a mensagem n\xe3o estiver definida, o bot n\xe3o seguir\xe1 adiante"},o.a.createElement(La.a,{color:"secondary",style:{marginLeft:"4px"},fontSize:"small"})),o.a.createElement(R.a,{size:"small",onClick:()=>b(n)},o.a.createElement(ma.a,null))):o.a.createElement("div",{className:a.greetingMessage},o.a.createElement(Ze.a,{as:at.a,name:"options[".concat(n,"].greetingMessage"),variant:"standard",margin:"dense",fullWidth:!0,multiline:!0,error:t.greetingMessage&&Boolean(s.greetingMessage),helperText:t.greetingMessage&&s.greetingMessage,className:a.textField}),o.a.createElement(R.a,{size:"small",onClick:()=>w(i),disabled:c}," ",o.a.createElement(_a.a,null))),(x=e.id,o.a.createElement(Xa,{chatBotId:x})))))}),o.a.createElement(Ha.a,null,o.a.createElement(Qa.a,{onClick:()=>d({name:void 0,greetingMessage:void 0})},"Adiconar op\xe7\xf5es"))))})}})))}const Za=Object(M.a)(e=>({root:{display:"flex",flexWrap:"wrap"},textField:{marginRight:e.spacing(1),flex:1},btnWrapper:{position:"relative"},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},formControl:{margin:e.spacing(1),minWidth:120},colorAdorment:{width:20,height:20},greetingMessage:{cursor:"pointer",display:"flex",alignItems:"center","& > *:not(:last-child)":{marginRight:e.spacing(1)}},custom:{display:"flex",alignItems:"center",justifyContent:"center"}})),$a=Xe.c().shape({name:Xe.d().min(2,"Too Short!").max(50,"Too Long!").required("Required"),color:Xe.d().min(3,"Too Short!").max(9,"Too Long!").required(),greetingMessage:Xe.d(),chatbots:Xe.a().of(Xe.c().shape({name:Xe.d().min(4,"too short").required("Required")})).required("Must have friends")});var en=e=>{let{open:t,onClose:a,queueId:r,onEdit:l}=e;const s=Za(),c={name:"",color:"",greetingMessage:"",chatbots:[]},[i,m]=Object(n.useState)(!1),[u,p]=Object(n.useState)(c),g=Object(n.useRef)(),[E,b]=o.a.useState(null),[f,v]=Object(n.useState)(null),[k,O]=Object(n.useState)(!1),[w,T]=o.a.useState(!0),[x,S]=o.a.useState(null),[A,N]=o.a.useState(null);Object(n.useEffect)(()=>((async()=>{if(r)try{const{data:e}=await y.get("/queue/".concat(r));p(t=>({...t,...e}))}catch(e){C(e)}})(),()=>{p({name:"",color:"",greetingMessage:"",chatbots:[]})}),[r,t]),Object(n.useEffect)(()=>{console.log(E),console.log(x),T(E!==x)},[x,E]);const M=()=>{a(),S(null),b(null),N(null)},I=async e=>{try{if(r){const{data:t}=await y.put("/queue/".concat(r),e);t.chatbots&&t.chatbots.length&&(l(t),p(t))}else{const{data:t}=await y.post("/queue",e);t.chatbots&&t.chatbots.length&&(p(t),l(t),M())}S(null),N(null),d.b.success("Queue saved successfully")}catch(t){C(t)}};return o.a.createElement("div",{className:s.root},o.a.createElement($t,{title:f&&"".concat(h.a.t("queues.confirmationModal.deleteTitle")," ").concat(f.name,"?"),open:k,onClose:()=>{O(!1),v(null)},onConfirm:()=>(async e=>{try{await y.delete("/chatbot/".concat(e));const{data:t}=await y.get("/queue/".concat(r));p(c),p(t),S(null),N(null),d.b.success(h.a.t("Queue deleted successfully!"))}catch(t){C(t)}})(f.id)},h.a.t("Tem certeza? Todas as op\xe7\xf5es internas tamb\xe9m ser\xe3o exclu\xeddas")),o.a.createElement($e.a,{maxWidth:"md",fullWidth:!0,open:t,onClose:M,scroll:"paper"},o.a.createElement(et.a,null,"".concat(r?h.a.t("queueModal.title.edit"):h.a.t("queueModal.title.add"))),o.a.createElement(Ze.d,{initialValues:u,validateOnChange:!1,enableReinitialize:!0,validationSchema:$a,onSubmit:(e,t)=>{setTimeout(()=>{(async e=>{try{console.log(r),r?await y.put("/queue/".concat(r),e):await y.post("/queue",e),d.b.success("Queue saved successfully"),M()}catch(t){C(t)}})(e),t.setSubmitting(!1)},400)}},e=>{let{handleChange:t,touched:a,errors:n,isSubmitting:l,values:c}=e;return o.a.createElement(Ze.c,null,o.a.createElement(tt.a,{dividers:!0},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("queueModal.form.name"),autoFocus:!0,name:"name",error:a.name&&Boolean(n.name),helperText:a.name&&n.name,variant:"outlined",margin:"dense",className:s.textField}),o.a.createElement(Ze.a,{as:at.a,label:h.a.t("queueModal.form.color"),name:"color",id:"color",onFocus:()=>{m(!0),g.current.focus()},error:a.color&&Boolean(n.color),helperText:a.color&&n.color,InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},o.a.createElement("div",{style:{backgroundColor:c.color},className:s.colorAdorment})),endAdornment:o.a.createElement(R.a,{size:"small",color:"default",onClick:()=>m(!0)},o.a.createElement(za.a,null))},variant:"outlined",margin:"dense"}),o.a.createElement(Fa,{open:i,handleClose:()=>m(!1),onChange:e=>{c.color=e,p(()=>({...c,color:e}))}}),o.a.createElement("div",null,o.a.createElement(Ze.a,{as:at.a,label:h.a.t("queueModal.form.greetingMessage"),type:"greetingMessage",multiline:!0,inputRef:g,minRows:5,fullWidth:!0,name:"greetingMessage",error:a.greetingMessage&&Boolean(n.greetingMessage),helperText:a.greetingMessage&&n.greetingMessage,variant:"outlined",margin:"dense"})),o.a.createElement(_.a,{variant:"subtitle1"},"Op\xe7\xf5es",o.a.createElement(Ka,{title:"Adicione op\xe7\xf5es para construir um chatbot",content:"Se houver apenas uma op\xe7\xe3o, ela ser\xe1 escolhida automaticamente, fazendo com que o bot responda com a mensagem da op\xe7\xe3o e siga adiante"},o.a.createElement(La.a,{style:{marginLeft:"14px"},fontSize:"small"}))),o.a.createElement("div",null,o.a.createElement(Ze.b,{name:"chatbots"},e=>{let{push:t,remove:r}=e;return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ua.a,{nonLinear:!0,activeStep:E,orientation:"vertical"},c.chatbots&&c.chatbots.length>0&&c.chatbots.map((e,t)=>{var i,d,m,p,g,E;return o.a.createElement(Ha.a,{key:"".concat(e.id?e.id:t,"-chatbots"),onClick:()=>b(t)},o.a.createElement(Qa.a,{key:"".concat(e.id,"-chatbots")},x!==t&&(null===(i=u.chatbots[t])||void 0===i?void 0:i.name)?o.a.createElement("div",{className:s.greetingMessage,variant:"body1"},c.chatbots[t].name,o.a.createElement(R.a,{size:"small",onClick:()=>{S(t),T(!1)}},o.a.createElement(ma.a,null)),o.a.createElement(R.a,{onClick:()=>{v(e),O(!0)},size:"small"},o.a.createElement(ia.a,null))):o.a.createElement(o.a.Fragment,null,o.a.createElement(Ze.a,{as:at.a,name:"chatbots[".concat(t,"].name"),variant:"standard",color:"primary",disabled:l,autoFocus:!0,error:(null===a||void 0===a||null===(d=a.chatbots)||void 0===d||null===(m=d[t])||void 0===m?void 0:m.name)&&Boolean(null===(p=n.chatbots)||void 0===p||null===(g=p[t])||void 0===g?void 0:g.name),className:s.textField}),o.a.createElement(Qt.a,{control:o.a.createElement(Ze.a,{as:Gt.a,color:"primary",name:"chatbots[".concat(t,"].isAgent"),checked:c.chatbots[t].isAgent||!1}),label:"Atendente"}),o.a.createElement(R.a,{size:"small",onClick:()=>c.chatbots[t].name?I(c):null,disabled:l},o.a.createElement(_a.a,null)),o.a.createElement(R.a,{size:"small",onClick:()=>r(t),disabled:l},o.a.createElement(ia.a,null)))),w&&u.chatbots[t]&&o.a.createElement(Ga.a,null,o.a.createElement(o.a.Fragment,null,A!==t?o.a.createElement("div",{className:s.greetingMessage},o.a.createElement(_.a,{color:"textSecondary",variant:"body1"},"Message:"),c.chatbots[t].greetingMessage,!(null===(E=u.chatbots[t])||void 0===E?void 0:E.greetingMessage)&&o.a.createElement(Ka,{title:"A mensagem \xe9 obrigat\xf3ria para seguir ao pr\xf3ximo n\xedvel",content:"Se a mensagem n\xe3o estiver definida, o bot n\xe3o seguir\xe1 adiante"},o.a.createElement(La.a,{color:"secondary",style:{marginLeft:"4px"},fontSize:"small"})),o.a.createElement(R.a,{size:"small",onClick:()=>N(t)},o.a.createElement(ma.a,null))):o.a.createElement("div",{className:s.greetingMessage},o.a.createElement(Ze.a,{as:at.a,name:"chatbots[".concat(t,"].greetingMessage"),variant:"standard",margin:"dense",fullWidth:!0,multiline:!0,error:a.greetingMessage&&Boolean(n.greetingMessage),helperText:a.greetingMessage&&n.greetingMessage,className:s.textField}),o.a.createElement(R.a,{size:"small",onClick:()=>I(c),disabled:l}," ",o.a.createElement(_a.a,null))),o.a.createElement(Xa,{chatBotId:e.id}))))}),o.a.createElement(Ha.a,null,o.a.createElement(Qa.a,{onClick:()=>t({name:"",value:""})},"Adiconar op\xe7\xf5es"))))}))),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:M,disabled:l},h.a.t("queueModal.buttons.cancel")),o.a.createElement(De.a,{type:"submit",color:"primary",disabled:l,variant:"contained",className:s.btnWrapper},"".concat(r?h.a.t("queueModal.buttons.okEdit"):h.a.t("queueModal.buttons.okAdd")),l&&o.a.createElement(Pe.a,{size:24,className:s.buttonProgress}))))})))};const tn=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll"},customTableCell:{display:"flex",alignItems:"center",justifyContent:"center"}})),an=(e,t)=>{if("LOAD_QUEUES"===t.type){const a=t.payload,n=[];return a.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:n.push(t)}),[...e,...n]}if("UPDATE_QUEUES"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,[...e]):[a,...e]}if("DELETE_QUEUE"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]};var nn=()=>{const e=tn(),[t,a]=Object(n.useReducer)(an,[]),[r,l]=Object(n.useState)(!1),[s,c]=Object(n.useState)(!1),[i,m]=Object(n.useState)(null),[p,g]=Object(n.useState)(!1);Object(n.useEffect)(()=>{(async()=>{l(!0);try{const{data:e}=await y.get("/queue");a({type:"LOAD_QUEUES",payload:e}),l(!1)}catch(e){C(e),l(!1)}})()},[]),Object(n.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("token")),t=u()("fenix.ticket",{query:{token:e}});return t.on("ready",()=>{t.emit("joinCompany")}),t.on("queue",e=>{"update"!==e.action&&"create"!==e.action||a({type:"UPDATE_QUEUES",payload:e.queue}),"delete"===e.action&&a({type:"DELETE_QUEUE",payload:e.queueId})}),()=>{t.disconnect()}},[]);const E=e=>{m(e),c(!0)};return o.a.createElement(Wt,null,o.a.createElement($t,{title:i&&"".concat(h.a.t("queues.confirmationModal.deleteTitle")," ").concat(i.name,"?"),open:p,onClose:()=>{g(!1),m(null)},onConfirm:()=>(async e=>{try{await y.delete("/queue/".concat(e)),d.b.success(h.a.t("Queue deleted successfully!"))}catch(t){C(t)}m(null)})(i.id)},h.a.t("queues.confirmationModal.deleteMessage")),o.a.createElement(en,{open:s,onClose:()=>{console.log("fechou modal"),c(!1),m(null)},queueId:null===i||void 0===i?void 0:i.id,onEdit:e=>{e&&setTimeout(()=>{E(e)},200)}}),o.a.createElement(qt,null,o.a.createElement(Ft,null,h.a.t("queues.title")),o.a.createElement(Bt,null,o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:()=>{c(!0),m(null)}},h.a.t("queues.buttons.add")))),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined"},o.a.createElement(kt.a,{size:"small"},o.a.createElement(Ot.a,null,o.a.createElement(wt.a,null,o.a.createElement(Tt.a,{align:"center"},h.a.t("queues.table.name")),o.a.createElement(Tt.a,{align:"center"},h.a.t("queues.table.color")),o.a.createElement(Tt.a,{align:"center"},h.a.t("queues.table.greeting")),o.a.createElement(Tt.a,{align:"center"},h.a.t("queues.table.actions")))),o.a.createElement(xt.a,null,o.a.createElement(o.a.Fragment,null,t.map(t=>o.a.createElement(wt.a,{key:t.id},o.a.createElement(Tt.a,{align:"center"},t.name),o.a.createElement(Tt.a,{align:"center"},o.a.createElement("div",{className:e.customTableCell},o.a.createElement("span",{style:{backgroundColor:t.color,width:60,height:20,alignSelf:"center"}}))),o.a.createElement(Tt.a,{align:"center"},o.a.createElement("div",{className:e.customTableCell},o.a.createElement(_.a,{style:{width:300,align:"center"},noWrap:!0,variant:"body2"},t.greetingMessage))),o.a.createElement(Tt.a,{align:"center"},o.a.createElement(R.a,{size:"small",onClick:()=>E(t)},o.a.createElement(Rt.a,null)),o.a.createElement(R.a,{size:"small",onClick:()=>{m(t),g(!0)}},o.a.createElement(jt.a,null))))),r&&o.a.createElement(Ht,{columns:4}))))))};const on=Object(M.a)(e=>({root:{flexWrap:"wrap"},textField:{marginRight:e.spacing(1),width:"100%"},btnWrapper:{position:"relative"},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},textQuickAnswerContainer:{width:"100%"}})),rn=Xe.c().shape({shortcut:Xe.d().min(2,"Too Short!").max(15,"Too Long!").required("Required"),message:Xe.d().min(8,"Too Short!").max(3e4,"Too Long!").required("Required")});var ln=e=>{let{open:t,onClose:a,quickAnswerId:r,initialValues:l,onSave:s}=e;const c=on(),i=Object(n.useRef)(!0),m={shortcut:"",message:""},[u,p]=Object(n.useState)(m);Object(n.useEffect)(()=>()=>{i.current=!1},[]),Object(n.useEffect)(()=>{(async()=>{if(l&&p(e=>({...e,...l})),r)try{const{data:e}=await y.get("/quickAnswers/".concat(r));i.current&&p(e)}catch(e){C(e)}})()},[r,t,l]);const g=()=>{a(),p(m)};return o.a.createElement("div",{className:c.root},o.a.createElement($e.a,{open:t,onClose:g,maxWidth:"sm",fullWidth:!0,scroll:"paper"},o.a.createElement(et.a,{id:"form-dialog-title"},"".concat(r?h.a.t("quickAnswersModal.title.edit"):h.a.t("quickAnswersModal.title.add"))),o.a.createElement(Ze.d,{initialValues:u,enableReinitialize:!0,validationSchema:rn,onSubmit:(e,t)=>{setTimeout(()=>{(async e=>{try{if(r)await y.put("/quickAnswers/".concat(r),e),g();else{const{data:t}=await y.post("/quickAnswers",e);s&&s(t),g()}d.b.success(h.a.t("quickAnswersModal.success"))}catch(t){C(t)}})(e),t.setSubmitting(!1)},400)}},e=>{let{values:t,errors:a,touched:n,isSubmitting:l}=e;return o.a.createElement(Ze.c,null,o.a.createElement(tt.a,{dividers:!0},o.a.createElement("div",{className:c.textQuickAnswerContainer},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("quickAnswersModal.form.shortcut"),name:"shortcut",autoFocus:!0,error:n.shortcut&&Boolean(a.shortcut),helperText:n.shortcut&&a.shortcut,variant:"outlined",margin:"dense",className:c.textField,fullWidth:!0})),o.a.createElement("div",{className:c.textQuickAnswerContainer},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("quickAnswersModal.form.message"),name:"message",error:n.message&&Boolean(a.message),helperText:n.message&&a.message,variant:"outlined",margin:"dense",className:c.textField,multiline:!0,rows:5,fullWidth:!0}))),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:g,color:"secondary",disabled:l,variant:"outlined"},h.a.t("quickAnswersModal.buttons.cancel")),o.a.createElement(De.a,{type:"submit",color:"primary",disabled:l,variant:"contained",className:c.btnWrapper},"".concat(r?h.a.t("quickAnswersModal.buttons.okEdit"):h.a.t("quickAnswersModal.buttons.okAdd")),l&&o.a.createElement(Pe.a,{size:24,className:c.buttonProgress}))))})))};const sn=(e,t)=>{if("LOAD_QUICK_ANSWERS"===t.type){const a=t.payload,n=[];return a.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:n.push(t)}),[...e,...n]}if("UPDATE_QUICK_ANSWERS"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,[...e]):[a,...e]}if("DELETE_QUICK_ANSWERS"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]},cn=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}}));var dn=()=>{const e=cn(),[t,a]=Object(n.useState)(!1),[r,l]=Object(n.useState)(1),[s,c]=Object(n.useState)(""),[i,m]=Object(n.useReducer)(sn,[]),[u,p]=Object(n.useState)(null),[g,b]=Object(n.useState)(!1),[f,v]=Object(n.useState)(null),[k,O]=Object(n.useState)(!1),[w,T]=Object(n.useState)(!1);Object(n.useEffect)(()=>{m({type:"RESET"}),l(1)},[s]),Object(n.useEffect)(()=>{a(!0);const e=setTimeout(()=>{(async()=>{try{const{data:e}=await y.get("/quickAnswers/",{params:{searchParam:s,pageNumber:r}});m({type:"LOAD_QUICK_ANSWERS",payload:e.quickAnswers}),T(e.hasMore),a(!1)}catch(e){C(e)}})()},500);return()=>clearTimeout(e)},[s,r]),Object(n.useEffect)(()=>{const e=E();return e.on("quickAnswer",e=>{"update"!==e.action&&"create"!==e.action||m({type:"UPDATE_QUICK_ANSWERS",payload:e.quickAnswer}),"delete"===e.action&&m({type:"DELETE_QUICK_ANSWERS",payload:+e.quickAnswerId})}),()=>{e.disconnect()}},[]);return o.a.createElement(Wt,null,o.a.createElement($t,{title:f&&"".concat(h.a.t("quickAnswers.confirmationModal.deleteTitle")," ").concat(f.shortcut,"?"),open:k,onClose:O,onConfirm:()=>(async e=>{try{await y.delete("/quickAnswers/".concat(e)),d.b.success(h.a.t("quickAnswers.toasts.deleted"))}catch(t){C(t)}v(null),c(""),l(1)})(f.id)},h.a.t("quickAnswers.confirmationModal.deleteMessage")),o.a.createElement(ln,{open:g,onClose:()=>{p(null),b(!1)},"aria-labelledby":"form-dialog-title",quickAnswerId:u&&u.id}),o.a.createElement(qt,null,o.a.createElement(Ft,null,h.a.t("quickAnswers.title")),o.a.createElement(Bt,null,o.a.createElement(at.a,{placeholder:h.a.t("quickAnswers.searchPlaceholder"),type:"search",value:s,onChange:e=>{c(e.target.value.toLowerCase())},InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},o.a.createElement(sa.a,{style:{color:"gray"}}))}}),o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:()=>{p(null),b(!0)}},h.a.t("quickAnswers.buttons.add")))),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!w||t)return;const{scrollTop:a,scrollHeight:n,clientHeight:o}=e.currentTarget;n-(a+100)<o&&l(e=>e+1)}},o.a.createElement(kt.a,{size:"small"},o.a.createElement(Ot.a,null,o.a.createElement(wt.a,null,o.a.createElement(Tt.a,{align:"center"},h.a.t("quickAnswers.table.shortcut")),o.a.createElement(Tt.a,{align:"center"},h.a.t("quickAnswers.table.message")),o.a.createElement(Tt.a,{align:"center"},h.a.t("quickAnswers.table.actions")))),o.a.createElement(xt.a,null,o.a.createElement(o.a.Fragment,null,i.map(e=>o.a.createElement(wt.a,{key:e.id},o.a.createElement(Tt.a,{align:"center"},e.shortcut),o.a.createElement(Tt.a,{align:"center"},e.message),o.a.createElement(Tt.a,{align:"center"},o.a.createElement(R.a,{size:"small",onClick:()=>(e=>{p(e),b(!0)})(e)},o.a.createElement(Rt.a,null)),o.a.createElement(R.a,{size:"small",onClick:t=>{O(!0),v(e)}},o.a.createElement(jt.a,null))))),t&&o.a.createElement(Ht,{columns:3}))))))},mn=a(1007),un=a(218),pn=a.n(un),gn=a(144);const En=Object(M.a)(e=>({root:{display:"flex",flexWrap:"wrap"},multFieldLine:{display:"flex","& > *:not(:last-child)":{marginRight:e.spacing(1)}},btnWrapper:{position:"relative"},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},formControl:{margin:e.spacing(1),minWidth:120}})),hn=Xe.c().shape({body:Xe.d().min(5,"Mensagem muito curta").required("Obrigat\xf3rio"),contactId:Xe.b().required("Obrigat\xf3rio"),sendAt:Xe.d().required("Obrigat\xf3rio")});var bn=e=>{let{open:t,onClose:a,scheduleId:r,contactId:l,cleanContact:s,reload:c,setContactId:m}=e;const u=En(),p=Object(i.g)(),{user:g}=Object(n.useContext)(O),E={body:"",contactId:"",sendAt:pn()().add(1,"hour").format("YYYY-MM-DDTHH:mm"),sentAt:""},b={id:"",name:""},[f,v]=Object(n.useState)(E),[k,w]=Object(n.useState)(b),[T,x]=Object(n.useState)([b]);Object(n.useEffect)(()=>{if(l&&T.length){const e=T.find(e=>e.id===l);e&&w(e)}},[l,T]),Object(n.useEffect)(()=>{try{(async()=>{const{data:e}=await y.get("/contacts/list");let t=e.map(e=>({id:e.id,name:e.name}));if(Object(gn.isArray)(t)&&x([{id:"",name:""},...t]),l&&v(e=>({...e,contactId:l})),!r)return;const{data:a}=await y.get("/schedules/".concat(r));v(e=>({...e,...a,sendAt:pn()(a.sendAt).format("YYYY-MM-DDTHH:mm")})),w(a.contact)})()}catch(e){C(e)}},[r,l,t]);const S=()=>{a(),v(E)};return o.a.createElement("div",{className:u.root},o.a.createElement($e.a,{open:t,onClose:S,maxWidth:"xs",fullWidth:!0,scroll:"paper"},o.a.createElement(et.a,{id:"form-dialog-title"},"ERRO"===f.status?"Erro de Envio":"Mensagem ".concat(Object(gn.capitalize)(f.status))),o.a.createElement(Ze.d,{initialValues:f,enableReinitialize:!0,validationSchema:hn,onSubmit:(e,t)=>{setTimeout(()=>{(async e=>{const t={...e,userId:g.id};try{r?await y.put("/schedules/".concat(r),t):await y.post("/schedules",t),d.b.success(h.a.t("scheduleModal.success")),"function"==typeof c&&c(),w(b),v(E),p.push("/schedules")}catch(a){C(a)}S()})(e),t.setSubmitting(!1)},400)}},e=>{let{touched:t,errors:a,isSubmitting:n,values:l}=e;return o.a.createElement(Ze.c,null,o.a.createElement(tt.a,{dividers:!0},o.a.createElement("div",{className:u.multFieldLine},o.a.createElement(ot.a,{variant:"outlined",fullWidth:!0},o.a.createElement(mn.a,{fullWidth:!0,value:k,options:T,onChange:(e,t)=>{const a=t?t.id:"";v({...f,contactId:a}),w(t||b)},getOptionLabel:e=>e.name,getOptionSelected:(e,t)=>t.id===e.id,renderInput:e=>o.a.createElement(at.a,Object.assign({},e,{variant:"outlined",placeholder:"Contato"}))}))),o.a.createElement("br",null),o.a.createElement("div",{className:u.multFieldLine},o.a.createElement(Ze.a,{as:at.a,rows:9,multiline:!0,label:h.a.t("scheduleModal.form.body"),name:"body",error:t.body&&Boolean(a.body),helperText:t.body&&a.body,variant:"outlined",margin:"dense",fullWidth:!0})),o.a.createElement("br",null),o.a.createElement("div",{className:u.multFieldLine},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("scheduleModal.form.sendAt"),type:"datetime-local",name:"sendAt",InputLabelProps:{shrink:!0},error:t.sendAt&&Boolean(a.sendAt),helperText:t.sendAt&&a.sendAt,variant:"outlined",fullWidth:!0}))),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:S,color:"secondary",disabled:n,variant:"outlined"},h.a.t("scheduleModal.buttons.cancel")),(null===f.sentAt||""===f.sentAt)&&o.a.createElement(De.a,{type:"submit",color:"primary",disabled:n,variant:"contained",className:u.btnWrapper},"".concat(r?h.a.t("scheduleModal.buttons.okEdit"):h.a.t("scheduleModal.buttons.okAdd")),n&&o.a.createElement(Pe.a,{size:24,className:u.buttonProgress}))))})))};const fn=(e,t)=>{if("LOAD_SCHEDULES"===t.type){const a=t.payload,n=[];return a.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:n.push(t)}),[...e,...n]}if("UPDATE_SCHEDULES"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,[...e]):[a,...e]}if("DELETE_SCHEDULE"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]},vn=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}}));var yn=()=>{const e=vn(),[t,a]=Object(n.useState)(!1),[r,l]=Object(n.useState)(1),[s,c]=Object(n.useState)(!1),[i,m]=Object(n.useState)(null),[u,p]=Object(n.useState)(null),[g,b]=Object(n.useState)(!1),[f,v]=Object(n.useState)(""),[k,O]=Object(n.useReducer)(fn,[]),[w,T]=Object(n.useState)(!1),[x,S]=Object(n.useState)((A="contactId",+new URLSearchParams(window.location.search).get(A)));var A;const N=Object(n.useCallback)(async()=>{try{const{data:e}=await y.get("/schedules/",{params:{searchParam:f,pageNumber:r}});O({type:"LOAD_SCHEDULES",payload:e.schedules}),c(e.hasMore),S(null),a(!1)}catch(e){C(e)}},[f,r]),M=Object(n.useCallback)(()=>{x&&I()},[x]);Object(n.useEffect)(()=>{O({type:"RESET"}),l(1)},[f]),Object(n.useEffect)(()=>{a(!0);const e=setTimeout(()=>{N()},500);return()=>clearTimeout(e)},[f,r,x,N,M]),Object(n.useEffect)(()=>{M();const e=E();return e.on("user",e=>{"update"!==e.action&&"create"!==e.action||O({type:"UPDATE_SCHEDULES",payload:e.schedules}),"delete"===e.action&&O({type:"DELETE_USER",payload:+e.scheduleId})}),()=>{e.disconnect()}},[M]);const I=()=>{m(null),T(!0)};return o.a.createElement(Wt,null,o.a.createElement($t,{title:u&&"".concat(h.a.t("schedules.confirmationModal.deleteTitle")),open:g,onClose:b,onConfirm:()=>(async e=>{try{await y.delete("/schedules/".concat(e)),d.b.success(h.a.t("schedules.toasts.deleted"))}catch(t){C(t)}p(null),v(""),l(1),O({type:"RESET"}),l(1),await N()})(u.id)},h.a.t("schedules.confirmationModal.deleteMessage")),o.a.createElement(bn,{open:w,onClose:()=>{m(null),T(!1)},reload:N,"aria-labelledby":"form-dialog-title",scheduleId:i&&i.id,contactId:x,cleanContact:()=>{S(null)},setContactId:S}),o.a.createElement(qt,null,o.a.createElement(Ft,null,h.a.t("schedules.title")),o.a.createElement(Bt,null,o.a.createElement(at.a,{placeholder:h.a.t("contacts.searchPlaceholder"),type:"search",value:f,onChange:e=>{v(e.target.value.toLowerCase())},InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},o.a.createElement(sa.a,{style:{color:"gray"}}))}}),o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:I},h.a.t("schedules.buttons.add")))),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!s||t)return;const{scrollTop:a,scrollHeight:n,clientHeight:o}=e.currentTarget;n-(a+100)<o&&l(e=>e+1)}},o.a.createElement(kt.a,{size:"small"},o.a.createElement(Ot.a,null,o.a.createElement(wt.a,null,o.a.createElement(Tt.a,{align:"center"},h.a.t("schedules.table.contact")),o.a.createElement(Tt.a,{align:"center"},h.a.t("schedules.table.body")),o.a.createElement(Tt.a,{align:"center"},h.a.t("schedules.table.sendAt")),o.a.createElement(Tt.a,{align:"center"},h.a.t("schedules.table.status")),o.a.createElement(Tt.a,{align:"center"},h.a.t("schedules.table.actions")))),o.a.createElement(xt.a,null,o.a.createElement(o.a.Fragment,null,k.map(e=>{return o.a.createElement(wt.a,{key:e.id},o.a.createElement(Tt.a,{align:"center"},e.contact.name),o.a.createElement(Tt.a,{align:"center",title:e.body},(t=e.body,a=25,t.length>a?t.substring(0,a)+"...":t)),o.a.createElement(Tt.a,{align:"center"},pn()(e.sendAt).format("DD/MM/YYYY HH:mm:ss")),o.a.createElement(Tt.a,{align:"center"},Object(gn.capitalize)(e.status)),o.a.createElement(Tt.a,{align:"center"},o.a.createElement(R.a,{size:"small",onClick:()=>(e=>{m(e),T(!0)})(e)},o.a.createElement(ma.a,null)),o.a.createElement(R.a,{size:"small",onClick:t=>{b(!0),p(e)}},o.a.createElement(ia.a,null))));var t,a}),t&&o.a.createElement(Ht,{columns:4}))))))},Cn=a(985);const kn=Object(M.a)({root:{width:"100%",marginTop:"1rem"}});function On(e){let{progressMessage:t}=e;const a=kn(),[n,r]=o.a.useState(0);return o.a.useEffect(()=>{r(t)},[t]),o.a.createElement("div",{className:a.root},o.a.createElement(Cn.a,{variant:"determinate",value:n}))}const wn=Object(M.a)(e=>({root:{flexGrow:1},paper:{height:240,width:240},control:{padding:e.spacing(2)}}));function Tn(e){let{message:t}=e;const a=wn();return o.a.createElement(Vt.a,{container:!0,className:a.root,spacing:2,style:{marginTop:"20px"}},o.a.createElement(Vt.a,{item:!0,xs:12},o.a.createElement(Vt.a,{container:!0,justifyContent:"center",spacing:2},t.map(e=>o.a.createElement(Vt.a,{key:e.phone,item:!0},o.a.createElement(Ct.a,{className:a.paper},o.a.createElement(_.a,{variant:"body2",component:"p"},e.phone),o.a.createElement(_.a,{variant:"body2",component:"p"},e.message)))))))}const xn=Object(M.a)(e=>({chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2}})),Sn=e=>{let{title:t,content:a,children:n}=e;const r=xn();return o.a.createElement(Ue.a,{arrow:!0,classes:{tooltip:r.tooltip,popper:r.tooltipPopper},title:o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,{gutterBottom:!0,color:"inherit"},t),a&&o.a.createElement(_.a,null,a))},n)};var An=e=>{let{selectedQueueIds:t,onChange:a}=e;const r=xn(),[l,s]=Object(n.useState)([]);Object(n.useEffect)(()=>{(async()=>{try{const{data:e}=await y.get("/whatsapp"),t=e.filter(e=>!0!==e.isDefault);s(t)}catch(e){C(e)}})()},[]);const c=e=>o.a.createElement("div",{className:r.customTableCell},"DISCONNECTED"===e.status&&o.a.createElement(Sn,{title:h.a.t("connections.toolTips.disconnected.title"),content:h.a.t("connections.toolTips.disconnected.content")},o.a.createElement(St.a,{color:"secondary"})),"OPENING"===e.status&&o.a.createElement(Pe.a,{size:24,className:r.buttonProgress}),"qrcode"===e.status&&o.a.createElement(Sn,{title:h.a.t("connections.toolTips.qrcode.title"),content:h.a.t("connections.toolTips.qrcode.content")},o.a.createElement(At.a,null)),"CONNECTED"===e.status&&o.a.createElement(Sn,{title:h.a.t("connections.toolTips.connected.title")},o.a.createElement(Nt.a,{style:{color:Ie.a[500]}})),("TIMEOUT"===e.status||"PAIRING"===e.status)&&o.a.createElement(Sn,{title:h.a.t("connections.toolTips.timeout.title"),content:h.a.t("connections.toolTips.timeout.content")},o.a.createElement(Mt.a,{color:"secondary"})));return o.a.createElement("div",{style:{marginTop:6}},o.a.createElement(ot.a,{fullWidth:!0,margin:"dense",variant:"outlined"},o.a.createElement(rt.a,null,"Selecione uma conex\xe3o*"),o.a.createElement(lt.a,{labelWidth:180,value:t,onChange:e=>{a(e.target.value)},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},getContentAnchorEl:null},renderValue:e=>(e=>{const t=l.find(t=>t.id===e);return t?o.a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},t.name,c(t)):null})(e)},l.map(e=>o.a.createElement(L.a,{key:e.id,value:e.id,style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},e.name,c(e))))))};const Nn=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles},textField:{marginRight:e.spacing(1),flex:1},extraAttr:{display:"flex",justifyContent:"center",alignItems:"center"},btnWrapper:{position:"relative",marginTop:e.spacing(2),marginRight:e.spacing(1)},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}})),Mn=Xe.c().shape({csv:Xe.d().required("Required"),model:Xe.d().required("Required")}),In=e=>{let{classes:t,contact:a,handleSaveContact:n,selectedQueueIds:r,setSelectedQueueIds:l,progressMessage:s,handlePreview:c}=e;return o.a.createElement("div",{className:t.root},o.a.createElement(Ze.d,{initialValues:a,enableReinitialize:!0,validationSchema:Mn,onSubmit:(e,t)=>{setTimeout(()=>{n(e,t)},400)}},e=>{let{values:a,errors:n,touched:i,isSubmitting:d,onChange:m}=e;return o.a.createElement(Ze.c,null,o.a.createElement("div",null,o.a.createElement(An,{selectedQueueIds:r,onChange:e=>l(e)}),o.a.createElement(Ze.a,{as:at.a,label:"Modelo",type:"model",multiline:!0,minRows:10,fullWidth:!0,name:"model",error:i.model&&Boolean(n.model),helperText:i.model&&n.model,variant:"outlined",margin:"dense"}),o.a.createElement(Ze.a,{as:at.a,label:"Dados",type:"csv",multiline:!0,minRows:5,fullWidth:!0,name:"csv",error:i.csv&&Boolean(n.csv),helperText:i.csv&&n.csv,variant:"outlined",margin:"dense"}),o.a.createElement(On,{progressMessage:s})),o.a.createElement("div",null,o.a.createElement(De.a,{variant:"contained",color:"secondary",disabled:d,onClick:()=>c(a),className:t.btnWrapper},"Mostrar preview"),o.a.createElement(De.a,{type:"submit",color:"primary",disabled:d,variant:"contained",className:t.btnWrapper},"Enviar Mensagem",d&&o.a.createElement(Pe.a,{size:24,className:t.buttonProgress}))))}))};var Rn=()=>{const e=Nn(),t=Object(n.useRef)(!0),[a,r]=Object(n.useState)(),[l,s]=Object(n.useState)(0),[c]=Object(n.useState)(!1),[i,m]=Object(n.useState)([]),u={csv:"",model:""},[p,g]=Object(n.useState)(u);Object(n.useEffect)(()=>()=>{t.current=!1},[]);const E=e=>(e||C("N\xfamero inv\xe1lido"),e.length>11&&e.startsWith("55")?"".concat(e):"55".concat(e));return o.a.createElement(Wt,{className:e.mainContainer},o.a.createElement(qt,null,o.a.createElement(Ft,null,"Envio de Mensagem")),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined"},o.a.createElement(In,{classes:e,contact:p,setContact:g,selectedQueueIds:a,setSelectedQueueIds:r,progressMessage:l,setProgressMessage:s,startSendMessage:c,handleSaveContact:async(e,t)=>{try{if(!e.csv||!e.model)return d.b.error("Preencha todos os campos"),void t.setSubmitting(!1);if(!a)return d.b.error("Selecione uma conex\xe3o"),void t.setSubmitting(!1);let{csv:o,model:r}=e;const l=o.slice(0,o.indexOf("\n")).split(","),c=o.slice(o.indexOf("\n")+1).split("\n").map(e=>{const t=e.split(",");return l.reduce((e,a,n)=>(e[a]=t[n],e),{})});let i=[],m=[];c.forEach((e,t)=>{i.push(r.replace(/\{([^}]+)\}/g,(t,a)=>e[a]))}),c.forEach(async(e,t)=>{const n=Object.values(e);m.push({message:i[t],phone:E(n[0]),whatsappId:a})});try{console.log(m),await y.post("/bulkMessage",m),g(u),s(0),t.setSubmitting(!1),d.b.success("".concat(m.length," Mensagem salva no banco de dados com sucesso"))}catch(n){C(n)}}catch(o){C(o)}},handlePreview:async e=>{try{let{csv:t,model:n}=e;const o=t.slice(0,t.indexOf("\n")).split(","),r=t.slice(t.indexOf("\n")+1).split("\n").map(e=>{const t=e.split(",");return o.reduce((e,a,n)=>(e[a]=t[n],e),{})});let l=[],s=[];r.forEach((e,t)=>{l.push(n.replace(/\{([^}]+)\}/g,(t,a)=>e[a]))}),r.forEach(async(e,t)=>{const n=Object.values(e);s.push({message:l[t],phone:E(n[0]),whatsappId:a})}),m(s)}catch(t){C(t)}}}),o.a.createElement("div",null,i.length>0&&o.a.createElement(Tn,{message:i}))))},jn=a(888),Dn=a(887);const Pn=Object(M.a)(e=>({root:{"& .MuiTextField-root":{margin:e.spacing(1)}},mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles},margin:{marginTop:e.spacing(2),marginRight:e.spacing(1)},withoutLabel:{marginTop:e.spacing(1)},textField:{width:"25ch"}}));var Wn=()=>{const e=Pn(),t=Object(n.useRef)(!0),[a,r]=Object(n.useState)([]),[l,s]=o.a.useState({}),[c,i]=o.a.useState({contact:!1,photo:!1,random:!1});Object(n.useEffect)(()=>{console.log("mudou",a),s({limit:"",minutes:"",seconds:""}),a&&y.get("/settingsMessage/".concat(a)).then(e=>{console.log("response",e.data),s({limit:e.data.limit,minutes:e.data.minutes,seconds:e.data.seconds}),i({contact:e.data.contacts,photo:e.data.photo,random:e.data.random})}).catch(e=>{C(e)})},[a]);const m=e=>t=>{s({...l,[e]:t.target.value})},u=e=>{i({...c,[e.target.name]:e.target.checked})};return Object(n.useEffect)(()=>()=>{t.current=!1},[]),o.a.createElement(Wt,{className:e.mainContainer},o.a.createElement(qt,null,o.a.createElement(Ft,null,"Configura\xe7\xe3o de envio de mensagem.")),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined"},o.a.createElement(An,{selectedQueueIds:a,onChange:e=>r(e)}),o.a.createElement("div",null,o.a.createElement(at.a,{label:"Limite de envio a cada 24h",id:"limit",onChange:m("limit"),className:Object(N.a)(e.margin,e.textField),value:l.limit,type:"number",InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},"Limite")}}),o.a.createElement(at.a,{label:"Aguardar entre",id:"minutes",value:l.minutes,onChange:m("minutes"),className:Object(N.a)(e.margin,e.textField),type:"number",InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},"Minutos")}}),o.a.createElement(at.a,{label:"Segundos a cada envio",id:"seconds",value:l.seconds,onChange:m("seconds"),className:Object(N.a)(e.margin,e.textField),type:"number",InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},"Segundos")}})),o.a.createElement("div",null,o.a.createElement(ot.a,{component:"fieldset",fullWidth:!0,className:e.margin},o.a.createElement(Dn.a,{component:"legend"},"Configura\xe7\xf5es adicionais"),o.a.createElement(Kt.a,null,o.a.createElement(Qt.a,{control:o.a.createElement(Gt.a,{checked:c.contact,onChange:u,name:"contact"}),label:"Enviar s\xf3 para os meus contatos"}),o.a.createElement(Qt.a,{control:o.a.createElement(Gt.a,{checked:c.photo,onChange:u,name:"photo"}),label:"Enviar mensagem s\xf3 para os numeros que tem foto"}),o.a.createElement(Qt.a,{control:o.a.createElement(Gt.a,{checked:c.random,onChange:u,name:"random"}),label:"Enviar em orderm aleatoria  "}))),o.a.createElement(ot.a,{fullWidth:!0,className:e.margin},o.a.createElement(rt.a,{htmlFor:"standard-adornment-amount"},"Incluir mensagem no final com op\xe7\xe3o de n\xe3o receber mais (opt-out)"),o.a.createElement(jn.a,{id:"standard-adornment-amount",onChange:m("optOut"),multiline:!0,rows:5,margin:"dense",variant:"outlined"}))),o.a.createElement("div",null,o.a.createElement(De.a,{variant:"contained",color:"primary",className:e.margin,onClick:()=>{(async()=>{const e={...l,...c,whatsappId:a};try{await y.post("/settingsMessage",e),d.b.success(h.a.t("settings.success"))}catch(t){C(t)}console.log(e)})()}},"Salvar configura\xe7\xf5es"))))};const _n=Object(M.a)(e=>({root:{display:"flex",alignItems:"center",padding:e.spacing(8,8,3)},paper:{padding:e.spacing(2),display:"flex",alignItems:"center",marginBottom:12},settingOption:{marginLeft:"auto"},margin:{margin:e.spacing(1)}}));var qn=()=>{const e=_n(),[t,a]=Object(n.useState)([]);Object(n.useEffect)(()=>{(async()=>{try{const{data:e}=await y.get("/settings");a(e)}catch(e){C(e)}})()},[]),Object(n.useEffect)(()=>{const e=E();return e.on("settings",e=>{"update"===e.action&&a(t=>{const a=[...t],n=a.findIndex(t=>t.key===e.setting.key);return a[n].value=e.setting.value,a})}),()=>{e.disconnect()}},[]);const r=async e=>{const t=e.target.value,a=e.target.name;try{await y.put("/settings/".concat(a),{value:t}),d.b.success(h.a.t("settings.success"))}catch(n){C(n)}},l=e=>{const{value:a}=t.find(t=>t.key===e);return a};return o.a.createElement("div",{className:e.root},o.a.createElement(Dt.a,{className:e.container},o.a.createElement(_.a,{variant:"body2",gutterBottom:!0},h.a.t("settings.title")),o.a.createElement(Ct.a,{className:e.paper},o.a.createElement(_.a,{variant:"body1"},h.a.t("settings.settings.userCreation.name")),o.a.createElement(lt.a,{margin:"dense",variant:"outlined",native:!0,id:"userCreation-setting",name:"userCreation",value:t&&t.length>0&&l("userCreation"),className:e.settingOption,onChange:r},o.a.createElement("option",{value:"enabled"},h.a.t("settings.settings.userCreation.options.enabled")),o.a.createElement("option",{value:"disabled"},h.a.t("settings.settings.userCreation.options.disabled")))),o.a.createElement(_.a,{variant:"body2",gutterBottom:!0}),o.a.createElement(Ue.a,{title:h.a.t("settings.settings.timeCreateNewTicket.note")},o.a.createElement(Ct.a,{className:e.paper,elevation:3},o.a.createElement(_.a,{variant:"body1"},h.a.t("settings.settings.timeCreateNewTicket.name")),o.a.createElement(lt.a,{margin:"dense",variant:"outlined",native:!0,id:"timeCreateNewTicket-setting",name:"timeCreateNewTicket",value:t&&t.length>0&&l("timeCreateNewTicket"),className:e.settingOption,onChange:r},o.a.createElement("option",{value:"10"},h.a.t("settings.settings.timeCreateNewTicket.options.10")),o.a.createElement("option",{value:"30"},h.a.t("settings.settings.timeCreateNewTicket.options.30")),o.a.createElement("option",{value:"60"},h.a.t("settings.settings.timeCreateNewTicket.options.60")),o.a.createElement("option",{value:"300"},h.a.t("settings.settings.timeCreateNewTicket.options.300")),o.a.createElement("option",{value:"1800"},h.a.t("settings.settings.timeCreateNewTicket.options.1800")),o.a.createElement("option",{value:"3600"},h.a.t("settings.settings.timeCreateNewTicket.options.3600")),o.a.createElement("option",{value:"7200"},h.a.t("settings.settings.timeCreateNewTicket.options.7200")),o.a.createElement("option",{value:"21600"},h.a.t("settings.settings.timeCreateNewTicket.options.21600")),o.a.createElement("option",{value:"43200"},h.a.t("settings.settings.timeCreateNewTicket.options.43200")),o.a.createElement("option",{value:"86400"},h.a.t("settings.settings.timeCreateNewTicket.options.86400")),o.a.createElement("option",{value:"172800"},h.a.t("settings.settings.timeCreateNewTicket.options.172800"))))),o.a.createElement(_.a,{variant:"body2",gutterBottom:!0}),o.a.createElement(Ct.a,{className:e.paper},o.a.createElement(_.a,{variant:"body1"},h.a.t("settings.settings.call.name")),o.a.createElement(lt.a,{margin:"dense",variant:"outlined",native:!0,id:"call-setting",name:"call",value:t&&t.length>0&&l("call"),className:e.settingOption,onChange:r},o.a.createElement("option",{value:"enabled"},h.a.t("settings.settings.call.options.enabled")),o.a.createElement("option",{value:"disabled"},h.a.t("settings.settings.call.options.disabled")))),o.a.createElement(Ct.a,{className:e.paper},o.a.createElement(_.a,{variant:"body1"},h.a.t("settings.settings.CheckMsgIsGroup.name")),o.a.createElement(lt.a,{margin:"dense",variant:"outlined",native:!0,id:"CheckMsgIsGroup-setting",name:"CheckMsgIsGroup",value:t&&t.length>0&&l("CheckMsgIsGroup"),className:e.settingOption,onChange:r},o.a.createElement("option",{value:"enabled"},h.a.t("settings.settings.CheckMsgIsGroup.options.enabled")),o.a.createElement("option",{value:"disabled"},h.a.t("settings.settings.CheckMsgIsGroup.options.disabled")))),o.a.createElement(Ct.a,{className:e.paper},o.a.createElement(at.a,{id:"api-token-setting",readonly:!0,label:"Token Api",margin:"dense",variant:"outlined",fullWidth:!0,value:t&&t.length>0&&l("userApiToken")})),o.a.createElement(Ct.a,{className:e.paper},o.a.createElement(_.a,{variant:"body1"},"Tipo do Chatbot"),o.a.createElement(lt.a,{margin:"dense",variant:"outlined",native:!0,id:"chatBotType-setting",name:"chatBotType",value:t&&t.length>0&&l("chatBotType"),className:e.settingOption,onChange:r},o.a.createElement("option",{value:"text"},"Texto"),o.a.createElement("option",{value:"button"},"Bot\xe3o"),o.a.createElement("option",{value:"list"},"Lista")))))};const Ln=(e,t)=>{if("LOAD_QUICK_ANSWERS"===t.type){const a=t.payload,n=[];return a.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:n.push(t)}),[...e,...n]}if("UPDATE_QUICK_ANSWERS"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,[...e]):[a,...e]}if("DELETE_MASS_MESSAGE"===t.type){const a=t.payload;console.log(a);const n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]},Bn=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}}));var Fn=()=>{const e=Bn(),[t,a]=Object(n.useState)(!1),[r,l]=Object(n.useState)(1),[s,c]=Object(n.useState)(""),[i,m]=Object(n.useReducer)(Ln,[]),[u,p]=Object(n.useState)(null),[g,b]=Object(n.useState)(!1),[f,v]=Object(n.useState)(!1);Object(n.useEffect)(()=>{m({type:"RESET"}),l(1)},[s]),Object(n.useEffect)(()=>{a(!0);const e=setTimeout(()=>{(async()=>{try{const{data:e}=await y.get("/bulkMessage/report",{params:{searchParam:s,pageNumber:r}});m({type:"LOAD_QUICK_ANSWERS",payload:e.messages}),v(e.hasMore),a(!1)}catch(e){C(e)}})()},500);return()=>clearTimeout(e)},[s,r]),Object(n.useEffect)(()=>{const e=E();return e.on("massMessage",e=>{"update"!==e.action&&"create"!==e.action||m({type:"UPDATE_QUICK_ANSWERS",payload:e.scheduleRecord}),"delete"===e.action&&(console.log("delete"),m({type:"DELETE_MASS_MESSAGE",payload:+e.scheduleRecord}))}),()=>{e.disconnect()}},[]);return o.a.createElement(Wt,null,o.a.createElement($t,{title:u&&"Voc\xea tem certeza que quer excluir este relat\xf3rio: ".concat(u.phone,"?"),open:g,onClose:b,onConfirm:()=>(async e=>{try{await y.delete("/bulkMessage/d/".concat(e)),d.b.success(h.a.t("quickAnswers.toasts.deleted"))}catch(t){C(t)}p(null),c(""),l(1)})(u.id)},h.a.t("quickAnswers.confirmationModal.deleteMessage")),o.a.createElement(qt,null,o.a.createElement(Ft,null,"Relat\xf3rio de envio de mensagens"),o.a.createElement(Bt,null,o.a.createElement(at.a,{placeholder:h.a.t("quickAnswers.searchPlaceholder"),type:"search",value:s,onChange:e=>{c(e.target.value.toLowerCase())},InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},o.a.createElement(sa.a,{style:{color:"gray"}}))}}),o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:async()=>{try{await y.delete("/bulkMessage/clean"),d.b.success(h.a.t("quickAnswers.toasts.deleted"))}catch(e){C(e)}i(Ln,[]),p(null),c(""),l(1)}},"Limpar base"))),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!f||t)return;const{scrollTop:a,scrollHeight:n,clientHeight:o}=e.currentTarget;n-(a+100)<o&&l(e=>e+1)}},o.a.createElement(kt.a,{size:"small"},o.a.createElement(Ot.a,null,o.a.createElement(wt.a,null,o.a.createElement(Tt.a,{align:"center"},"Conex\xe3o"),o.a.createElement(Tt.a,{align:"center"},"Numero"),o.a.createElement(Tt.a,{align:"center"},"Mensagem"),o.a.createElement(Tt.a,{align:"center"},"Status"),o.a.createElement(Tt.a,{align:"center"},h.a.t("quickAnswers.table.actions")))),o.a.createElement(xt.a,null,o.a.createElement(o.a.Fragment,null,i.map(e=>{var t,a;return o.a.createElement(wt.a,{key:e.id},o.a.createElement(Tt.a,{align:"center"},null===e||void 0===e||null===(t=e.whatsapp)||void 0===t?void 0:t.name," /"," ",null===e||void 0===e||null===(a=e.whatsapp)||void 0===a?void 0:a.number),o.a.createElement(Tt.a,{align:"center"},e.phone),o.a.createElement(Tt.a,{align:"center"},e.message),o.a.createElement(Tt.a,{align:"center"},e.status),o.a.createElement(Tt.a,{align:"center"},o.a.createElement(R.a,{size:"small",onClick:t=>{b(!0),p(e)}},o.a.createElement(jt.a,null))))}),t&&o.a.createElement(Ht,{columns:3}))))))};const zn=Object(M.a)(e=>({paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}})),Un=Xe.c().shape({name:Xe.d().min(2,"Too Short!").max(50,"Too Long!").required("Required"),password:Xe.d().min(5,"Too Short!").max(50,"Too Long!"),email:Xe.d().email("Invalid email").required("Required")});var Hn=()=>{const e=zn(),t=Object(i.g)(),[a,r]=Object(n.useState)(!1),[l]=Object(n.useState)({name:"",email:"",password:""});return o.a.createElement(Dt.a,{component:"main",maxWidth:"xs"},o.a.createElement(s.a,null),o.a.createElement("div",{className:e.paper},o.a.createElement(je.a,{className:e.avatar},o.a.createElement(ja.a,null)),o.a.createElement(_.a,{component:"h1",variant:"h5"},h.a.t("signup.title")),o.a.createElement(Ze.d,{initialValues:l,enableReinitialize:!0,validationSchema:Un,onSubmit:(e,a)=>{setTimeout(()=>{(async e=>{try{await y.post("/auth/signup",e),d.b.success(h.a.t("signup.toasts.success")),t.push("/login")}catch(a){C(a)}})(e),a.setSubmitting(!1)},400)}},t=>{let{touched:n,errors:l,isSubmitting:s}=t;return o.a.createElement(Ze.c,{className:e.form},o.a.createElement(Vt.a,{container:!0,spacing:2},o.a.createElement(Vt.a,{item:!0,xs:12},o.a.createElement(Ze.a,{as:at.a,autoComplete:"name",name:"name",error:n.name&&Boolean(l.name),helperText:n.name&&l.name,variant:"outlined",fullWidth:!0,id:"name",label:h.a.t("signup.form.name"),autoFocus:!0})),o.a.createElement(Vt.a,{item:!0,xs:12},o.a.createElement(Ze.a,{as:at.a,variant:"outlined",fullWidth:!0,id:"email",label:h.a.t("signup.form.email"),name:"email",error:n.email&&Boolean(l.email),helperText:n.email&&l.email,autoComplete:"email"})),o.a.createElement(Vt.a,{item:!0,xs:12},o.a.createElement(Ze.a,{as:at.a,variant:"outlined",fullWidth:!0,name:"password",id:"password",autoComplete:"current-password",error:n.password&&Boolean(l.password),helperText:n.password&&l.password,label:h.a.t("signup.form.password"),type:a?"text":"password",InputProps:{endAdornment:o.a.createElement(nt.a,{position:"end"},o.a.createElement(R.a,{"aria-label":"toggle password visibility",onClick:()=>r(e=>!e)},a?o.a.createElement(ct.a,null):o.a.createElement(it.a,null)))}}))),o.a.createElement(De.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:e.submit},h.a.t("signup.buttons.submit")),o.a.createElement(Vt.a,{container:!0,justifyContent:"flex-end"},o.a.createElement(Vt.a,{item:!0},o.a.createElement(Ia.a,{href:"#",variant:"body2",component:c.b,to:"/login"},h.a.t("signup.buttons.login")))))})),o.a.createElement(Ra.a,{mt:5}))},Qn=a(550);const Gn=Object(M.a)(e=>({root:{display:"flex",flexWrap:"wrap"},multFieldLine:{display:"flex","& > *:not(:last-child)":{marginRight:e.spacing(1)}},btnWrapper:{position:"relative"},buttonProgress:{color:Ie.a[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},formControl:{margin:e.spacing(1),minWidth:120},colorAdorment:{width:20,height:20}})),Vn=Xe.c().shape({name:Xe.d().min(3,"Mensagem muito curta").required("Obrigat\xf3rio")});var Kn=e=>{let{open:t,onClose:a,tagId:r,reload:l}=e;const s=Gn(),{user:c}=Object(n.useContext)(O),[i,m]=Object(n.useState)(!1),u={name:"",color:""},[p,g]=Object(n.useState)(u);Object(n.useEffect)(()=>{try{(async()=>{if(!r)return;const{data:e}=await y.get("/tags/".concat(r));g(t=>({...t,...e}))})()}catch(e){C(e)}},[r,t]);const E=()=>{g(u),m(!1),a()};return o.a.createElement("div",{className:s.root},o.a.createElement($e.a,{open:t,onClose:E,maxWidth:"xs",fullWidth:!0,scroll:"paper"},o.a.createElement(et.a,{id:"form-dialog-title"},"".concat(r?h.a.t("tagModal.title.edit"):h.a.t("tagModal.title.add"))),o.a.createElement(Ze.d,{initialValues:p,enableReinitialize:!0,validationSchema:Vn,onSubmit:(e,t)=>{setTimeout(()=>{(async e=>{const t={...e,userId:c.id};try{r?await y.put("/tags/".concat(r),t):await y.post("/tags",t),d.b.success(h.a.t("tagModal.success")),"function"==typeof l&&l()}catch(a){C(a)}E()})(e),t.setSubmitting(!1)},400)}},e=>{let{touched:t,errors:a,isSubmitting:n,values:l}=e;return o.a.createElement(Ze.c,null,o.a.createElement(tt.a,{dividers:!0},o.a.createElement("div",{className:s.multFieldLine},o.a.createElement(Ze.a,{as:at.a,label:h.a.t("tagModal.form.name"),name:"name",error:t.name&&Boolean(a.name),helperText:t.name&&a.name,variant:"outlined",margin:"dense",onChange:e=>g(t=>({...t,name:e.target.value})),fullWidth:!0})),o.a.createElement("br",null),o.a.createElement("div",{className:s.multFieldLine},o.a.createElement(Ze.a,{as:at.a,fullWidth:!0,label:h.a.t("tagModal.form.color"),name:"color",id:"color",error:t.color&&Boolean(a.color),helperText:t.color&&a.color,InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},o.a.createElement("div",{style:{backgroundColor:l.color},className:s.colorAdorment})),endAdornment:o.a.createElement(R.a,{size:"small",color:"default",onClick:()=>m(!i)},o.a.createElement(za.a,null))},variant:"outlined",margin:"dense"})),i&&o.a.createElement("div",null,o.a.createElement(Qn.a,{disableAlpha:!0,hslGradient:!1,style:{margin:"20px auto 0"},value:p.color,onChange:e=>{g(t=>({...t,color:"#".concat(e.hex)}))}}))),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:E,color:"secondary",disabled:n,variant:"outlined"},h.a.t("tagModal.buttons.cancel")),o.a.createElement(De.a,{type:"submit",color:"primary",disabled:n,variant:"contained",className:s.btnWrapper},"".concat(r?h.a.t("tagModal.buttons.okEdit"):h.a.t("tagModal.buttons.okAdd")),n&&o.a.createElement(Pe.a,{size:24,className:s.buttonProgress}))))})))};const Yn=(e,t)=>{if("LOAD_TAGS"===t.type){const a=t.payload,n=[];return a.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:n.push(t)}),[...e,...n]}if("UPDATE_TAGS"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,[...e]):[a,...e]}if("DELETE_TAG"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]},Jn=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}}));var Xn=()=>{const e=Jn(),[t,a]=Object(n.useState)(!1),[r,l]=Object(n.useState)(1),[s,c]=Object(n.useState)(!1),[i,m]=Object(n.useState)(null),[u,p]=Object(n.useState)(null),[g,b]=Object(n.useState)(!1),[f,v]=Object(n.useState)(""),[k,O]=Object(n.useReducer)(Yn,[]),[w,T]=Object(n.useState)(!1),x=Object(n.useCallback)(async()=>{try{const{data:e}=await y.get("/tags/",{params:{searchParam:f,pageNumber:r}});O({type:"LOAD_TAGS",payload:e.tags}),c(e.hasMore),a(!1)}catch(e){C(e)}},[f,r]);Object(n.useEffect)(()=>{O({type:"RESET"}),l(1)},[f]),Object(n.useEffect)(()=>{a(!0);const e=setTimeout(()=>{x()},500);return()=>clearTimeout(e)},[f,r,x]),Object(n.useEffect)(()=>{const e=E();return e.on("user",e=>{"update"!==e.action&&"create"!==e.action||O({type:"UPDATE_TAGS",payload:e.tags}),"delete"===e.action&&O({type:"DELETE_USER",payload:+e.tagId})}),()=>{e.disconnect()}},[]);return o.a.createElement(Wt,null,o.a.createElement($t,{title:u&&"".concat(h.a.t("tags.confirmationModal.deleteTitle")),open:g,onClose:b,onConfirm:()=>(async e=>{try{await y.delete("/tags/".concat(e)),d.b.success(h.a.t("tags.toasts.deleted"))}catch(t){C(t)}p(null),v(""),l(1),O({type:"RESET"}),l(1),await x()})(u.id)},h.a.t("tags.confirmationModal.deleteMessage")),o.a.createElement(Kn,{open:w,onClose:()=>{m(null),T(!1)},reload:x,"aria-labelledby":"form-dialog-title",tagId:i&&i.id}),o.a.createElement(qt,null,o.a.createElement(Ft,null,h.a.t("tags.title")),o.a.createElement(Bt,null,o.a.createElement(at.a,{placeholder:h.a.t("contacts.searchPlaceholder"),type:"search",value:f,onChange:e=>{v(e.target.value.toLowerCase())},InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},o.a.createElement(sa.a,{style:{color:"gray"}}))}}),o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:()=>{m(null),T(!0)}},h.a.t("tags.buttons.add")))),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!s||t)return;const{scrollTop:a,scrollHeight:n,clientHeight:o}=e.currentTarget;n-(a+100)<o&&l(e=>e+1)}},o.a.createElement(kt.a,{size:"small"},o.a.createElement(Ot.a,null,o.a.createElement(wt.a,null,o.a.createElement(Tt.a,{align:"center"},h.a.t("tags.table.name")),o.a.createElement(Tt.a,{align:"center"},h.a.t("tags.table.tickets")),o.a.createElement(Tt.a,{align:"center"},h.a.t("tags.table.actions")))),o.a.createElement(xt.a,null,o.a.createElement(o.a.Fragment,null,k.map(e=>o.a.createElement(wt.a,{key:e.id},o.a.createElement(Tt.a,{align:"center"},o.a.createElement(dt.a,{variant:"outlined",style:{backgroundColor:e.color,textShadow:"1px 1px 1px #000",color:"white"},label:e.name,size:"small"})),o.a.createElement(Tt.a,{align:"center"},e.ticketsCount),o.a.createElement(Tt.a,{align:"center"},o.a.createElement(R.a,{size:"small",onClick:()=>(e=>{m(e),T(!0)})(e)},o.a.createElement(ma.a,null)),o.a.createElement(R.a,{size:"small",onClick:t=>{b(!0),p(e)}},o.a.createElement(ia.a,null))))),t&&o.a.createElement(Ht,{columns:4}))))))},Zn=a(558),$n=a(1003),eo=a(986),to=a(533),ao=a.n(to),no=a(534),oo=a.n(no);function ro(e){let{onFiltered:t}=e;const[a,r]=Object(n.useState)([]),[l,s]=Object(n.useState)([]);Object(n.useEffect)(()=>{!async function(){await c()}()},[]);const c=async()=>{try{const{data:e}=await y.get("/tags/list");r(e)}catch(e){C(e)}};return o.a.createElement(Ct.a,{style:{padding:10}},o.a.createElement(mn.a,{multiple:!0,size:"small",options:a,value:l,onChange:(e,a,n)=>(async e=>{s(e),t(e)})(a),getOptionLabel:e=>e.name,renderTags:(e,t)=>e.map((e,a)=>o.a.createElement(dt.a,Object.assign({variant:"outlined",style:{backgroundColor:e.color||"#eee",textShadow:"1px 1px 1px #000",color:"white"},label:e.name},t({index:a}),{size:"small"}))),renderInput:e=>o.a.createElement(at.a,Object.assign({},e,{variant:"outlined",placeholder:"Filtro por Tags"}))}))}var lo=a(984);const so=Object(lo.a)({trim:!0});var co=e=>{let{modalOpen:t,onClose:a}=e;const r=Object(i.g)(),[l,s]=Object(n.useState)([]),[c,d]=Object(n.useState)(!1),[m,u]=Object(n.useState)(""),[p,g]=Object(n.useState)(null),[E,b]=Object(n.useState)({}),[f,v]=Object(n.useState)(!1),{user:k}=Object(n.useContext)(O);Object(n.useEffect)(()=>{if(!t||m.length<3)return void d(!1);d(!0);const e=setTimeout(()=>{(async()=>{try{const{data:e}=await y.get("contacts",{params:{searchParam:m}});s(e.contacts),d(!1)}catch(e){d(!1),C(e)}})()},500);return()=>clearTimeout(e)},[m,t]);const w=()=>{a(),u(""),g(null)},T=async e=>{if(e){d(!0);try{const{data:t}=await y.post("/tickets",{contactId:e,userId:k.id,status:"open"});r.push("/tickets/".concat(t.id))}catch(t){C(t)}d(!1),w()}};return o.a.createElement(o.a.Fragment,null,o.a.createElement(ga,{open:f,initialValues:E,onClose:()=>{v(!1)},onSave:e=>{T(e.id)}}),o.a.createElement($e.a,{open:t,onClose:w},o.a.createElement(et.a,{id:"form-dialog-title"},h.a.t("newTicketModal.title")),o.a.createElement(tt.a,{dividers:!0},o.a.createElement(mn.a,{options:l,loading:c,style:{width:300},clearOnBlur:!0,autoHighlight:!0,freeSolo:!0,clearOnEscape:!0,getOptionLabel:e=>e.number?"".concat(e.name," - ").concat(e.number):"".concat(e.name),renderOption:e=>e.number?"".concat(e.name," - ").concat(e.number):"".concat(h.a.t("newTicketModal.add")," ").concat(e.name),filterOptions:(e,t)=>{const a=so(e,t);return""!==t.inputValue&&!c&&m.length>=3&&a.push({name:"".concat(t.inputValue)}),a},onChange:(e,t)=>((e,t)=>{(null===t||void 0===t?void 0:t.number)?g(t):(null===t||void 0===t?void 0:t.name)&&(b({name:t.name}),v(!0))})(0,t),renderInput:e=>o.a.createElement(at.a,Object.assign({},e,{label:h.a.t("newTicketModal.fieldLabel"),variant:"outlined",autoFocus:!0,onChange:e=>u(e.target.value),onKeyPress:e=>{!c&&p&&"Enter"===e.key&&T(p.id)},InputProps:{...e.InputProps,endAdornment:o.a.createElement(o.a.Fragment,null,c?o.a.createElement(Pe.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment)}}))})),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:w,color:"secondary",disabled:c,variant:"outlined"},h.a.t("newTicketModal.buttons.cancel")),o.a.createElement(_e,{variant:"contained",type:"button",disabled:!p,onClick:()=>T(p.id),color:"primary",loading:c},h.a.t("newTicketModal.buttons.ok")))))};var io=()=>o.a.createElement(o.a.Fragment,null,o.a.createElement(V.a,{dense:!0},o.a.createElement(Re.a,null,o.a.createElement(zt.a,{animation:"wave",variant:"circle",width:40,height:40})),o.a.createElement(Y.a,{primary:o.a.createElement(zt.a,{animation:"wave",height:20,width:60}),secondary:o.a.createElement(zt.a,{animation:"wave",height:20,width:90})})),o.a.createElement(j.a,{variant:"inset"}),o.a.createElement(V.a,{dense:!0},o.a.createElement(Re.a,null,o.a.createElement(zt.a,{animation:"wave",variant:"circle",width:40,height:40})),o.a.createElement(Y.a,{primary:o.a.createElement(zt.a,{animation:"wave",height:20,width:70}),secondary:o.a.createElement(zt.a,{animation:"wave",height:20,width:120})})),o.a.createElement(j.a,{variant:"inset"}),o.a.createElement(V.a,{dense:!0},o.a.createElement(Re.a,null,o.a.createElement(zt.a,{animation:"wave",variant:"circle",width:40,height:40})),o.a.createElement(Y.a,{primary:o.a.createElement(zt.a,{animation:"wave",height:20,width:60}),secondary:o.a.createElement(zt.a,{animation:"wave",height:20,width:90})})),o.a.createElement(j.a,{variant:"inset"}));const mo=Object(M.a)(e=>({ticketsListWrapper:{position:"relative",display:"flex",height:"100%",flexDirection:"column",overflow:"hidden",borderTopRightRadius:0,borderBottomRightRadius:0},ticketsList:{flex:1,overflowY:"scroll",...e.scrollbarStyles,borderTop:"2px solid rgba(0, 0, 0, 0.12)"},ticketsListHeader:{color:"rgb(67, 83, 105)",zIndex:2,backgroundColor:"white",borderBottom:"1px solid rgba(0, 0, 0, 0.12)",display:"flex",alignItems:"center",justifyContent:"space-between"},ticketsCount:{fontWeight:"normal",color:"rgb(104, 121, 146)",marginLeft:"8px",fontSize:"14px"},noTicketsText:{textAlign:"center",color:"rgb(104, 121, 146)",fontSize:"14px",lineHeight:"1.4"},noTicketsTitle:{textAlign:"center",fontSize:"16px",fontWeight:"600",margin:"0px"},noTicketsDiv:{display:"flex",height:"100px",margin:40,flexDirection:"column",alignItems:"center",justifyContent:"center"}})),uo=(e,t)=>{if("LOAD_TICKETS"===t.type){return t.payload.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?(e[a]=t,t.unreadMessages>0&&e.unshift(e.splice(a,1)[0])):e.push(t)}),[...e]}if("RESET_UNREAD"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&(e[n].unreadMessages=0),[...e]}if("UPDATE_TICKET"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?e[n]=a:e.unshift(a),[...e]}if("UPDATE_TICKET_UNREAD_MESSAGES"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,e.unshift(e.splice(n,1)[0])):e.unshift(a),[...e]}if("UPDATE_TICKET_CONTACT"===t.type){const a=t.payload,n=e.findIndex(e=>e.contactId===a.id);return-1!==n&&(e[n].contact=a),[...e]}if("DELETE_TICKET"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]};var po=e=>{const{status:t,searchParam:a,showAll:r,selectedQueueIds:l,updateCount:s,style:c,tags:i}=e,d=mo(),[m,u]=Object(n.useState)(1),[p,g]=Object(n.useReducer)(uo,[]),{user:b}=Object(n.useContext)(O),{profile:f,queues:v}=b;Object(n.useEffect)(()=>{g({type:"RESET"}),u(1)},[t,a,g,r,l,i]);const{tickets:y,hasMore:C,loading:k}=Ge({pageNumber:m,searchParam:a,status:t,showAll:r,tags:JSON.stringify(i),queueIds:JSON.stringify(l)});Object(n.useEffect)(()=>{const e=v.map(e=>e.id),t=y.filter(t=>e.indexOf(t.queueId)>-1);g("user"===f?{type:"LOAD_TICKETS",payload:t}:{type:"LOAD_TICKETS",payload:y})},[y,t,a,v,f]),Object(n.useEffect)(()=>{const e=E(),a=e=>(!e.userId||e.userId===(null===b||void 0===b?void 0:b.id)||r)&&(!e.queueId||l.indexOf(e.queueId)>-1);return e.on("ready",()=>{t?e.emit("joinTickets",t):e.emit("joinNotification")}),e.on("ticket",e=>{var t;"updateUnread"===e.action&&g({type:"RESET_UNREAD",payload:e.ticketId}),"update"===e.action&&a(e.ticket)&&g({type:"UPDATE_TICKET",payload:e.ticket}),"update"===e.action&&((t=e.ticket).queueId&&-1===l.indexOf(t.queueId))&&g({type:"DELETE_TICKET",payload:e.ticket.id}),"delete"===e.action&&g({type:"DELETE_TICKET",payload:e.ticketId})}),e.on("appMessage",e=>{"create"===e.action&&a(e.ticket)&&g({type:"UPDATE_TICKET_UNREAD_MESSAGES",payload:e.ticket})}),e.on("contact",e=>{"update"===e.action&&g({type:"UPDATE_TICKET_CONTACT",payload:e.contact})}),()=>{e.disconnect()}},[t,r,b,l]),Object(n.useEffect)(()=>{"function"===typeof s&&s(p.length)},[p]);return o.a.createElement(Ct.a,{className:d.ticketsListWrapper,style:c},o.a.createElement(Ct.a,{square:!0,name:"closed",elevation:0,className:d.ticketsList,onScroll:e=>{if(!C||k)return;const{scrollTop:t,scrollHeight:a,clientHeight:n}=e.currentTarget;a-(t+100)<n&&u(e=>e+1)}},o.a.createElement(D.a,{style:{paddingTop:0}},0!==p.length||k?o.a.createElement(o.a.Fragment,null,p.map(e=>o.a.createElement(Qe,{ticket:e,key:e.id}))):o.a.createElement("div",{className:d.noTicketsDiv},o.a.createElement("span",{className:d.noTicketsTitle},h.a.t("ticketsList.noTicketsTitle")),o.a.createElement("p",{className:d.noTicketsText},h.a.t("ticketsList.noTicketsMessage"))),k&&o.a.createElement(io,null))))};var go=e=>{let{children:t,value:a,name:n,...r}=e;return a===n?o.a.createElement("div",Object.assign({role:"tabpanel",id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},r),o.a.createElement(o.a.Fragment,null,t)):null};var Eo=e=>{let{userQueues:t,selectedQueueIds:a=[],onChange:n}=e;return o.a.createElement("div",{style:{width:120,marginTop:-4}},o.a.createElement(ot.a,{fullWidth:!0,margin:"dense"},o.a.createElement(lt.a,{multiple:!0,displayEmpty:!0,variant:"outlined",value:a,onChange:e=>{n(e.target.value)},MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},getContentAnchorEl:null},renderValue:()=>h.a.t("ticketsQueueSelect.placeholder")},(null===t||void 0===t?void 0:t.length)>0&&t.map(e=>o.a.createElement(L.a,{dense:!0,key:e.id,value:e.id},o.a.createElement(Yt.a,{style:{color:e.color},size:"small",color:"primary",checked:a.indexOf(e.id)>-1}),o.a.createElement(Y.a,{primary:e.name}))))))};const ho=Object(M.a)(e=>({ticketsWrapper:{position:"relative",display:"flex",height:"100%",flexDirection:"column",overflow:"hidden",borderTopRightRadius:0,borderBottomRightRadius:0},tabsHeader:{flex:"none",backgroundColor:"#eee"},settingsIcon:{alignSelf:"center",marginLeft:"auto",padding:8},tab:{minWidth:120,width:120},ticketOptionsBox:{display:"flex",justifyContent:"space-between",alignItems:"center",background:"#fafafa",padding:e.spacing(1)},serachInputWrapper:{flex:1,background:"#fff",display:"flex",borderRadius:40,padding:4,marginRight:e.spacing(1)},searchIcon:{color:"grey",marginLeft:6,marginRight:6,alignSelf:"center"},searchInput:{flex:1,border:"none",borderRadius:30},badge:{right:"-10px"},show:{display:"block"},hide:{display:"none !important"}}));var bo=()=>{const e=ho(),[t,a]=Object(n.useState)(""),[r,l]=Object(n.useState)("open"),[s,c]=Object(n.useState)("open"),[i,d]=Object(n.useState)(!1),[m,u]=Object(n.useState)(!1),p=Object(n.useRef)(),{user:g}=Object(n.useContext)(O),[E,b]=Object(n.useState)(0),[f,v]=Object(n.useState)(0),[y,C]=Object(n.useState)([]),k=g.queues.map(e=>e.id),[w,T]=Object(n.useState)(k||[]);let x;Object(n.useEffect)(()=>{"ADMIN"===g.profile.toUpperCase()&&u(!0)},[]),Object(n.useEffect)(()=>{"search"===r&&p.current.focus()},[r]);const S=e=>{if(s!==e)return{width:0,height:0}};return o.a.createElement(Ct.a,{elevation:0,variant:"outlined",className:e.ticketsWrapper},o.a.createElement(co,{modalOpen:i,onClose:e=>d(!1)}),o.a.createElement(Ct.a,{elevation:0,square:!0,className:e.tabsHeader},o.a.createElement($n.a,{value:r,onChange:(e,t)=>{l(t)},variant:"fullWidth",indicatorColor:"primary",textColor:"primary","aria-label":"icon label tabs example"},o.a.createElement(eo.a,{value:"open",icon:o.a.createElement(ao.a,null),label:h.a.t("tickets.tabs.open.title"),classes:{root:e.tab}}),o.a.createElement(eo.a,{value:"closed",icon:o.a.createElement(oo.a,null),label:h.a.t("tickets.tabs.closed.title"),classes:{root:e.tab}}),o.a.createElement(eo.a,{value:"search",icon:o.a.createElement(sa.a,null),label:h.a.t("tickets.tabs.search.title"),classes:{root:e.tab}}))),o.a.createElement(Ct.a,{square:!0,elevation:0,className:e.ticketOptionsBox},"search"===r?o.a.createElement("div",{className:e.serachInputWrapper},o.a.createElement(sa.a,{className:e.searchIcon}),o.a.createElement(Zn.a,{className:e.searchInput,inputRef:p,placeholder:h.a.t("tickets.search.placeholder"),type:"search",onChange:e=>{const t=e.target.value.toLowerCase();if(clearTimeout(x),""===t)return a(t),void l("open");x=setTimeout(()=>{a(t)},500)}})):o.a.createElement(o.a.Fragment,null,o.a.createElement(De.a,{variant:"outlined",color:"primary",onClick:()=>d(!0)},h.a.t("ticketsManager.buttons.newTicket")),o.a.createElement(Ce,{role:g.profile,perform:"tickets-manager:showall",yes:()=>o.a.createElement(Qt.a,{label:h.a.t("tickets.buttons.showAll"),labelPlacement:"start",control:o.a.createElement(Gt.a,{size:"small",checked:m,onChange:()=>u(e=>!e),name:"showAllTickets",color:"primary"})})})),o.a.createElement(Eo,{style:{marginLeft:6},selectedQueueIds:w,userQueues:null===g||void 0===g?void 0:g.queues,onChange:e=>T(e)})),o.a.createElement(go,{value:r,name:"open",className:e.ticketsWrapper},o.a.createElement($n.a,{value:s,onChange:(e,t)=>{c(t)},indicatorColor:"primary",textColor:"primary",variant:"fullWidth"},o.a.createElement(eo.a,{label:o.a.createElement(G.a,{className:e.badge,badgeContent:E,color:"primary"},h.a.t("ticketsList.assignedHeader")),value:"open"}),o.a.createElement(eo.a,{label:o.a.createElement(G.a,{className:e.badge,badgeContent:f,color:"secondary"},h.a.t("ticketsList.pendingHeader")),value:"pending"})),o.a.createElement(Ct.a,{className:e.ticketsWrapper},o.a.createElement(po,{status:"open",showAll:m,selectedQueueIds:w,updateCount:e=>b(e),style:S("open")}),o.a.createElement(po,{status:"pending",selectedQueueIds:w,updateCount:e=>v(e),style:S("pending")}))),o.a.createElement(go,{value:r,name:"closed",className:e.ticketsWrapper},o.a.createElement(po,{status:"closed",showAll:!0,selectedQueueIds:w})),o.a.createElement(go,{value:r,name:"search",className:e.ticketsWrapper},o.a.createElement(ro,{onFiltered:e=>{const t=e.map(e=>e.id);C(t)}}),o.a.createElement(po,{searchParam:t,tags:y,showAll:!0,selectedQueueIds:w})))};function fo(e){let{ticket:t}=e;const[a,r]=Object(n.useState)([]),[l,s]=Object(n.useState)([]);Object(n.useEffect)(()=>{if(t){!async function(){await i(),Array.isArray(t.tags)&&s(t.tags)}()}},[t]);const c=async e=>{try{const{data:t}=await y.post("/tags",e);return t}catch(t){C(t)}},i=async()=>{try{const{data:e}=await y.get("/tags/list");r(e)}catch(e){C(e)}},d=async(e,a)=>{let n=[];if("create-option"===a){if(Object(gn.isArray)(e))for(let t of e)if(Object(gn.isString)(t)){const e=await c({name:t});n.push(e)}else n.push(t);await i()}else n=e;s(n),await(async e=>{try{const{data:t}=await y.post("/tags/sync",e);return t}catch(t){C(t)}})({ticketId:t.id,tags:n})};return o.a.createElement(Ct.a,{style:{padding:12}},o.a.createElement(mn.a,{multiple:!0,size:"small",options:a,value:l,freeSolo:!0,onChange:(e,t,a)=>d(t,a),getOptionLabel:e=>e.name,renderTags:(e,t)=>e.map((e,a)=>o.a.createElement(dt.a,Object.assign({variant:"outlined",style:{backgroundColor:e.color||"#eee",textShadow:"1px 1px 1px #000",color:"white"},label:e.name},t({index:a}),{size:"small"}))),renderInput:e=>o.a.createElement(at.a,Object.assign({},e,{variant:"outlined",placeholder:"Tags"})),PaperComponent:e=>{let{children:t}=e;return o.a.createElement(Ct.a,{style:{width:400,marginLeft:12}},t)}}))}var vo=a(535),yo=a.n(vo);var Co=e=>{let{classes:t}=e;return o.a.createElement("div",{className:t.content},o.a.createElement(Ct.a,{square:!0,variant:"outlined",className:t.contactHeader},o.a.createElement(zt.a,{animation:"wave",variant:"circle",width:160,height:160,className:t.contactAvatar}),o.a.createElement(zt.a,{animation:"wave",height:25,width:90}),o.a.createElement(zt.a,{animation:"wave",height:25,width:80}),o.a.createElement(zt.a,{animation:"wave",height:25,width:80})),o.a.createElement(Ct.a,{square:!0,className:t.contactDetails},o.a.createElement(_.a,{variant:"subtitle1"},h.a.t("contactDrawer.extraInfo")),o.a.createElement(Ct.a,{square:!0,variant:"outlined",className:t.contactExtraInfo},o.a.createElement(zt.a,{animation:"wave",height:20,width:60}),o.a.createElement(zt.a,{animation:"wave",height:20,width:160})),o.a.createElement(Ct.a,{square:!0,variant:"outlined",className:t.contactExtraInfo},o.a.createElement(zt.a,{animation:"wave",height:20,width:60}),o.a.createElement(zt.a,{animation:"wave",height:20,width:160})),o.a.createElement(Ct.a,{square:!0,variant:"outlined",className:t.contactExtraInfo},o.a.createElement(zt.a,{animation:"wave",height:20,width:60}),o.a.createElement(zt.a,{animation:"wave",height:20,width:160}))))};const ko=Object(M.a)(e=>({drawer:{width:320,flexShrink:0},drawerPaper:{width:320,display:"flex",borderTop:"1px solid rgba(0, 0, 0, 0.12)",borderRight:"1px solid rgba(0, 0, 0, 0.12)",borderBottom:"1px solid rgba(0, 0, 0, 0.12)",borderTopRightRadius:4,borderBottomRightRadius:4},header:{display:"flex",borderBottom:"1px solid rgba(0, 0, 0, 0.12)",backgroundColor:"#eee",alignItems:"center",padding:e.spacing(0,1),minHeight:"73px",justifyContent:"flex-start"},content:{display:"flex",backgroundColor:"#eee",flexDirection:"column",padding:"8px 0px 8px 8px",height:"100%",overflowY:"scroll",...e.scrollbarStyles},contactAvatar:{margin:15,width:160,height:160},contactHeader:{display:"flex",padding:8,flexDirection:"column",alignItems:"center",justifyContent:"center","& > *":{margin:4}},contactDetails:{marginTop:8,padding:8,display:"flex",flexDirection:"column"},contactExtraInfo:{marginTop:4,padding:6}}));var Oo=e=>{var t;let{open:a,handleDrawerClose:r,contact:l,loading:s}=e;const c=ko(),[i,d]=Object(n.useState)(!1);return o.a.createElement(I.a,{className:c.drawer,variant:"persistent",anchor:"right",open:a,PaperProps:{style:{position:"absolute"}},BackdropProps:{style:{position:"absolute"}},ModalProps:{container:document.getElementById("drawer-container"),style:{position:"absolute"}},classes:{paper:c.drawerPaper}},o.a.createElement("div",{className:c.header},o.a.createElement(R.a,{onClick:r},o.a.createElement(yo.a,null)),o.a.createElement(_.a,{style:{justifySelf:"center"}},h.a.t("contactDrawer.header"))),s?o.a.createElement(Co,{classes:c}):o.a.createElement("div",{className:c.content},o.a.createElement(Ct.a,{square:!0,variant:"outlined",className:c.contactHeader},o.a.createElement(je.a,{alt:l.name,src:l.profilePicUrl,className:c.contactAvatar}),o.a.createElement(_.a,null,l.name),o.a.createElement(_.a,null,o.a.createElement(Ia.a,{href:"tel:".concat(l.number)},l.number)),o.a.createElement(De.a,{variant:"outlined",color:"primary",onClick:()=>d(!0)},h.a.t("contactDrawer.buttons.edit"))),o.a.createElement(Ct.a,{square:!0,variant:"outlined",className:c.contactDetails},o.a.createElement(ga,{open:i,onClose:()=>d(!1),contactId:l.id}),o.a.createElement(_.a,{variant:"subtitle1"},h.a.t("contactDrawer.extraInfo")),null===l||void 0===l||null===(t=l.extraInfo)||void 0===t?void 0:t.map(e=>o.a.createElement(Ct.a,{key:e.id,square:!0,variant:"outlined",className:c.contactExtraInfo},o.a.createElement(rt.a,null,e.name),o.a.createElement(_.a,{component:"div",noWrap:!0,style:{paddingTop:2}},o.a.createElement(ze,null,e.value)))))))},wo=(a(876),a(547)),To=a(536),xo=a.n(To),So=a(355),Ao=a.n(So),No=a(539),Mo=a.n(No),Io=a(354),Ro=a.n(Io),jo=a(353),Do=a.n(jo),Po=a(538),Wo=a.n(Po),_o=a(537),qo=a.n(_o),Lo=a(542),Bo=a.n(Lo),Fo=a(541),zo=a.n(Fo),Uo=a(540),Ho=a.n(Uo),Qo=a(1004),Go=a(987);const Vo=Object(M.a)(e=>({timerBox:{display:"flex",marginLeft:10,marginRight:10,alignItems:"center"}}));var Ko=()=>{const e=Vo(),[t,a]=Object(n.useState)({minutes:0,seconds:0});Object(n.useEffect)(()=>{const e=setInterval(()=>a(e=>59===e.seconds?{...e,minutes:e.minutes+1,seconds:0}:{...e,seconds:e.seconds+1}),1e3);return()=>{clearInterval(e)}},[]);const r=e=>e<10?"0"+e:e;return o.a.createElement("div",{className:e.timerBox},o.a.createElement("span",null,"".concat(r(t.minutes),":").concat(r(t.seconds))))};const Yo=Object(n.createContext)(),Jo=e=>{let{children:t}=e;const[a,r]=Object(n.useState)(null);return o.a.createElement(Yo.Provider,{value:{replyingMessage:a,setReplyingMessage:r}},t)};const Xo=new xo.a({bitRate:128}),Zo=Object(M.a)(e=>({mainWrapper:{background:"#eee",display:"flex",flexDirection:"column",alignItems:"center",borderTop:"1px solid rgba(0, 0, 0, 0.12)",[e.breakpoints.down("sm")]:{position:"fixed",bottom:0,width:"100%"}},newMessageBox:{background:"#eee",width:"100%",display:"flex",padding:"7px",alignItems:"center"},messageInputWrapper:{padding:6,marginRight:7,background:"#fff",display:"flex",borderRadius:20,flex:1,position:"relative"},messageInput:{paddingLeft:10,flex:1,border:"none"},sendMessageIcons:{color:"grey"},uploadInput:{display:"none"},viewMediaInputWrapper:{display:"flex",padding:"10px 13px",position:"relative",justifyContent:"space-between",alignItems:"center",backgroundColor:"#eee",borderTop:"1px solid rgba(0, 0, 0, 0.12)"},emojiBox:{position:"absolute",bottom:63,width:40,borderTop:"1px solid #e8e8e8"},circleLoading:{color:Ie.a[500],opacity:"70%",position:"absolute",top:"20%",left:"50%",marginLeft:-12},audioLoading:{color:Ie.a[500],opacity:"70%"},recorderWrapper:{display:"flex",alignItems:"center",alignContent:"middle"},cancelAudioIcon:{color:"red"},sendAudioIcon:{color:"green"},replyginMsgWrapper:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center",paddingTop:8,paddingLeft:73,paddingRight:7},replyginMsgContainer:{flex:1,marginRight:5,overflowY:"hidden",backgroundColor:"rgba(0, 0, 0, 0.05)",borderRadius:"7.5px",display:"flex",position:"relative"},replyginMsgBody:{padding:10,height:"auto",display:"block",whiteSpace:"pre-wrap",overflow:"hidden"},replyginContactMsgSideColor:{flex:"none",width:"4px",backgroundColor:"#35cd96"},replyginSelfMsgSideColor:{flex:"none",width:"4px",backgroundColor:"#6bcbef"},messageContactName:{display:"flex",color:"#6bcbef",fontWeight:500},messageQuickAnswersWrapper:{margin:0,position:"absolute",bottom:"50px",background:"#ffffff",padding:"2px",border:"1px solid #CCC",left:0,width:"100%","& li":{listStyle:"none","& a":{display:"block",padding:"8px",textOverflow:"ellipsis",overflow:"hidden",maxHeight:"32px","&:hover":{background:"#F1F1F1",cursor:"pointer"}}}}}));var $o=e=>{var t;let{ticketStatus:a}=e;const r=Zo(),{ticketId:l}=Object(i.h)(),[s,c]=Object(n.useState)([]),[d,m]=Object(n.useState)(""),[u,p]=Object(n.useState)(!1),[g,E]=Object(n.useState)(!1),[b,f]=Object(n.useState)(!1),[v,k]=Object(n.useState)([]),[w,T]=Object(n.useState)(!1),x=Object(n.useRef)(),[S,A]=Object(n.useState)(null),{setReplyingMessage:M,replyingMessage:I}=Object(n.useContext)(Yo),{user:j}=Object(n.useContext)(O),[D,P]=function(e,t){const[a,o]=Object(n.useState)(()=>{try{const a=localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){return C(a),t}});return[a,t=>{try{const n=t instanceof Function?t(a):t;o(n),localStorage.setItem(e,JSON.stringify(n))}catch(n){C(n)}}]}("signOption",!0);Object(n.useEffect)(()=>{x.current.focus()},[I]),Object(n.useEffect)(()=>(x.current.focus(),()=>{m(""),p(!1),c([]),M(null)}),[l,M]);const W=e=>{m(e.target.value),U(e.target.value)},_=e=>{let t=e.native;m(e=>e+t)},B=e=>{if(!e.target.files)return;const t=Array.from(e.target.files);c(t)},F=async()=>{if(""===d.trim())return;E(!0);const e={read:1,fromMe:!0,mediaUrl:"",body:D?"*".concat(null===j||void 0===j?void 0:j.name,":*\n").concat(d.trim()):d.trim(),quotedMsg:I};try{await y.post("/messages/".concat(l),e)}catch(t){C(t)}m(""),p(!1),E(!1),M(null)},z=async()=>{E(!0);try{await navigator.mediaDevices.getUserMedia({audio:!0}),await Xo.start(),f(!0),E(!1)}catch(e){C(e),E(!1)}},U=async e=>{if(e&&0===e.indexOf("/"))try{const{data:e}=await y.get("/quickAnswers/",{params:{searchParam:d.substring(1)}});k(e.quickAnswers),e.quickAnswers.length>0?T(!0):T(!1)}catch(t){T(!1)}else T(!1)},H=async()=>{E(!0);try{const[,e]=await Xo.stop().getMp3();if(e.size<1e4)return E(!1),void f(!1);const t=new FormData,a="audio-record-site-".concat((new Date).getTime(),".mp3");t.append("medias",e,a),t.append("body",a),t.append("fromMe",!0),await y.post("/messages/".concat(l),t)}catch(e){C(e)}f(!1),E(!1)},Q=async()=>{try{await Xo.stop().getMp3(),f(!1)}catch(e){C(e)}},G=e=>{A(e.currentTarget)},V=e=>{A(null)};return s.length>0?o.a.createElement(Ct.a,{elevation:0,square:!0,className:r.viewMediaInputWrapper},o.a.createElement(R.a,{"aria-label":"cancel-upload",component:"span",onClick:e=>c([])},o.a.createElement(Wo.a,{className:r.sendMessageIcons})),g?o.a.createElement("div",null,o.a.createElement(Pe.a,{className:r.circleLoading})):o.a.createElement("span",null,null===(t=s[0])||void 0===t?void 0:t.name),o.a.createElement(R.a,{"aria-label":"send-upload",component:"span",onClick:async e=>{E(!0),e.preventDefault();const t=new FormData;t.append("fromMe",!0),s.forEach(e=>{t.append("medias",e),t.append("body",e.name)});try{await y.post("/messages/".concat(l),t)}catch(a){C(a)}E(!1),c([])},disabled:g},o.a.createElement(Do.a,{className:r.sendMessageIcons}))):o.a.createElement(Ct.a,{square:!0,elevation:0,className:r.mainWrapper},I&&(e=>{var t;return o.a.createElement("div",{className:r.replyginMsgWrapper},o.a.createElement("div",{className:r.replyginMsgContainer},o.a.createElement("span",{className:Object(N.a)(r.replyginContactMsgSideColor,{[r.replyginSelfMsgSideColor]:!e.fromMe})}),o.a.createElement("div",{className:r.replyginMsgBody},!e.fromMe&&o.a.createElement("span",{className:r.messageContactName},null===(t=e.contact)||void 0===t?void 0:t.name),e.body)),o.a.createElement(R.a,{"aria-label":"showRecorder",component:"span",disabled:g||"open"!==a,onClick:()=>M(null)},o.a.createElement(qo.a,{className:r.sendMessageIcons})))})(I),o.a.createElement("div",{className:r.newMessageBox},o.a.createElement(Qo.a,{only:["sm","xs"]},o.a.createElement(R.a,{"aria-label":"emojiPicker",component:"span",disabled:g||b||"open"!==a,onClick:e=>p(e=>!e)},o.a.createElement(Ro.a,{className:r.sendMessageIcons})),u?o.a.createElement("div",{className:r.emojiBox},o.a.createElement(Go.a,{onClickAway:e=>p(!1)},o.a.createElement(wo.a,{perLine:16,showPreview:!1,showSkinTones:!1,onSelect:_}))):null,o.a.createElement("input",{multiple:!0,type:"file",id:"upload-button",disabled:g||b||"open"!==a,className:r.uploadInput,onChange:B}),o.a.createElement("label",{htmlFor:"upload-button"},o.a.createElement(R.a,{"aria-label":"upload",component:"span",disabled:g||b||"open"!==a},o.a.createElement(Ao.a,{className:r.sendMessageIcons}))),o.a.createElement(Qt.a,{style:{marginRight:7,color:"gray"},label:h.a.t("messagesInput.signMessage"),labelPlacement:"start",control:o.a.createElement(Gt.a,{size:"small",checked:D,onChange:e=>{P(e.target.checked)},name:"showAllTickets",color:"primary"})})),o.a.createElement(Qo.a,{only:["md","lg","xl"]},o.a.createElement(R.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:G},o.a.createElement(Mo.a,null)),o.a.createElement(q.a,{id:"simple-menu",keepMounted:!0,anchorEl:S,open:Boolean(S),onClose:V},o.a.createElement(L.a,{onClick:V},o.a.createElement(R.a,{"aria-label":"emojiPicker",component:"span",disabled:g||b||"open"!==a,onClick:e=>p(e=>!e)},o.a.createElement(Ro.a,{className:r.sendMessageIcons}))),o.a.createElement(L.a,{onClick:V},o.a.createElement("input",{multiple:!0,type:"file",id:"upload-button",disabled:g||b||"open"!==a,className:r.uploadInput,onChange:B}),o.a.createElement("label",{htmlFor:"upload-button"},o.a.createElement(R.a,{"aria-label":"upload",component:"span",disabled:g||b||"open"!==a},o.a.createElement(Ao.a,{className:r.sendMessageIcons})))),o.a.createElement(L.a,{onClick:V},o.a.createElement(Qt.a,{style:{marginRight:7,color:"gray"},label:h.a.t("messagesInput.signMessage"),labelPlacement:"start",control:o.a.createElement(Gt.a,{size:"small",checked:D,onChange:e=>{P(e.target.checked)},name:"showAllTickets",color:"primary"})})))),o.a.createElement("div",{className:r.messageInputWrapper},o.a.createElement(Zn.a,{inputRef:e=>{e&&e.focus(),e&&(x.current=e)},className:r.messageInput,placeholder:"open"===a?h.a.t("messagesInput.placeholderOpen"):h.a.t("messagesInput.placeholderClosed"),multiline:!0,maxRows:5,value:d,onChange:W,disabled:b||g||"open"!==a,onPaste:e=>{"open"===a&&(e=>{e.clipboardData.files[0]&&c([e.clipboardData.files[0]])})(e)},onKeyPress:e=>{g||e.shiftKey||"Enter"===e.key&&F()}}),w?o.a.createElement("ul",{className:r.messageQuickAnswersWrapper},v.map((e,t)=>o.a.createElement("li",{className:r.messageQuickAnswersWrapperItem,key:t},o.a.createElement("a",{onClick:()=>(e=>{m(e),T(!1)})(e.message)},"".concat(e.shortcut," - ").concat(e.message))))):o.a.createElement("div",null)),d?o.a.createElement(R.a,{"aria-label":"sendMessage",component:"span",onClick:F,disabled:g},o.a.createElement(Do.a,{className:r.sendMessageIcons})):b?o.a.createElement("div",{className:r.recorderWrapper},o.a.createElement(R.a,{"aria-label":"cancelRecording",component:"span",fontSize:"large",disabled:g,onClick:Q},o.a.createElement(Ho.a,{className:r.cancelAudioIcon})),g?o.a.createElement("div",null,o.a.createElement(Pe.a,{className:r.audioLoading})):o.a.createElement(Ko,null),o.a.createElement(R.a,{"aria-label":"sendRecordedAudio",component:"span",onClick:H,disabled:g},o.a.createElement(zo.a,{className:r.sendAudioIcon}))):o.a.createElement(R.a,{"aria-label":"showRecorder",component:"span",disabled:g||"open"!==a,onClick:z},o.a.createElement(Bo.a,{className:r.sendMessageIcons}))))},er=a(988),tr=a(989);const ar=Object(M.a)(e=>({ticketHeader:{display:"flex",backgroundColor:"#eee",flex:"none",borderBottom:"1px solid rgba(0, 0, 0, 0.12)"}}));var nr=()=>{const e=ar();return o.a.createElement(er.a,{square:!0,className:e.ticketHeader},o.a.createElement(tr.a,{titleTypographyProps:{noWrap:!0},subheaderTypographyProps:{noWrap:!0},avatar:o.a.createElement(zt.a,{animation:"wave",variant:"circle"},o.a.createElement(je.a,{alt:"contact_image"})),title:o.a.createElement(zt.a,{animation:"wave",width:80}),subheader:o.a.createElement(zt.a,{animation:"wave",width:140})}))},or=a(543),rr=a.n(or);const lr=Object(M.a)(e=>({ticketHeader:{display:"flex",backgroundColor:"#eee",flex:"none",borderBottom:"1px solid rgba(0, 0, 0, 0.12)",[e.breakpoints.down("sm")]:{flexWrap:"wrap"}}}));var sr=e=>{let{loading:t,children:a}=e;const n=lr(),r=Object(i.g)();return o.a.createElement(o.a.Fragment,null,t?o.a.createElement(nr,null):o.a.createElement(er.a,{square:!0,className:n.ticketHeader},o.a.createElement(De.a,{color:"primary",onClick:()=>{r.push("/tickets")}},o.a.createElement(rr.a,null)),a))};var cr=e=>{let{contact:t,ticket:a,onClick:n}=e;return o.a.createElement(tr.a,{onClick:n,style:{cursor:"pointer"},titleTypographyProps:{noWrap:!0},subheaderTypographyProps:{noWrap:!0},avatar:o.a.createElement(je.a,{src:t.profilePicUrl,alt:"contact_image"}),title:"".concat(t.name," #").concat(a.id),subheader:a.user&&"".concat(h.a.t("messagesList.header.assignedTo")," ").concat(a.user.name)})},ir=a(990),dr=a(991);var mr=()=>({findAll:async()=>{const{data:e}=await y.get("/queue");return e}});const ur=Object(M.a)(e=>({maxWidth:{width:"100%"}})),pr=Object(lo.a)({trim:!0});var gr=e=>{let{modalOpen:t,onClose:a,ticketid:r,ticketWhatsappId:l}=e;const s=Object(i.g)(),[c,d]=Object(n.useState)([]),[m,u]=Object(n.useState)([]),[p,g]=Object(n.useState)([]),[E,b]=Object(n.useState)(!1),[f,v]=Object(n.useState)(""),[k,w]=Object(n.useState)(null),[T,S]=Object(n.useState)(""),[A,N]=Object(n.useState)(l),M=ur(),{findAll:I}=mr(),{loadingWhatsapps:R,whatsApps:j}=x(),{user:D}=Object(n.useContext)(O);Object(n.useEffect)(()=>{(async()=>{const e=await I();g(e),u(e)})()},[]),Object(n.useEffect)(()=>{if(!t||f.length<3)return void b(!1);b(!0);const e=setTimeout(()=>{(async()=>{try{const{data:e}=await y.get("/users/",{params:{searchParam:f}});d(e.users),b(!1)}catch(e){b(!1),C(e)}})()},500);return()=>clearTimeout(e)},[f,t]);const P=()=>{a(),v(""),w(null)};return o.a.createElement($e.a,{open:t,onClose:P,maxWidth:"lg",scroll:"paper"},o.a.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),r){b(!0);try{let e={};k&&(e.userId=k.id),T&&null!==T&&(e.queueId=T,k||(e.status="pending",e.userId=null)),A&&(e.whatsappId=A),await y.put("/tickets/".concat(r),e),b(!1),s.push("/tickets")}catch(t){b(!1),C(t)}}}},o.a.createElement(et.a,{id:"form-dialog-title"},h.a.t("transferTicketModal.title")),o.a.createElement(tt.a,{dividers:!0},o.a.createElement(mn.a,{style:{width:300,marginBottom:20},getOptionLabel:e=>"".concat(e.name),onChange:(e,t)=>{w(t),null!=t&&Array.isArray(t.queues)?u(t.queues):(u(p),S(""))},options:c,filterOptions:pr,freeSolo:!0,autoHighlight:!0,noOptionsText:h.a.t("transferTicketModal.noOptions"),loading:E,renderInput:e=>o.a.createElement(at.a,Object.assign({},e,{label:h.a.t("transferTicketModal.fieldLabel"),variant:"outlined",required:!0,autoFocus:!0,onChange:e=>v(e.target.value),InputProps:{...e.InputProps,endAdornment:o.a.createElement(o.a.Fragment,null,E?o.a.createElement(Pe.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment)}}))}),o.a.createElement(ot.a,{variant:"outlined",className:M.maxWidth},o.a.createElement(rt.a,null,h.a.t("transferTicketModal.fieldQueueLabel")),o.a.createElement(lt.a,{value:T,onChange:e=>S(e.target.value),label:h.a.t("transferTicketModal.fieldQueuePlaceholder")},o.a.createElement(L.a,{value:""},"\xa0"),m.map(e=>o.a.createElement(L.a,{key:e.id,value:e.id},e.name)))),o.a.createElement(Ce,{role:D.profile,perform:"ticket-options:transferWhatsapp",yes:()=>!R&&o.a.createElement(ot.a,{variant:"outlined",className:M.maxWidth,style:{marginTop:20}},o.a.createElement(rt.a,null,h.a.t("transferTicketModal.fieldConnectionLabel")),o.a.createElement(lt.a,{value:A,onChange:e=>N(e.target.value),label:h.a.t("transferTicketModal.fieldConnectionPlaceholder")},j.map(e=>o.a.createElement(L.a,{key:e.id,value:e.id},e.name))))})),o.a.createElement(st.a,null,o.a.createElement(De.a,{onClick:P,color:"secondary",disabled:E,variant:"outlined"},h.a.t("transferTicketModal.buttons.cancel")),o.a.createElement(_e,{variant:"contained",type:"submit",color:"primary",loading:E},h.a.t("transferTicketModal.buttons.ok")))))};var Er=e=>{let{ticket:t,menuOpen:a,handleClose:r,anchorEl:l}=e;const[s,c]=Object(n.useState)(!1),[i,d]=Object(n.useState)(!1),m=Object(n.useRef)(!0),{user:u}=Object(n.useContext)(O);Object(n.useEffect)(()=>()=>{m.current=!1},[]);const p=e=>{c(!0),r()};return o.a.createElement(o.a.Fragment,null,o.a.createElement(q.a,{id:"menu-appbar",anchorEl:l,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:a,onClose:r},o.a.createElement(L.a,{onClick:e=>{d(!0),r()}},h.a.t("ticketOptionsMenu.transfer")),o.a.createElement(Ce,{role:u.profile,perform:"ticket-options:deleteTicket",yes:()=>o.a.createElement(L.a,{onClick:p},h.a.t("ticketOptionsMenu.delete"))})),o.a.createElement($t,{title:"".concat(h.a.t("ticketOptionsMenu.confirmationModal.title")).concat(t.id," ").concat(h.a.t("ticketOptionsMenu.confirmationModal.titleFrom")," ").concat(t.contact.name,"?"),open:s,onClose:c,onConfirm:async()=>{try{await y.delete("/tickets/".concat(t.id))}catch(e){C(e)}}},h.a.t("ticketOptionsMenu.confirmationModal.message")),o.a.createElement(gr,{modalOpen:i,onClose:()=>{m.current&&d(!1)},ticketid:t.id,ticketWhatsappId:t.whatsappId}))};const hr=Object(M.a)(e=>({actionButtons:{marginRight:6,flex:"none",alignSelf:"center",marginLeft:"auto","& > *":{margin:e.spacing(1)}}}));var br=e=>{let{ticket:t}=e;const a=hr(),r=Object(i.g)(),[l,s]=Object(n.useState)(null),[c,d]=Object(n.useState)(!1),m=Boolean(l),{user:u}=Object(n.useContext)(O),p=async(e,a,n)=>{d(!0);try{await y.put("/tickets/".concat(t.id),{status:a,userId:n||null}),d(!1),"open"===a?r.push("/tickets/".concat(t.id)):r.push("/tickets")}catch(o){d(!1),C(o)}};return o.a.createElement("div",{className:a.actionButtons},"closed"===t.status&&o.a.createElement(_e,{loading:c,startIcon:o.a.createElement(ir.a,null),size:"small",onClick:e=>p(0,"open",null===u||void 0===u?void 0:u.id)},h.a.t("messagesList.header.buttons.reopen")),"open"===t.status&&o.a.createElement(o.a.Fragment,null,o.a.createElement(_e,{loading:c,startIcon:o.a.createElement(ir.a,null),size:"small",onClick:e=>p(0,"pending",null)},h.a.t("messagesList.header.buttons.return")),o.a.createElement(_e,{loading:c,size:"small",variant:"contained",color:"primary",onClick:e=>p(0,"closed",null===u||void 0===u?void 0:u.id)},h.a.t("messagesList.header.buttons.resolve")),o.a.createElement(R.a,{onClick:e=>{s(e.currentTarget)}},o.a.createElement(dr.a,null)),o.a.createElement(Er,{ticket:t,anchorEl:l,menuOpen:m,handleClose:e=>{s(null)}})),"pending"===t.status&&o.a.createElement(_e,{loading:c,size:"small",variant:"contained",color:"primary",onClick:e=>p(0,"open",null===u||void 0===u?void 0:u.id)},h.a.t("messagesList.header.buttons.accept")))},fr=a(992),vr=a(993),yr=a(994),Cr=a(995),kr=a(996),Or=a(997);var wr=e=>{let{contact:t,numbers:a}=e;const r=Object(i.g)(),{user:l}=Object(n.useContext)(O),[s,c]=Object(n.useState)({name:"",number:0,profilePicUrl:""});Object(n.useEffect)(()=>{const e=setTimeout(()=>{(async()=>{try{let e={name:t,number:a.replace(/\D/g,""),email:""};const{data:n}=await y.post("/contact",e);c(n)}catch(e){console.log(e),C(e)}})()},500);return()=>clearTimeout(e)},[t,a]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{minWidth:"250px"}},o.a.createElement(Vt.a,{container:!0,spacing:1},o.a.createElement(Vt.a,{item:!0,xs:2},o.a.createElement(je.a,{src:s.profilePicUrl})),o.a.createElement(Vt.a,{item:!0,xs:9},o.a.createElement(_.a,{style:{marginTop:"12px",marginLeft:"10px"},variant:"subtitle1",color:"primary",gutterBottom:!0},s.name)),o.a.createElement(Vt.a,{item:!0,xs:12},o.a.createElement(j.a,null),o.a.createElement(De.a,{fullWidth:!0,color:"primary",onClick:async()=>{try{const{data:e}=await y.post("/tickets",{contactId:s.id,userId:l.id,status:"open"});r.push("/tickets/".concat(e.id))}catch(e){C(e)}},disabled:!s.number},"Conversar")))))};var Tr=e=>{let{image:t,link:a,description:r}=e;Object(n.useEffect)(()=>{},[t,a,r]);const l=async()=>{try{window.open(a)}catch(e){C(e)}};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{minWidth:"250px"}},o.a.createElement("div",null,o.a.createElement("div",{style:{float:"left"}},o.a.createElement("img",{src:t,alt:"loc",onClick:l,style:{width:"100px"}})),r&&o.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},o.a.createElement(_.a,{style:{marginTop:"12px",marginLeft:"15px",marginRight:"15px",float:"left"},variant:"subtitle1",color:"primary",gutterBottom:!0},o.a.createElement("div",{dangerouslySetInnerHTML:{__html:r.replace("\\n","<br />")}}))),o.a.createElement("div",{style:{display:"block",content:"",clear:"both"}}),o.a.createElement("div",null,o.a.createElement(j.a,null),o.a.createElement(De.a,{fullWidth:!0,color:"primary",onClick:l,disabled:!a},"Visualizar")))))},xr=a(549);const Sr=Object(M.a)(e=>({messageMedia:{objectFit:"cover",width:250,height:200,borderTopLeftRadius:8,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:8}}));var Ar=e=>{let{imageUrl:t}=e;const a=Sr(),[r,l]=Object(n.useState)(!0),[s,c]=Object(n.useState)("");return Object(n.useEffect)(()=>{if(!t)return;(async()=>{const{data:e,headers:a}=await y.get(t,{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([e],{type:a["content-type"]}));c(n),l(!1)})()},[t]),o.a.createElement(xr.a,{className:a.messageMedia,smallSrcSet:r?t:s,medium:r?t:s,large:r?t:s,alt:"image"})};var Nr=e=>{let{message:t,menuOpen:a,handleClose:r,anchorEl:l}=e;const{setReplyingMessage:s}=Object(n.useContext)(Yo),[c,i]=Object(n.useState)(!1);return o.a.createElement(o.a.Fragment,null,o.a.createElement($t,{title:h.a.t("messageOptionsMenu.confirmationModal.title"),open:c,onClose:i,onConfirm:async()=>{try{await y.delete("/messages/".concat(t.id))}catch(e){C(e)}}},h.a.t("messageOptionsMenu.confirmationModal.message")),o.a.createElement(q.a,{anchorEl:l,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:a,onClose:r},t.fromMe&&o.a.createElement(L.a,{onClick:e=>{i(!0),r()}},h.a.t("messageOptionsMenu.delete")),o.a.createElement(L.a,{onClick:()=>{s(t),r()}},h.a.t("messageOptionsMenu.reply"))))},Mr=a(544),Ir=a.n(Mr);const Rr=Object(M.a)(e=>({messagesListWrapper:{overflow:"hidden",position:"relative",display:"flex",flexDirection:"column",flexGrow:1},messageCenter:{marginTop:5,alignItems:"center",verticalAlign:"center",alignContent:"center",backgroundColor:"#E1F5FEEB",fontSize:"12px",minWidth:100,maxWidth:270,color:"#272727",borderTopLeftRadius:0,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:8,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:0,boxShadow:"0 1px 1px #b3b3b3"},messagesList:{backgroundImage:"url(".concat(Ir.a,")"),display:"flex",flexDirection:"column",flexGrow:1,padding:"20px 20px 20px 20px",overflowY:"scroll",[e.breakpoints.down("sm")]:{paddingBottom:"90px"},...e.scrollbarStyles},circleLoading:{color:Ie.a[500],position:"absolute",opacity:"70%",top:0,left:"50%",marginTop:12},messageLeft:{marginRight:20,marginTop:2,minWidth:100,maxWidth:600,height:"auto",display:"block",position:"relative","&:hover #messageActionsButton":{display:"flex",position:"absolute",top:0,right:0},whiteSpace:"pre-wrap",backgroundColor:"#ffffff",color:"#303030",alignSelf:"flex-start",borderTopLeftRadius:0,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:8,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:0,boxShadow:"0 1px 1px #b3b3b3"},quotedContainerLeft:{margin:"-3px -80px 6px -6px",overflow:"hidden",backgroundColor:"#f0f0f0",borderRadius:"7.5px",display:"flex",position:"relative"},quotedMsg:{padding:10,maxWidth:300,height:"auto",display:"block",whiteSpace:"pre-wrap",overflow:"hidden"},quotedSideColorLeft:{flex:"none",width:"4px",backgroundColor:"#6bcbef"},messageRight:{marginLeft:20,marginTop:2,minWidth:100,maxWidth:600,height:"auto",display:"block",position:"relative","&:hover #messageActionsButton":{display:"flex",position:"absolute",top:0,right:0},whiteSpace:"pre-wrap",backgroundColor:"#dcf8c6",color:"#303030",alignSelf:"flex-end",borderTopLeftRadius:8,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:0,paddingLeft:5,paddingRight:5,paddingTop:5,paddingBottom:0,boxShadow:"0 1px 1px #b3b3b3"},quotedContainerRight:{margin:"-3px -80px 6px -6px",overflowY:"hidden",backgroundColor:"#cfe9ba",borderRadius:"7.5px",display:"flex",position:"relative"},quotedMsgRight:{padding:10,maxWidth:300,height:"auto",whiteSpace:"pre-wrap"},quotedSideColorRight:{flex:"none",width:"4px",backgroundColor:"#35cd96"},messageActionsButton:{display:"none",position:"relative",color:"#999",zIndex:1,backgroundColor:"inherit",opacity:"90%","&:hover, &.Mui-focusVisible":{backgroundColor:"inherit"}},messageContactName:{display:"flex",color:"#6bcbef",fontWeight:500},textContentItem:{overflowWrap:"break-word",padding:"3px 80px 6px 6px"},textContentItemDeleted:{fontStyle:"italic",color:"rgba(0, 0, 0, 0.36)",overflowWrap:"break-word",padding:"3px 80px 6px 6px"},messageMedia:{objectFit:"cover",width:250,height:200,borderTopLeftRadius:8,borderTopRightRadius:8,borderBottomLeftRadius:8,borderBottomRightRadius:8},timestamp:{fontSize:11,position:"absolute",bottom:0,right:5,color:"#999"},dailyTimestamp:{alignItems:"center",textAlign:"center",alignSelf:"center",width:"110px",backgroundColor:"#e1f3fb",margin:"10px",borderRadius:"10px",boxShadow:"0 1px 1px #b3b3b3"},dailyTimestampText:{color:"#808888",padding:8,alignSelf:"center",marginLeft:"0px"},ackIcons:{fontSize:18,verticalAlign:"middle",marginLeft:4},deletedIcon:{fontSize:18,verticalAlign:"middle",marginRight:4},ackDoneAllIcon:{color:Ie.a[500],fontSize:18,verticalAlign:"middle",marginLeft:4},downloadMedia:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"inherit",padding:10}})),jr=(e,t)=>{if("LOAD_MESSAGES"===t.type){const a=t.payload,n=[];return a.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:n.push(t)}),[...n,...e]}if("ADD_MESSAGE"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?e[n]=a:e.push(a),[...e]}if("UPDATE_MESSAGE"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n&&(e[n]=a),[...e]}if("RESET"===t.type)return[]};var Dr=e=>{let{ticketId:t,isGroup:a}=e;const r=Rr(),[l,s]=Object(n.useReducer)(jr,[]),[c,i]=Object(n.useState)(1),[d,m]=Object(n.useState)(!1),[u,p]=Object(n.useState)(!1),g=Object(n.useRef)(),[h,b]=Object(n.useState)({}),[f,v]=Object(n.useState)(null),k=Boolean(f),O=Object(n.useRef)(t);Object(n.useEffect)(()=>{s({type:"RESET"}),i(1),O.current=t},[t]),Object(n.useEffect)(()=>{p(!0);const e=setTimeout(()=>{(async()=>{try{const{data:e}=await y.get("/messages/"+t,{params:{pageNumber:c}});O.current===t&&(s({type:"LOAD_MESSAGES",payload:e.messages}),m(e.hasMore),p(!1)),1===c&&e.messages.length>1&&w()}catch(e){p(!1),C(e)}})()},500);return()=>{clearTimeout(e)}},[c,t]),Object(n.useEffect)(()=>{const e=E();return e.on("ready",()=>e.emit("joinChatBox",t)),e.on("appMessage",e=>{"create"===e.action&&(s({type:"ADD_MESSAGE",payload:e.message}),w()),"update"===e.action&&s({type:"UPDATE_MESSAGE",payload:e.message})}),()=>{e.disconnect()}},[t]);const w=()=>{g.current&&g.current.scrollIntoView({})},T=(e,t)=>{v(e.currentTarget),b(t)},x=e=>{if(!("locationMessage"===e.mediaType&&e.body.split("|").length>=2)){if("contactMessage"===e.mediaType){let t=e.body.split("\n"),a=[],n="";for(let e=0;e<t.length;e++){let o=t[e].split(":");for(let e=0;e<o.length;e++)-1!==o[e].indexOf("+")&&a.push({number:o[e]}),-1!==o[e].indexOf("FN")&&(n=o[e+1])}return o.a.createElement(wr,{contact:n,numbers:a[0].number})}return"image"===e.mediaType?o.a.createElement(Ar,{imageUrl:e.mediaUrl}):"audio"===e.mediaType?o.a.createElement("audio",{controls:!0},o.a.createElement("source",{src:e.mediaUrl,type:"audio/ogg"})):"video"===e.mediaType?o.a.createElement("video",{className:r.messageMedia,src:e.mediaUrl,controls:!0}):o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:r.downloadMedia},o.a.createElement(De.a,{startIcon:o.a.createElement(fr.a,null),color:"primary",variant:"outlined",target:"_blank",href:e.mediaUrl},"Download")),o.a.createElement(j.a,null))}try{let a=e.body.split("|"),n=a[0],r=a[1],l=null;var t;if(a.length>2)l=null===e||void 0===e||null===(t=e.body)||void 0===t?void 0:t.split("|")[2];return o.a.createElement(Tr,{image:n,link:r,description:l})}catch(a){console.log("checkMessageMedia ~ err",a)}},S=(e,t)=>{if(0===t)return o.a.createElement("span",{className:r.dailyTimestamp,key:"timestamp-".concat(e.id)},o.a.createElement("div",{className:r.dailyTimestampText},Object(we.a)(Object(Me.a)(l[t].createdAt),"dd/MM/yyyy")));if(t<l.length-1){let a=Object(Me.a)(l[t].createdAt),n=Object(Me.a)(l[t-1].createdAt);if(!Object(Ne.a)(a,n))return o.a.createElement("span",{className:r.dailyTimestamp,key:"timestamp-".concat(e.id)},o.a.createElement("div",{className:r.dailyTimestampText},Object(we.a)(Object(Me.a)(l[t].createdAt),"dd/MM/yyyy")))}return t===l.length-1?o.a.createElement("div",{key:"ref-".concat(e.createdAt),ref:g,style:{float:"left",clear:"both"}}):void 0},A=(e,t)=>{if(t<l.length&&t>0){if(l[t].fromMe!==l[t-1].fromMe)return o.a.createElement("span",{style:{marginTop:16},key:"divider-".concat(e.id)})}},M=(e,t)=>{if(t<l.length&&t>0){let a=e.ticketId;if(a!==l[t-1].ticketId)return o.a.createElement("div",{key:"ticket-".concat(e.id),className:r.ticketNunber},"#ticket: ",a,o.a.createElement("hr",null))}},I=e=>{var t,a,n,l,s;return o.a.createElement("div",{className:Object(N.a)(r.quotedContainerLeft,{[r.quotedContainerRight]:e.fromMe})},o.a.createElement("span",{className:Object(N.a)(r.quotedSideColorLeft,{[r.quotedSideColorRight]:null===(t=e.quotedMsg)||void 0===t?void 0:t.fromMe})}),o.a.createElement("div",{className:r.quotedMsg},!(null===(a=e.quotedMsg)||void 0===a?void 0:a.fromMe)&&o.a.createElement("span",{className:r.messageContactName},null===(n=e.quotedMsg)||void 0===n||null===(l=n.contact)||void 0===l?void 0:l.name),null===(s=e.quotedMsg)||void 0===s?void 0:s.body))};return o.a.createElement("div",{className:r.messagesListWrapper},o.a.createElement(Nr,{message:h,anchorEl:f,menuOpen:k,handleClose:e=>{v(null)}}),o.a.createElement("div",{id:"messagesList",className:r.messagesList,onScroll:e=>{if(!d)return;const{scrollTop:t}=e.currentTarget;0===t&&(document.getElementById("messagesList").scrollTop=1),u||t<50&&i(e=>e+1)}},l.length>0?(()=>{if(l.length>0){return l.map((e,t)=>{var n,l;return"call_log"===e.mediaType?o.a.createElement(o.a.Fragment,{key:e.id},S(e,t),A(e,t),M(e,t),o.a.createElement("div",{className:r.messageCenter},o.a.createElement(R.a,{variant:"contained",size:"small",id:"messageActionsButton",disabled:e.isDeleted,className:r.messageActionsButton,onClick:t=>T(t,e)},o.a.createElement(kr.a,null)),a&&o.a.createElement("span",{className:r.messageContactName},null===(n=e.contact)||void 0===n?void 0:n.name),o.a.createElement("div",null,o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 17",width:"20",height:"17"},o.a.createElement("path",{fill:"#df3333",d:"M18.2 12.1c-1.5-1.8-5-2.7-8.2-2.7s-6.7 1-8.2 2.7c-.7.8-.3 2.3.2 2.8.2.2.3.3.5.3 1.4 0 3.6-.7 3.6-.7.5-.2.8-.5.8-1v-1.3c.7-1.2 5.4-1.2 6.4-.1l.1.1v1.3c0 .2.1.4.2.6.1.2.3.3.5.4 0 0 2.2.7 3.6.7.2 0 1.4-2 .5-3.1zM5.4 3.2l4.7 4.6 5.8-5.7-.9-.8L10.1 6 6.4 2.3h2.5V1H4.1v4.8h1.3V3.2z"}))," ",o.a.createElement("span",null,"Chamada de voz/v\xeddeo perdida \xe0s ",Object(we.a)(Object(Me.a)(e.createdAt),"HH:mm"))))):e.fromMe?o.a.createElement(o.a.Fragment,{key:e.id},S(e,t),A(e,t),M(e,t),o.a.createElement("div",{className:r.messageRight},o.a.createElement(R.a,{variant:"contained",size:"small",id:"messageActionsButton",disabled:e.isDeleted,className:r.messageActionsButton,onClick:t=>T(t,e)},o.a.createElement(kr.a,null)),(e.mediaUrl||"contactMessage"===e.mediaType||"locationMessage"===e.mediaType)&&x(e),o.a.createElement("div",{className:Object(N.a)(r.textContentItem,{[r.textContentItemDeleted]:e.isDeleted})},e.isDeleted&&o.a.createElement(Or.a,{color:"disabled",fontSize:"small",className:r.deletedIcon}),e.quotedMsg&&I(e),o.a.createElement(ze,null,e.body),o.a.createElement("span",{className:r.timestamp},Object(we.a)(Object(Me.a)(e.createdAt),"HH:mm"),(e=>0===e.ack?o.a.createElement(vr.a,{fontSize:"small",className:r.ackIcons}):1===e.ack||2===e.ack?o.a.createElement(yr.a,{fontSize:"small",className:r.ackIcons}):3===e.ack?o.a.createElement(Cr.a,{fontSize:"small",className:r.ackIcons}):4===e.ack||5===e.ack?o.a.createElement(Cr.a,{fontSize:"small",className:r.ackDoneAllIcon}):void 0)(e))))):o.a.createElement(o.a.Fragment,{key:e.id},S(e,t),A(e,t),M(e,t),o.a.createElement("div",{className:r.messageLeft},o.a.createElement(R.a,{variant:"contained",size:"small",id:"messageActionsButton",disabled:e.isDeleted,className:r.messageActionsButton,onClick:t=>T(t,e)},o.a.createElement(kr.a,null)),a&&o.a.createElement("span",{className:r.messageContactName},null===(l=e.contact)||void 0===l?void 0:l.name),(e.mediaUrl||"contactMessage"===e.mediaType||"locationMessage"===e.mediaType)&&x(e),o.a.createElement("div",{className:r.textContentItem},e.quotedMsg&&I(e),o.a.createElement(ze,null,e.body),o.a.createElement("span",{className:r.timestamp},Object(we.a)(Object(Me.a)(e.createdAt),"HH:mm")))))})}return o.a.createElement("div",null,"Say hello to your new contact!")})():[]),u&&o.a.createElement("div",null,o.a.createElement(Pe.a,{className:r.circleLoading})))};const Pr=Object(M.a)(e=>({root:{display:"flex",height:"100%",position:"relative",overflow:"hidden"},ticketInfo:{maxWidth:"50%",flexBasis:"50%",[e.breakpoints.down("sm")]:{maxWidth:"80%",flexBasis:"80%"}},ticketActionButtons:{maxWidth:"50%",flexBasis:"50%",display:"flex",[e.breakpoints.down("sm")]:{maxWidth:"100%",flexBasis:"100%",marginBottom:"5px"}},mainWrapper:{flex:1,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"0",marginRight:-320,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},mainWrapperShift:{borderTopRightRadius:0,borderBottomRightRadius:0,transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0}}));var Wr=()=>{const{ticketId:e}=Object(i.h)(),t=Object(i.g)(),a=Pr(),[r,l]=Object(n.useState)(!1),[s,c]=Object(n.useState)(!0),[m,u]=Object(n.useState)({}),[p,g]=Object(n.useState)({});Object(n.useEffect)(()=>{c(!0);const t=setTimeout(()=>{(async()=>{try{const{data:t}=await y.get("/tickets/"+e);u(t.contact),g(t),c(!1)}catch(t){c(!1),C(t)}})()},500);return()=>clearTimeout(t)},[e,t]),Object(n.useEffect)(()=>{const a=E();return a.on("ready",()=>a.emit("joinChatBox",e)),a.on("ticket",e=>{"update"===e.action&&g(e.ticket),"delete"===e.action&&(d.b.success("Ticket deleted sucessfully."),t.push("/tickets"))}),a.on("contact",e=>{"update"===e.action&&u(t=>{var a;return t.id===(null===(a=e.contact)||void 0===a?void 0:a.id)?{...t,...e.contact}:t})}),()=>{a.disconnect()}},[e,t]);return o.a.createElement("div",{className:a.root,id:"drawer-container"},o.a.createElement(Ct.a,{variant:"outlined",elevation:0,className:Object(N.a)(a.mainWrapper,{[a.mainWrapperShift]:r})},o.a.createElement(sr,{loading:s},o.a.createElement("div",{className:a.ticketInfo},o.a.createElement(cr,{contact:m,ticket:p,onClick:()=>{l(!0)}})),o.a.createElement("div",{className:a.ticketActionButtons},o.a.createElement(br,{ticket:p}))),o.a.createElement(Ct.a,null,o.a.createElement(fo,{ticket:p})),o.a.createElement(Jo,null,o.a.createElement(Dr,{ticketId:e,isGroup:p.isGroup}),o.a.createElement($o,{ticketStatus:p.status}))),o.a.createElement(Oo,{open:r,handleDrawerClose:()=>{l(!1)},contact:m,loading:s}))};const _r=Object(M.a)(e=>({chatContainer:{flex:1,padding:16,height:"calc(100% - 48px)",overflowY:"hidden"},chatPapper:{display:"flex",height:"100%"},contactsWrapper:{display:"flex",height:"100%",flexDirection:"column",overflowY:"hidden"},contactsWrapperSmall:{display:"flex",height:"100%",flexDirection:"column",overflowY:"hidden",[e.breakpoints.down("sm")]:{display:"none"}},messagessWrapper:{display:"flex",height:"100%",flexDirection:"column"},welcomeMsg:{backgroundColor:"#eee",display:"flex",justifyContent:"space-evenly",alignItems:"center",height:"100%",textAlign:"center",borderRadius:0},ticketsManager:{},ticketsManagerClosed:{[e.breakpoints.down("sm")]:{display:"none"}}}));var qr=()=>{const e=_r(),{ticketId:t}=Object(i.h)();return o.a.createElement("div",{className:e.chatContainer},o.a.createElement("div",{className:e.chatPapper},o.a.createElement(Vt.a,{container:!0,spacing:0},o.a.createElement(Vt.a,{item:!0,xs:12,md:4,className:t?e.contactsWrapperSmall:e.contactsWrapper},o.a.createElement(bo,null)),o.a.createElement(Vt.a,{item:!0,xs:12,md:8,className:e.messagessWrapper},t?o.a.createElement(o.a.Fragment,null,o.a.createElement(Wr,null)):o.a.createElement(Qo.a,{only:["sm","xs"]},o.a.createElement(Ct.a,{className:e.welcomeMsg},o.a.createElement("span",null,h.a.t("chat.noTicketMessage"))))))))};const Lr=(e,t)=>{if("LOAD_USERS"===t.type){const a=t.payload,n=[];return a.forEach(t=>{const a=e.findIndex(e=>e.id===t.id);-1!==a?e[a]=t:n.push(t)}),[...e,...n]}if("UPDATE_USERS"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a.id);return-1!==n?(e[n]=a,[...e]):[a,...e]}if("DELETE_USER"===t.type){const a=t.payload,n=e.findIndex(e=>e.id===a);return-1!==n&&e.splice(n,1),[...e]}if("RESET"===t.type)return[]},Br=Object(M.a)(e=>({mainPaper:{flex:1,padding:e.spacing(1),overflowY:"scroll",...e.scrollbarStyles}}));var Fr=()=>{const e=Br(),[t,a]=Object(n.useState)(!1),[r,l]=Object(n.useState)(1),[s,c]=Object(n.useState)(!1),[i,m]=Object(n.useState)(null),[u,p]=Object(n.useState)(null),[g,b]=Object(n.useState)(!1),[f,v]=Object(n.useState)(!1),[k,O]=Object(n.useState)(""),[w,T]=Object(n.useReducer)(Lr,[]);Object(n.useEffect)(()=>{T({type:"RESET"}),l(1)},[k]),Object(n.useEffect)(()=>{a(!0);const e=setTimeout(()=>{(async()=>{try{const{data:e}=await y.get("/users/",{params:{searchParam:k,pageNumber:r}});T({type:"LOAD_USERS",payload:e.users}),c(e.hasMore),a(!1)}catch(e){C(e)}})()},500);return()=>clearTimeout(e)},[k,r]),Object(n.useEffect)(()=>{const e=E();return e.on("user",e=>{"update"!==e.action&&"create"!==e.action||T({type:"UPDATE_USERS",payload:e.user}),"delete"===e.action&&T({type:"DELETE_USER",payload:+e.userId})}),()=>{e.disconnect()}},[]);return o.a.createElement(Wt,null,o.a.createElement($t,{title:u&&"".concat(h.a.t("users.confirmationModal.deleteTitle")," ").concat(u.name,"?"),open:f,onClose:v,onConfirm:()=>(async e=>{try{await y.delete("/users/".concat(e)),d.b.success(h.a.t("users.toasts.deleted"))}catch(t){C(t)}p(null),O(""),l(1)})(u.id)},h.a.t("users.confirmationModal.deleteMessage")),o.a.createElement(Et,{open:g,onClose:()=>{m(null),b(!1)},"aria-labelledby":"form-dialog-title",userId:i&&i.id}),o.a.createElement(qt,null,o.a.createElement(Ft,null,h.a.t("users.title")),o.a.createElement(Bt,null,o.a.createElement(at.a,{placeholder:h.a.t("contacts.searchPlaceholder"),type:"search",value:k,onChange:e=>{O(e.target.value.toLowerCase())},InputProps:{startAdornment:o.a.createElement(nt.a,{position:"start"},o.a.createElement(sa.a,{style:{color:"gray"}}))}}),o.a.createElement(De.a,{variant:"contained",color:"primary",onClick:()=>{m(null),b(!0)}},h.a.t("users.buttons.add")))),o.a.createElement(Ct.a,{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!s||t)return;const{scrollTop:a,scrollHeight:n,clientHeight:o}=e.currentTarget;n-(a+100)<o&&l(e=>e+1)}},o.a.createElement(kt.a,{size:"small"},o.a.createElement(Ot.a,null,o.a.createElement(wt.a,null,o.a.createElement(Tt.a,{align:"center"},h.a.t("users.table.name")),o.a.createElement(Tt.a,{align:"center"},h.a.t("users.table.email")),o.a.createElement(Tt.a,{align:"center"},h.a.t("users.table.profile")),o.a.createElement(Tt.a,{align:"center"},h.a.t("users.table.whatsapp")),o.a.createElement(Tt.a,{align:"center"},h.a.t("users.table.actions")))),o.a.createElement(xt.a,null,o.a.createElement(o.a.Fragment,null,w.map(e=>{var t;return o.a.createElement(wt.a,{key:e.id},o.a.createElement(Tt.a,{align:"center"},e.name),o.a.createElement(Tt.a,{align:"center"},e.email),o.a.createElement(Tt.a,{align:"center"},e.profile),o.a.createElement(Tt.a,{align:"center"},null===(t=e.whatsapp)||void 0===t?void 0:t.name),o.a.createElement(Tt.a,{align:"center"},o.a.createElement(R.a,{size:"small",onClick:()=>(e=>{m(e),b(!0)})(e)},o.a.createElement(ma.a,null)),o.a.createElement(R.a,{size:"small",onClick:t=>{v(!0),p(e)}},o.a.createElement(ia.a,null))))}),t&&o.a.createElement(Ht,{columns:4}))))))};var zr=e=>{let{component:t,isPrivate:a=!1,...r}=e;const{isAuth:l,loading:s}=Object(n.useContext)(O);return!l&&a?o.a.createElement(o.a.Fragment,null,s&&o.a.createElement(ft,null),o.a.createElement(i.a,{to:{pathname:"/login",state:{from:r.location}}})):l&&!a?o.a.createElement(o.a.Fragment,null,s&&o.a.createElement(ft,null),o.a.createElement(i.a,{to:{pathname:"/",state:{from:r.location}}}),";"):o.a.createElement(o.a.Fragment,null,s&&o.a.createElement(ft,null),o.a.createElement(i.b,Object.assign({},r,{component:t})))};var Ur=()=>o.a.createElement(c.a,null,o.a.createElement(w,null,o.a.createElement(i.d,null,o.a.createElement(zr,{exact:!0,path:"/login",component:Pa}),o.a.createElement(zr,{exact:!0,path:"/signup",component:Hn}),o.a.createElement(A,null,o.a.createElement(yt,null,o.a.createElement(zr,{exact:!0,path:"/",component:Ma,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/tickets/:ticketId?",component:qr,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/connections",component:ra,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/contacts",component:ba,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/users",component:Fr,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/quickAnswers",component:dn,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/Settings",component:qn,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/Queues",component:nn,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/tags",component:Xn,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/schedules",component:yn,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/BulkMessage",component:Rn,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/ShippingReport",component:Fn,isPrivate:!0}),o.a.createElement(zr,{exact:!0,path:"/SettingsMessage",component:Wn,isPrivate:!0})))),o.a.createElement(d.a,{autoClose:3e3}))),Hr=(a(879),a(548)),Qr=a(998),Gr=a(545);var Vr=()=>{const[e,t]=Object(n.useState)(),a=Object(Hr.a)({scrollbarStyles:{"&::-webkit-scrollbar":{width:"8px",height:"8px"},"&::-webkit-scrollbar-thumb":{boxShadow:"inset 0 0 6px rgba(0, 0, 0, 0.3)",backgroundColor:"#606060"}},palette:{primary:{main:"#2576d2"}}},e);return Object(n.useEffect)(()=>{const e=localStorage.getItem("i18nextLng");"ptBR"===e.substring(0,2)+e.substring(3,5)&&t(Gr.ptBR)},[]),o.a.createElement(Qr.a,{theme:a},o.a.createElement(Ur,null))};l.a.render(o.a.createElement(s.a,null,o.a.createElement(Vr,null)),document.getElementById("root"))}},[[580,1,2]]]);
//# sourceMappingURL=main.826703fe.chunk.js.map