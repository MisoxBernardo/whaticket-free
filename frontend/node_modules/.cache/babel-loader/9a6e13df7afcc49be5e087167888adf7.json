{"ast":null,"code":"var _jsxFileName = \"/home/user/whaticket-free/frontend/src/components/TicketActionButtons/index.js\";\nimport React, { useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { IconButton } from \"@material-ui/core\";\nimport { MoreVert, Replay } from \"@material-ui/icons\";\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport TicketOptionsMenu from \"../TicketOptionsMenu\";\nimport ButtonWithSpinner from \"../ButtonWithSpinner\";\nimport toastError from \"../../errors/toastError\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nconst useStyles = makeStyles(theme => ({\n  actionButtons: {\n    marginRight: 6,\n    flex: \"none\",\n    alignSelf: \"center\",\n    marginLeft: \"auto\",\n    \"& > *\": {\n      margin: theme.spacing(1)\n    }\n  }\n}));\nconst TicketActionButtons = ({\n  ticket\n}) => {\n  const classes = useStyles();\n  const history = useHistory();\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const ticketOptionsMenuOpen = Boolean(anchorEl);\n  const {\n    user\n  } = useContext(AuthContext);\n  const handleOpenTicketOptionsMenu = e => {\n    setAnchorEl(e.currentTarget);\n  };\n  const handleCloseTicketOptionsMenu = e => {\n    setAnchorEl(null);\n  };\n  const handleUpdateTicketStatus = async (e, status, userId) => {\n    setLoading(true);\n    try {\n      await api.put(`/tickets/${ticket.id}`, {\n        status: status,\n        userId: userId || null\n      });\n      setLoading(false);\n      if (status === \"open\") {\n        history.push(`/tickets/${ticket.id}`);\n      } else {\n        history.push(\"/tickets\");\n      }\n    } catch (err) {\n      setLoading(false);\n      toastError(err);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.actionButtons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 3\n    }\n  }, ticket.status === \"closed\" && /*#__PURE__*/React.createElement(ButtonWithSpinner, {\n    loading: loading,\n    startIcon: /*#__PURE__*/React.createElement(Replay, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }\n    }),\n    size: \"small\",\n    onClick: e => handleUpdateTicketStatus(e, \"open\", user === null || user === void 0 ? void 0 : user.id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 5\n    }\n  }, i18n.t(\"messagesList.header.buttons.reopen\")), ticket.status === \"open\" && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ButtonWithSpinner, {\n    loading: loading,\n    startIcon: /*#__PURE__*/React.createElement(Replay, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 18\n      }\n    }),\n    size: \"small\",\n    onClick: e => handleUpdateTicketStatus(e, \"pending\", null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 6\n    }\n  }, i18n.t(\"messagesList.header.buttons.return\")), /*#__PURE__*/React.createElement(ButtonWithSpinner, {\n    loading: loading,\n    size: \"small\",\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: e => handleUpdateTicketStatus(e, \"closed\", user === null || user === void 0 ? void 0 : user.id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 6\n    }\n  }, i18n.t(\"messagesList.header.buttons.resolve\")), /*#__PURE__*/React.createElement(IconButton, {\n    onClick: handleOpenTicketOptionsMenu,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(MoreVert, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }\n  })), /*#__PURE__*/React.createElement(TicketOptionsMenu, {\n    ticket: ticket,\n    anchorEl: anchorEl,\n    menuOpen: ticketOptionsMenuOpen,\n    handleClose: handleCloseTicketOptionsMenu,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 6\n    }\n  })), ticket.status === \"pending\" && /*#__PURE__*/React.createElement(ButtonWithSpinner, {\n    loading: loading,\n    size: \"small\",\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: e => handleUpdateTicketStatus(e, \"open\", user === null || user === void 0 ? void 0 : user.id),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 5\n    }\n  }, i18n.t(\"messagesList.header.buttons.accept\")));\n};\nexport default TicketActionButtons;","map":{"version":3,"names":["React","useContext","useState","useHistory","makeStyles","IconButton","MoreVert","Replay","i18n","api","TicketOptionsMenu","ButtonWithSpinner","toastError","AuthContext","useStyles","theme","actionButtons","marginRight","flex","alignSelf","marginLeft","margin","spacing","TicketActionButtons","ticket","classes","history","anchorEl","setAnchorEl","loading","setLoading","ticketOptionsMenuOpen","Boolean","user","handleOpenTicketOptionsMenu","e","currentTarget","handleCloseTicketOptionsMenu","handleUpdateTicketStatus","status","userId","put","id","push","err","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","startIcon","size","onClick","t","Fragment","variant","color","menuOpen","handleClose"],"sources":["/home/user/whaticket-free/frontend/src/components/TicketActionButtons/index.js"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { IconButton } from \"@material-ui/core\";\nimport { MoreVert, Replay } from \"@material-ui/icons\";\n\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport TicketOptionsMenu from \"../TicketOptionsMenu\";\nimport ButtonWithSpinner from \"../ButtonWithSpinner\";\nimport toastError from \"../../errors/toastError\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst useStyles = makeStyles(theme => ({\n\tactionButtons: {\n\t\tmarginRight: 6,\n\t\tflex: \"none\",\n\t\talignSelf: \"center\",\n\t\tmarginLeft: \"auto\",\n\t\t\"& > *\": {\n\t\t\tmargin: theme.spacing(1),\n\t\t},\n\t},\n}));\n\nconst TicketActionButtons = ({ ticket }) => {\n\tconst classes = useStyles();\n\tconst history = useHistory();\n\tconst [anchorEl, setAnchorEl] = useState(null);\n\tconst [loading, setLoading] = useState(false);\n\tconst ticketOptionsMenuOpen = Boolean(anchorEl);\n\tconst { user } = useContext(AuthContext);\n\n\tconst handleOpenTicketOptionsMenu = e => {\n\t\tsetAnchorEl(e.currentTarget);\n\t};\n\n\tconst handleCloseTicketOptionsMenu = e => {\n\t\tsetAnchorEl(null);\n\t};\n\n\tconst handleUpdateTicketStatus = async (e, status, userId) => {\n\t\tsetLoading(true);\n\t\ttry {\n\t\t\tawait api.put(`/tickets/${ticket.id}`, {\n\t\t\t\tstatus: status,\n\t\t\t\tuserId: userId || null,\n\t\t\t});\n\n\t\t\tsetLoading(false);\n\t\t\tif (status === \"open\") {\n\t\t\t\thistory.push(`/tickets/${ticket.id}`);\n\t\t\t} else {\n\t\t\t\thistory.push(\"/tickets\");\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tsetLoading(false);\n\t\t\ttoastError(err);\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className={classes.actionButtons}>\n\t\t\t{ticket.status === \"closed\" && (\n\t\t\t\t<ButtonWithSpinner\n\t\t\t\t\tloading={loading}\n\t\t\t\t\tstartIcon={<Replay />}\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t\tonClick={e => handleUpdateTicketStatus(e, \"open\", user?.id)}\n\t\t\t\t>\n\t\t\t\t\t{i18n.t(\"messagesList.header.buttons.reopen\")}\n\t\t\t\t</ButtonWithSpinner>\n\t\t\t)}\n\t\t\t{ticket.status === \"open\" && (\n\t\t\t\t<>\n\t\t\t\t\t<ButtonWithSpinner\n\t\t\t\t\t\tloading={loading}\n\t\t\t\t\t\tstartIcon={<Replay />}\n\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\tonClick={e => handleUpdateTicketStatus(e, \"pending\", null)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{i18n.t(\"messagesList.header.buttons.return\")}\n\t\t\t\t\t</ButtonWithSpinner>\n\t\t\t\t\t<ButtonWithSpinner\n\t\t\t\t\t\tloading={loading}\n\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\tonClick={e => handleUpdateTicketStatus(e, \"closed\", user?.id)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{i18n.t(\"messagesList.header.buttons.resolve\")}\n\t\t\t\t\t</ButtonWithSpinner>\n\t\t\t\t\t<IconButton onClick={handleOpenTicketOptionsMenu}>\n\t\t\t\t\t\t<MoreVert />\n\t\t\t\t\t</IconButton>\n\t\t\t\t\t<TicketOptionsMenu\n\t\t\t\t\t\tticket={ticket}\n\t\t\t\t\t\tanchorEl={anchorEl}\n\t\t\t\t\t\tmenuOpen={ticketOptionsMenuOpen}\n\t\t\t\t\t\thandleClose={handleCloseTicketOptionsMenu}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{ticket.status === \"pending\" && (\n\t\t\t\t<ButtonWithSpinner\n\t\t\t\t\tloading={loading}\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\tonClick={e => handleUpdateTicketStatus(e, \"open\", user?.id)}\n\t\t\t\t>\n\t\t\t\t\t{i18n.t(\"messagesList.header.buttons.accept\")}\n\t\t\t\t</ButtonWithSpinner>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport default TicketActionButtons;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}