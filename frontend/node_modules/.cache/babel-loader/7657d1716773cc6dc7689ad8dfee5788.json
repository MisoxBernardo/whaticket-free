{"ast":null,"code":"import React,{useContext,useEffect,useRef,useState}from\"react\";import MenuItem from\"@material-ui/core/MenuItem\";import Menu from\"@material-ui/core/Menu\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import ConfirmationModal from\"../ConfirmationModal\";import TransferTicketModal from\"../TransferTicketModal\";import toastError from\"../../errors/toastError\";import{Can}from\"../Can\";import{AuthContext}from\"../../context/Auth/AuthContext\";const TicketOptionsMenu=_ref=>{let{ticket,menuOpen,handleClose,anchorEl}=_ref;const[confirmationOpen,setConfirmationOpen]=useState(false);const[transferTicketModalOpen,setTransferTicketModalOpen]=useState(false);const isMounted=useRef(true);const{user}=useContext(AuthContext);useEffect(()=>{return()=>{isMounted.current=false;};},[]);const handleDeleteTicket=async()=>{try{await api.delete(\"/tickets/\".concat(ticket.id));}catch(err){toastError(err);}};const handleOpenConfirmationModal=e=>{setConfirmationOpen(true);handleClose();};const handleOpenTransferModal=e=>{setTransferTicketModalOpen(true);handleClose();};const handleCloseTransferTicketModal=()=>{if(isMounted.current){setTransferTicketModalOpen(false);}};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Menu,{id:\"menu-appbar\",anchorEl:anchorEl,getContentAnchorEl:null,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},keepMounted:true,transformOrigin:{vertical:\"top\",horizontal:\"right\"},open:menuOpen,onClose:handleClose},/*#__PURE__*/React.createElement(MenuItem,{onClick:handleOpenTransferModal},i18n.t(\"ticketOptionsMenu.transfer\")),/*#__PURE__*/React.createElement(Can,{role:user.profile,perform:\"ticket-options:deleteTicket\",yes:()=>/*#__PURE__*/React.createElement(MenuItem,{onClick:handleOpenConfirmationModal},i18n.t(\"ticketOptionsMenu.delete\"))})),/*#__PURE__*/React.createElement(ConfirmationModal,{title:\"\".concat(i18n.t(\"ticketOptionsMenu.confirmationModal.title\")).concat(ticket.id,\" \").concat(i18n.t(\"ticketOptionsMenu.confirmationModal.titleFrom\"),\" \").concat(ticket.contact.name,\"?\"),open:confirmationOpen,onClose:setConfirmationOpen,onConfirm:handleDeleteTicket},i18n.t(\"ticketOptionsMenu.confirmationModal.message\")),/*#__PURE__*/React.createElement(TransferTicketModal,{modalOpen:transferTicketModalOpen,onClose:handleCloseTransferTicketModal,ticketid:ticket.id,ticketWhatsappId:ticket.whatsappId}));};export default TicketOptionsMenu;","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","MenuItem","Menu","i18n","api","ConfirmationModal","TransferTicketModal","toastError","Can","AuthContext","TicketOptionsMenu","_ref","ticket","menuOpen","handleClose","anchorEl","confirmationOpen","setConfirmationOpen","transferTicketModalOpen","setTransferTicketModalOpen","isMounted","user","current","handleDeleteTicket","delete","concat","id","err","handleOpenConfirmationModal","e","handleOpenTransferModal","handleCloseTransferTicketModal","createElement","Fragment","getContentAnchorEl","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","open","onClose","onClick","t","role","profile","perform","yes","title","contact","name","onConfirm","modalOpen","ticketid","ticketWhatsappId","whatsappId"],"sources":["/home/fenix/whaticket-free/frontend/src/components/TicketOptionsMenu/index.js"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from \"react\";\n\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Menu from \"@material-ui/core/Menu\";\n\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport ConfirmationModal from \"../ConfirmationModal\";\nimport TransferTicketModal from \"../TransferTicketModal\";\nimport toastError from \"../../errors/toastError\";\nimport { Can } from \"../Can\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst TicketOptionsMenu = ({ ticket, menuOpen, handleClose, anchorEl }) => {\n\tconst [confirmationOpen, setConfirmationOpen] = useState(false);\n\tconst [transferTicketModalOpen, setTransferTicketModalOpen] = useState(false);\n\tconst isMounted = useRef(true);\n\tconst { user } = useContext(AuthContext);\n\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tisMounted.current = false;\n\t\t};\n\t}, []);\n\n\tconst handleDeleteTicket = async () => {\n\t\ttry {\n\t\t\tawait api.delete(`/tickets/${ticket.id}`);\n\t\t} catch (err) {\n\t\t\ttoastError(err);\n\t\t}\n\t};\n\n\tconst handleOpenConfirmationModal = e => {\n\t\tsetConfirmationOpen(true);\n\t\thandleClose();\n\t};\n\n\tconst handleOpenTransferModal = e => {\n\t\tsetTransferTicketModalOpen(true);\n\t\thandleClose();\n\t};\n\n\tconst handleCloseTransferTicketModal = () => {\n\t\tif (isMounted.current) {\n\t\t\tsetTransferTicketModalOpen(false);\n\t\t}\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<Menu\n\t\t\t\tid=\"menu-appbar\"\n\t\t\t\tanchorEl={anchorEl}\n\t\t\t\tgetContentAnchorEl={null}\n\t\t\t\tanchorOrigin={{\n\t\t\t\t\tvertical: \"bottom\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\tkeepMounted\n\t\t\t\ttransformOrigin={{\n\t\t\t\t\tvertical: \"top\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\topen={menuOpen}\n\t\t\t\tonClose={handleClose}\n\t\t\t>\n\t\t\t\t<MenuItem onClick={handleOpenTransferModal}>\n\t\t\t\t\t{i18n.t(\"ticketOptionsMenu.transfer\")}\n\t\t\t\t</MenuItem>\n\t\t\t\t<Can\n\t\t\t\t\trole={user.profile}\n\t\t\t\t\tperform=\"ticket-options:deleteTicket\"\n\t\t\t\t\tyes={() => (\n\t\t\t\t\t\t<MenuItem onClick={handleOpenConfirmationModal}>\n\t\t\t\t\t\t\t{i18n.t(\"ticketOptionsMenu.delete\")}\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\t\t\t</Menu>\n\t\t\t<ConfirmationModal\n\t\t\t\ttitle={`${i18n.t(\"ticketOptionsMenu.confirmationModal.title\")}${\n\t\t\t\t\tticket.id\n\t\t\t\t} ${i18n.t(\"ticketOptionsMenu.confirmationModal.titleFrom\")} ${\n\t\t\t\t\tticket.contact.name\n\t\t\t\t}?`}\n\t\t\t\topen={confirmationOpen}\n\t\t\t\tonClose={setConfirmationOpen}\n\t\t\t\tonConfirm={handleDeleteTicket}\n\t\t\t>\n\t\t\t\t{i18n.t(\"ticketOptionsMenu.confirmationModal.message\")}\n\t\t\t</ConfirmationModal>\n\t\t\t<TransferTicketModal\n\t\t\t\tmodalOpen={transferTicketModalOpen}\n\t\t\t\tonClose={handleCloseTransferTicketModal}\n\t\t\t\tticketid={ticket.id}\n\t\t\t\tticketWhatsappId={ticket.whatsappId}\n\t\t\t/>\n\t\t</>\n\t);\n};\n\nexport default TicketOptionsMenu;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}