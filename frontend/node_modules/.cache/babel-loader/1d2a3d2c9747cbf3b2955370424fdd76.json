{"ast":null,"code":"import React,{useState,useRef,useEffect,useContext}from\"react\";import{useHistory}from\"react-router-dom\";import{format}from\"date-fns\";import openSocket from\"../../services/socket-io\";import useSound from\"use-sound\";import Popover from\"@material-ui/core/Popover\";import IconButton from\"@material-ui/core/IconButton\";import List from\"@material-ui/core/List\";import ListItem from\"@material-ui/core/ListItem\";import ListItemText from\"@material-ui/core/ListItemText\";import{makeStyles}from\"@material-ui/core/styles\";import Badge from\"@material-ui/core/Badge\";import ChatIcon from\"@material-ui/icons/Chat\";import TicketListItem from\"../TicketListItem\";import{i18n}from\"../../translate/i18n\";import useTickets from\"../../hooks/useTickets\";import alertSound from\"../../assets/sound.mp3\";import{AuthContext}from\"../../context/Auth/AuthContext\";const useStyles=makeStyles(theme=>({tabContainer:{overflowY:\"auto\",maxHeight:350,...theme.scrollbarStyles},popoverPaper:{width:\"100%\",maxWidth:350,marginLeft:theme.spacing(2),marginRight:theme.spacing(1),[theme.breakpoints.down(\"sm\")]:{maxWidth:270}},noShadow:{boxShadow:\"none !important\"}}));const NotificationsPopOver=()=>{const classes=useStyles();const history=useHistory();const{user}=useContext(AuthContext);const ticketIdUrl=+history.location.pathname.split(\"/\")[2];const ticketIdRef=useRef(ticketIdUrl);const anchorEl=useRef();const[isOpen,setIsOpen]=useState(false);const[notifications,setNotifications]=useState([]);const[,setDesktopNotifications]=useState([]);const{tickets}=useTickets({withUnreadMessages:\"true\"});const[play]=useSound(alertSound);const soundAlertRef=useRef();const historyRef=useRef(history);useEffect(()=>{soundAlertRef.current=play;if(!(\"Notification\"in window)){console.log(\"This browser doesn't support notifications\");}else{Notification.requestPermission();}},[play]);useEffect(()=>{setNotifications(tickets);},[tickets]);useEffect(()=>{ticketIdRef.current=ticketIdUrl;},[ticketIdUrl]);useEffect(()=>{const socket=openSocket();socket.on(\"ready\",()=>socket.emit(\"joinNotification\"));socket.on(\"ticket\",data=>{if(data.action===\"updateUnread\"||data.action===\"delete\"){setNotifications(prevState=>{const ticketIndex=prevState.findIndex(t=>t.id===data.ticketId);if(ticketIndex!==-1){prevState.splice(ticketIndex,1);return[...prevState];}return prevState;});setDesktopNotifications(prevState=>{const notfiticationIndex=prevState.findIndex(n=>n.tag===String(data.ticketId));if(notfiticationIndex!==-1){prevState[notfiticationIndex].close();prevState.splice(notfiticationIndex,1);return[...prevState];}return prevState;});}});socket.on(\"appMessage\",data=>{if(data.action===\"create\"&&!data.message.read&&(data.ticket.userId===(user===null||user===void 0?void 0:user.id)||!data.ticket.userId)){setNotifications(prevState=>{const ticketIndex=prevState.findIndex(t=>t.id===data.ticket.id);if(ticketIndex!==-1){prevState[ticketIndex]=data.ticket;return[...prevState];}return[data.ticket,...prevState];});const shouldNotNotificate=data.message.ticketId===ticketIdRef.current&&document.visibilityState===\"visible\"||data.ticket.userId&&data.ticket.userId!==(user===null||user===void 0?void 0:user.id)||data.ticket.isGroup;if(shouldNotNotificate)return;handleNotifications(data);}});return()=>{socket.disconnect();};},[user]);const handleNotifications=data=>{const{message,contact,ticket}=data;const options={body:\"\".concat(message.body,\" - \").concat(format(new Date(),\"HH:mm\")),icon:contact.profilePicUrl,tag:ticket.id,renotify:true};const notification=new Notification(\"\".concat(i18n.t(\"tickets.notification.message\"),\" \").concat(contact.name),options);notification.onclick=e=>{e.preventDefault();window.focus();historyRef.current.push(\"/tickets/\".concat(ticket.id));};setDesktopNotifications(prevState=>{const notfiticationIndex=prevState.findIndex(n=>n.tag===notification.tag);if(notfiticationIndex!==-1){prevState[notfiticationIndex]=notification;return[...prevState];}return[notification,...prevState];});soundAlertRef.current();};const handleClick=()=>{setIsOpen(prevState=>!prevState);};const handleClickAway=()=>{setIsOpen(false);};const NotificationTicket=_ref=>{let{children}=_ref;return/*#__PURE__*/React.createElement(\"div\",{onClick:handleClickAway},children);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(IconButton,{onClick:handleClick,ref:anchorEl,\"aria-label\":\"Open Notifications\",color:\"inherit\"},/*#__PURE__*/React.createElement(Badge,{badgeContent:notifications.length,color:\"secondary\"},/*#__PURE__*/React.createElement(ChatIcon,null))),/*#__PURE__*/React.createElement(Popover,{disableScrollLock:true,open:isOpen,anchorEl:anchorEl.current,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},transformOrigin:{vertical:\"top\",horizontal:\"right\"},classes:{paper:classes.popoverPaper},onClose:handleClickAway},/*#__PURE__*/React.createElement(List,{dense:true,className:classes.tabContainer},notifications.length===0?/*#__PURE__*/React.createElement(ListItem,null,/*#__PURE__*/React.createElement(ListItemText,null,i18n.t(\"notifications.noTickets\"))):notifications.map(ticket=>/*#__PURE__*/React.createElement(NotificationTicket,{key:ticket.id},/*#__PURE__*/React.createElement(TicketListItem,{ticket:ticket}))))));};export default NotificationsPopOver;","map":{"version":3,"names":["React","useState","useRef","useEffect","useContext","useHistory","format","openSocket","useSound","Popover","IconButton","List","ListItem","ListItemText","makeStyles","Badge","ChatIcon","TicketListItem","i18n","useTickets","alertSound","AuthContext","useStyles","theme","tabContainer","overflowY","maxHeight","scrollbarStyles","popoverPaper","width","maxWidth","marginLeft","spacing","marginRight","breakpoints","down","noShadow","boxShadow","NotificationsPopOver","classes","history","user","ticketIdUrl","location","pathname","split","ticketIdRef","anchorEl","isOpen","setIsOpen","notifications","setNotifications","setDesktopNotifications","tickets","withUnreadMessages","play","soundAlertRef","historyRef","current","window","console","log","Notification","requestPermission","socket","on","emit","data","action","prevState","ticketIndex","findIndex","t","id","ticketId","splice","notfiticationIndex","n","tag","String","close","message","read","ticket","userId","shouldNotNotificate","document","visibilityState","isGroup","handleNotifications","disconnect","contact","options","body","concat","Date","icon","profilePicUrl","renotify","notification","name","onclick","e","preventDefault","focus","push","handleClick","handleClickAway","NotificationTicket","_ref","children","createElement","onClick","Fragment","ref","color","badgeContent","length","disableScrollLock","open","anchorOrigin","vertical","horizontal","transformOrigin","paper","onClose","dense","className","map","key"],"sources":["/home/user/whaticket-free/frontend/src/components/NotificationsPopOver/index.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useContext } from \"react\";\n\nimport { useHistory } from \"react-router-dom\";\nimport { format } from \"date-fns\";\nimport openSocket from \"../../services/socket-io\";\nimport useSound from \"use-sound\";\n\nimport Popover from \"@material-ui/core/Popover\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Badge from \"@material-ui/core/Badge\";\nimport ChatIcon from \"@material-ui/icons/Chat\";\n\nimport TicketListItem from \"../TicketListItem\";\nimport { i18n } from \"../../translate/i18n\";\nimport useTickets from \"../../hooks/useTickets\";\nimport alertSound from \"../../assets/sound.mp3\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst useStyles = makeStyles(theme => ({\n\ttabContainer: {\n\t\toverflowY: \"auto\",\n\t\tmaxHeight: 350,\n\t\t...theme.scrollbarStyles,\n\t},\n\tpopoverPaper: {\n\t\twidth: \"100%\",\n\t\tmaxWidth: 350,\n\t\tmarginLeft: theme.spacing(2),\n\t\tmarginRight: theme.spacing(1),\n\t\t[theme.breakpoints.down(\"sm\")]: {\n\t\t\tmaxWidth: 270,\n\t\t},\n\t},\n\tnoShadow: {\n\t\tboxShadow: \"none !important\",\n\t},\n}));\n\nconst NotificationsPopOver = () => {\n\tconst classes = useStyles();\n\n\tconst history = useHistory();\n\tconst { user } = useContext(AuthContext);\n\tconst ticketIdUrl = +history.location.pathname.split(\"/\")[2];\n\tconst ticketIdRef = useRef(ticketIdUrl);\n\tconst anchorEl = useRef();\n\tconst [isOpen, setIsOpen] = useState(false);\n\tconst [notifications, setNotifications] = useState([]);\n\n\tconst [, setDesktopNotifications] = useState([]);\n\n\tconst { tickets } = useTickets({ withUnreadMessages: \"true\" });\n\tconst [play] = useSound(alertSound);\n\tconst soundAlertRef = useRef();\n\n\tconst historyRef = useRef(history);\n\n\tuseEffect(() => {\n\t\tsoundAlertRef.current = play;\n\n\t\tif (!(\"Notification\" in window)) {\n\t\t\tconsole.log(\"This browser doesn't support notifications\");\n\t\t} else {\n\t\t\tNotification.requestPermission();\n\t\t}\n\t}, [play]);\n\n\tuseEffect(() => {\n\t\tsetNotifications(tickets);\n\t}, [tickets]);\n\n\tuseEffect(() => {\n\t\tticketIdRef.current = ticketIdUrl;\n\t}, [ticketIdUrl]);\n\n\tuseEffect(() => {\n\t\tconst socket = openSocket();\n\n\t\tsocket.on(\"ready\", () => socket.emit(\"joinNotification\"));\n\n\t\tsocket.on(\"ticket\", data => {\n\t\t\tif (data.action === \"updateUnread\" || data.action === \"delete\") {\n\t\t\t\tsetNotifications(prevState => {\n\t\t\t\t\tconst ticketIndex = prevState.findIndex(t => t.id === data.ticketId);\n\t\t\t\t\tif (ticketIndex !== -1) {\n\t\t\t\t\t\tprevState.splice(ticketIndex, 1);\n\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t}\n\t\t\t\t\treturn prevState;\n\t\t\t\t});\n\n\t\t\t\tsetDesktopNotifications(prevState => {\n\t\t\t\t\tconst notfiticationIndex = prevState.findIndex(\n\t\t\t\t\t\tn => n.tag === String(data.ticketId)\n\t\t\t\t\t);\n\t\t\t\t\tif (notfiticationIndex !== -1) {\n\t\t\t\t\t\tprevState[notfiticationIndex].close();\n\t\t\t\t\t\tprevState.splice(notfiticationIndex, 1);\n\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t}\n\t\t\t\t\treturn prevState;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tsocket.on(\"appMessage\", data => {\n\t\t\tif (\n\t\t\t\tdata.action === \"create\" &&\n\t\t\t\t!data.message.read &&\n\t\t\t\t(data.ticket.userId === user?.id || !data.ticket.userId)\n\t\t\t) {\n\t\t\t\tsetNotifications(prevState => {\n\t\t\t\t\tconst ticketIndex = prevState.findIndex(t => t.id === data.ticket.id);\n\t\t\t\t\tif (ticketIndex !== -1) {\n\t\t\t\t\t\tprevState[ticketIndex] = data.ticket;\n\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t}\n\t\t\t\t\treturn [data.ticket, ...prevState];\n\t\t\t\t});\n\n\t\t\t\tconst shouldNotNotificate =\n\t\t\t\t\t(data.message.ticketId === ticketIdRef.current &&\n\t\t\t\t\t\tdocument.visibilityState === \"visible\") ||\n\t\t\t\t\t(data.ticket.userId && data.ticket.userId !== user?.id) ||\n\t\t\t\t\tdata.ticket.isGroup;\n\n\t\t\t\tif (shouldNotNotificate) return;\n\n\t\t\t\thandleNotifications(data);\n\t\t\t}\n\t\t});\n\n\t\treturn () => {\n\t\t\tsocket.disconnect();\n\t\t};\n\t}, [user]);\n\n\tconst handleNotifications = data => {\n\t\tconst { message, contact, ticket } = data;\n\n\t\tconst options = {\n\t\t\tbody: `${message.body} - ${format(new Date(), \"HH:mm\")}`,\n\t\t\ticon: contact.profilePicUrl,\n\t\t\ttag: ticket.id,\n\t\t\trenotify: true,\n\t\t};\n\n\t\tconst notification = new Notification(\n\t\t\t`${i18n.t(\"tickets.notification.message\")} ${contact.name}`,\n\t\t\toptions\n\t\t);\n\n\t\tnotification.onclick = e => {\n\t\t\te.preventDefault();\n\t\t\twindow.focus();\n\t\t\thistoryRef.current.push(`/tickets/${ticket.id}`);\n\t\t};\n\n\t\tsetDesktopNotifications(prevState => {\n\t\t\tconst notfiticationIndex = prevState.findIndex(\n\t\t\t\tn => n.tag === notification.tag\n\t\t\t);\n\t\t\tif (notfiticationIndex !== -1) {\n\t\t\t\tprevState[notfiticationIndex] = notification;\n\t\t\t\treturn [...prevState];\n\t\t\t}\n\t\t\treturn [notification, ...prevState];\n\t\t});\n\n\t\tsoundAlertRef.current();\n\t};\n\n\tconst handleClick = () => {\n\t\tsetIsOpen(prevState => !prevState);\n\t};\n\n\tconst handleClickAway = () => {\n\t\tsetIsOpen(false);\n\t};\n\n\tconst NotificationTicket = ({ children }) => {\n\t\treturn <div onClick={handleClickAway}>{children}</div>;\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<IconButton\n\t\t\t\tonClick={handleClick}\n\t\t\t\tref={anchorEl}\n\t\t\t\taria-label=\"Open Notifications\"\n\t\t\t\tcolor=\"inherit\"\n\t\t\t>\n\t\t\t\t<Badge badgeContent={notifications.length} color=\"secondary\">\n\t\t\t\t\t<ChatIcon />\n\t\t\t\t</Badge>\n\t\t\t</IconButton>\n\t\t\t<Popover\n\t\t\t\tdisableScrollLock\n\t\t\t\topen={isOpen}\n\t\t\t\tanchorEl={anchorEl.current}\n\t\t\t\tanchorOrigin={{\n\t\t\t\t\tvertical: \"bottom\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\ttransformOrigin={{\n\t\t\t\t\tvertical: \"top\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\tclasses={{ paper: classes.popoverPaper }}\n\t\t\t\tonClose={handleClickAway}\n\t\t\t>\n\t\t\t\t<List dense className={classes.tabContainer}>\n\t\t\t\t\t{notifications.length === 0 ? (\n\t\t\t\t\t\t<ListItem>\n\t\t\t\t\t\t\t<ListItemText>{i18n.t(\"notifications.noTickets\")}</ListItemText>\n\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t) : (\n\t\t\t\t\t\tnotifications.map(ticket => (\n\t\t\t\t\t\t\t<NotificationTicket key={ticket.id}>\n\t\t\t\t\t\t\t\t<TicketListItem ticket={ticket} />\n\t\t\t\t\t\t\t</NotificationTicket>\n\t\t\t\t\t\t))\n\t\t\t\t\t)}\n\t\t\t\t</List>\n\t\t\t</Popover>\n\t\t</>\n\t);\n};\n\nexport default NotificationsPopOver;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}