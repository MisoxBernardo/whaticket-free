{"ast":null,"code":"var _jsxFileName = \"/home/user/whaticket-free/frontend/src/components/NotificationsPopOver/index.js\";\nimport React, { useState, useRef, useEffect, useContext } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { format } from \"date-fns\";\nimport openSocket from \"../../services/socket-io\";\nimport useSound from \"use-sound\";\nimport Popover from \"@material-ui/core/Popover\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Badge from \"@material-ui/core/Badge\";\nimport ChatIcon from \"@material-ui/icons/Chat\";\nimport TicketListItem from \"../TicketListItem\";\nimport { i18n } from \"../../translate/i18n\";\nimport useTickets from \"../../hooks/useTickets\";\nimport alertSound from \"../../assets/sound.mp3\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nconst useStyles = makeStyles(theme => ({\n  tabContainer: {\n    overflowY: \"auto\",\n    maxHeight: 350,\n    ...theme.scrollbarStyles\n  },\n  popoverPaper: {\n    width: \"100%\",\n    maxWidth: 350,\n    marginLeft: theme.spacing(2),\n    marginRight: theme.spacing(1),\n    [theme.breakpoints.down(\"sm\")]: {\n      maxWidth: 270\n    }\n  },\n  noShadow: {\n    boxShadow: \"none !important\"\n  }\n}));\nconst NotificationsPopOver = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const {\n    user\n  } = useContext(AuthContext);\n  const ticketIdUrl = +history.location.pathname.split(\"/\")[2];\n  const ticketIdRef = useRef(ticketIdUrl);\n  const anchorEl = useRef();\n  const [isOpen, setIsOpen] = useState(false);\n  const [notifications, setNotifications] = useState([]);\n  const [, setDesktopNotifications] = useState([]);\n  const {\n    tickets\n  } = useTickets({\n    withUnreadMessages: \"true\"\n  });\n  const [play] = useSound(alertSound);\n  const soundAlertRef = useRef();\n  const historyRef = useRef(history);\n  useEffect(() => {\n    soundAlertRef.current = play;\n    if (!(\"Notification\" in window)) {\n      console.log(\"This browser doesn't support notifications\");\n    } else {\n      Notification.requestPermission();\n    }\n  }, [play]);\n  useEffect(() => {\n    setNotifications(tickets);\n  }, [tickets]);\n  useEffect(() => {\n    ticketIdRef.current = ticketIdUrl;\n  }, [ticketIdUrl]);\n  useEffect(() => {\n    const socket = openSocket();\n    socket.on(\"ready\", () => socket.emit(\"joinNotification\"));\n    socket.on(\"ticket\", data => {\n      if (data.action === \"updateUnread\" || data.action === \"delete\") {\n        setNotifications(prevState => {\n          const ticketIndex = prevState.findIndex(t => t.id === data.ticketId);\n          if (ticketIndex !== -1) {\n            prevState.splice(ticketIndex, 1);\n            return [...prevState];\n          }\n          return prevState;\n        });\n        setDesktopNotifications(prevState => {\n          const notfiticationIndex = prevState.findIndex(n => n.tag === String(data.ticketId));\n          if (notfiticationIndex !== -1) {\n            prevState[notfiticationIndex].close();\n            prevState.splice(notfiticationIndex, 1);\n            return [...prevState];\n          }\n          return prevState;\n        });\n      }\n    });\n    socket.on(\"appMessage\", data => {\n      if (data.action === \"create\" && !data.message.read && (data.ticket.userId === (user === null || user === void 0 ? void 0 : user.id) || !data.ticket.userId)) {\n        setNotifications(prevState => {\n          const ticketIndex = prevState.findIndex(t => t.id === data.ticket.id);\n          if (ticketIndex !== -1) {\n            prevState[ticketIndex] = data.ticket;\n            return [...prevState];\n          }\n          return [data.ticket, ...prevState];\n        });\n        const shouldNotNotificate = data.message.ticketId === ticketIdRef.current && document.visibilityState === \"visible\" || data.ticket.userId && data.ticket.userId !== (user === null || user === void 0 ? void 0 : user.id) || data.ticket.isGroup;\n        if (shouldNotNotificate) return;\n        handleNotifications(data);\n      }\n    });\n    return () => {\n      socket.disconnect();\n    };\n  }, [user]);\n  const handleNotifications = data => {\n    const {\n      message,\n      contact,\n      ticket\n    } = data;\n    const options = {\n      body: `${message.body} - ${format(new Date(), \"HH:mm\")}`,\n      icon: contact.profilePicUrl,\n      tag: ticket.id,\n      renotify: true\n    };\n    const notification = new Notification(`${i18n.t(\"tickets.notification.message\")} ${contact.name}`, options);\n    notification.onclick = e => {\n      e.preventDefault();\n      window.focus();\n      historyRef.current.push(`/tickets/${ticket.id}`);\n    };\n    setDesktopNotifications(prevState => {\n      const notfiticationIndex = prevState.findIndex(n => n.tag === notification.tag);\n      if (notfiticationIndex !== -1) {\n        prevState[notfiticationIndex] = notification;\n        return [...prevState];\n      }\n      return [notification, ...prevState];\n    });\n    soundAlertRef.current();\n  };\n  const handleClick = () => {\n    setIsOpen(prevState => !prevState);\n  };\n  const handleClickAway = () => {\n    setIsOpen(false);\n  };\n  const NotificationTicket = ({\n    children\n  }) => {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      onClick: handleClickAway,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 10\n      }\n    }, children);\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(IconButton, {\n    onClick: handleClick,\n    ref: anchorEl,\n    \"aria-label\": \"Open Notifications\",\n    color: \"inherit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Badge, {\n    badgeContent: notifications.length,\n    color: \"secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ChatIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 6\n    }\n  }))), /*#__PURE__*/React.createElement(Popover, {\n    disableScrollLock: true,\n    open: isOpen,\n    anchorEl: anchorEl.current,\n    anchorOrigin: {\n      vertical: \"bottom\",\n      horizontal: \"right\"\n    },\n    transformOrigin: {\n      vertical: \"top\",\n      horizontal: \"right\"\n    },\n    classes: {\n      paper: classes.popoverPaper\n    },\n    onClose: handleClickAway,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(List, {\n    dense: true,\n    className: classes.tabContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 5\n    }\n  }, notifications.length === 0 ? /*#__PURE__*/React.createElement(ListItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ListItemText, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 8\n    }\n  }, i18n.t(\"notifications.noTickets\"))) : notifications.map(ticket => /*#__PURE__*/React.createElement(NotificationTicket, {\n    key: ticket.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 8\n    }\n  }, /*#__PURE__*/React.createElement(TicketListItem, {\n    ticket: ticket,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 9\n    }\n  }))))));\n};\nexport default NotificationsPopOver;","map":{"version":3,"names":["React","useState","useRef","useEffect","useContext","useHistory","format","openSocket","useSound","Popover","IconButton","List","ListItem","ListItemText","makeStyles","Badge","ChatIcon","TicketListItem","i18n","useTickets","alertSound","AuthContext","useStyles","theme","tabContainer","overflowY","maxHeight","scrollbarStyles","popoverPaper","width","maxWidth","marginLeft","spacing","marginRight","breakpoints","down","noShadow","boxShadow","NotificationsPopOver","classes","history","user","ticketIdUrl","location","pathname","split","ticketIdRef","anchorEl","isOpen","setIsOpen","notifications","setNotifications","setDesktopNotifications","tickets","withUnreadMessages","play","soundAlertRef","historyRef","current","window","console","log","Notification","requestPermission","socket","on","emit","data","action","prevState","ticketIndex","findIndex","t","id","ticketId","splice","notfiticationIndex","n","tag","String","close","message","read","ticket","userId","shouldNotNotificate","document","visibilityState","isGroup","handleNotifications","disconnect","contact","options","body","Date","icon","profilePicUrl","renotify","notification","name","onclick","e","preventDefault","focus","push","handleClick","handleClickAway","NotificationTicket","children","createElement","onClick","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","Fragment","ref","color","badgeContent","length","disableScrollLock","open","anchorOrigin","vertical","horizontal","transformOrigin","paper","onClose","dense","className","map","key"],"sources":["/home/user/whaticket-free/frontend/src/components/NotificationsPopOver/index.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useContext } from \"react\";\n\nimport { useHistory } from \"react-router-dom\";\nimport { format } from \"date-fns\";\nimport openSocket from \"../../services/socket-io\";\nimport useSound from \"use-sound\";\n\nimport Popover from \"@material-ui/core/Popover\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Badge from \"@material-ui/core/Badge\";\nimport ChatIcon from \"@material-ui/icons/Chat\";\n\nimport TicketListItem from \"../TicketListItem\";\nimport { i18n } from \"../../translate/i18n\";\nimport useTickets from \"../../hooks/useTickets\";\nimport alertSound from \"../../assets/sound.mp3\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst useStyles = makeStyles(theme => ({\n\ttabContainer: {\n\t\toverflowY: \"auto\",\n\t\tmaxHeight: 350,\n\t\t...theme.scrollbarStyles,\n\t},\n\tpopoverPaper: {\n\t\twidth: \"100%\",\n\t\tmaxWidth: 350,\n\t\tmarginLeft: theme.spacing(2),\n\t\tmarginRight: theme.spacing(1),\n\t\t[theme.breakpoints.down(\"sm\")]: {\n\t\t\tmaxWidth: 270,\n\t\t},\n\t},\n\tnoShadow: {\n\t\tboxShadow: \"none !important\",\n\t},\n}));\n\nconst NotificationsPopOver = () => {\n\tconst classes = useStyles();\n\n\tconst history = useHistory();\n\tconst { user } = useContext(AuthContext);\n\tconst ticketIdUrl = +history.location.pathname.split(\"/\")[2];\n\tconst ticketIdRef = useRef(ticketIdUrl);\n\tconst anchorEl = useRef();\n\tconst [isOpen, setIsOpen] = useState(false);\n\tconst [notifications, setNotifications] = useState([]);\n\n\tconst [, setDesktopNotifications] = useState([]);\n\n\tconst { tickets } = useTickets({ withUnreadMessages: \"true\" });\n\tconst [play] = useSound(alertSound);\n\tconst soundAlertRef = useRef();\n\n\tconst historyRef = useRef(history);\n\n\tuseEffect(() => {\n\t\tsoundAlertRef.current = play;\n\n\t\tif (!(\"Notification\" in window)) {\n\t\t\tconsole.log(\"This browser doesn't support notifications\");\n\t\t} else {\n\t\t\tNotification.requestPermission();\n\t\t}\n\t}, [play]);\n\n\tuseEffect(() => {\n\t\tsetNotifications(tickets);\n\t}, [tickets]);\n\n\tuseEffect(() => {\n\t\tticketIdRef.current = ticketIdUrl;\n\t}, [ticketIdUrl]);\n\n\tuseEffect(() => {\n\t\tconst socket = openSocket();\n\n\t\tsocket.on(\"ready\", () => socket.emit(\"joinNotification\"));\n\n\t\tsocket.on(\"ticket\", data => {\n\t\t\tif (data.action === \"updateUnread\" || data.action === \"delete\") {\n\t\t\t\tsetNotifications(prevState => {\n\t\t\t\t\tconst ticketIndex = prevState.findIndex(t => t.id === data.ticketId);\n\t\t\t\t\tif (ticketIndex !== -1) {\n\t\t\t\t\t\tprevState.splice(ticketIndex, 1);\n\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t}\n\t\t\t\t\treturn prevState;\n\t\t\t\t});\n\n\t\t\t\tsetDesktopNotifications(prevState => {\n\t\t\t\t\tconst notfiticationIndex = prevState.findIndex(\n\t\t\t\t\t\tn => n.tag === String(data.ticketId)\n\t\t\t\t\t);\n\t\t\t\t\tif (notfiticationIndex !== -1) {\n\t\t\t\t\t\tprevState[notfiticationIndex].close();\n\t\t\t\t\t\tprevState.splice(notfiticationIndex, 1);\n\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t}\n\t\t\t\t\treturn prevState;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tsocket.on(\"appMessage\", data => {\n\t\t\tif (\n\t\t\t\tdata.action === \"create\" &&\n\t\t\t\t!data.message.read &&\n\t\t\t\t(data.ticket.userId === user?.id || !data.ticket.userId)\n\t\t\t) {\n\t\t\t\tsetNotifications(prevState => {\n\t\t\t\t\tconst ticketIndex = prevState.findIndex(t => t.id === data.ticket.id);\n\t\t\t\t\tif (ticketIndex !== -1) {\n\t\t\t\t\t\tprevState[ticketIndex] = data.ticket;\n\t\t\t\t\t\treturn [...prevState];\n\t\t\t\t\t}\n\t\t\t\t\treturn [data.ticket, ...prevState];\n\t\t\t\t});\n\n\t\t\t\tconst shouldNotNotificate =\n\t\t\t\t\t(data.message.ticketId === ticketIdRef.current &&\n\t\t\t\t\t\tdocument.visibilityState === \"visible\") ||\n\t\t\t\t\t(data.ticket.userId && data.ticket.userId !== user?.id) ||\n\t\t\t\t\tdata.ticket.isGroup;\n\n\t\t\t\tif (shouldNotNotificate) return;\n\n\t\t\t\thandleNotifications(data);\n\t\t\t}\n\t\t});\n\n\t\treturn () => {\n\t\t\tsocket.disconnect();\n\t\t};\n\t}, [user]);\n\n\tconst handleNotifications = data => {\n\t\tconst { message, contact, ticket } = data;\n\n\t\tconst options = {\n\t\t\tbody: `${message.body} - ${format(new Date(), \"HH:mm\")}`,\n\t\t\ticon: contact.profilePicUrl,\n\t\t\ttag: ticket.id,\n\t\t\trenotify: true,\n\t\t};\n\n\t\tconst notification = new Notification(\n\t\t\t`${i18n.t(\"tickets.notification.message\")} ${contact.name}`,\n\t\t\toptions\n\t\t);\n\n\t\tnotification.onclick = e => {\n\t\t\te.preventDefault();\n\t\t\twindow.focus();\n\t\t\thistoryRef.current.push(`/tickets/${ticket.id}`);\n\t\t};\n\n\t\tsetDesktopNotifications(prevState => {\n\t\t\tconst notfiticationIndex = prevState.findIndex(\n\t\t\t\tn => n.tag === notification.tag\n\t\t\t);\n\t\t\tif (notfiticationIndex !== -1) {\n\t\t\t\tprevState[notfiticationIndex] = notification;\n\t\t\t\treturn [...prevState];\n\t\t\t}\n\t\t\treturn [notification, ...prevState];\n\t\t});\n\n\t\tsoundAlertRef.current();\n\t};\n\n\tconst handleClick = () => {\n\t\tsetIsOpen(prevState => !prevState);\n\t};\n\n\tconst handleClickAway = () => {\n\t\tsetIsOpen(false);\n\t};\n\n\tconst NotificationTicket = ({ children }) => {\n\t\treturn <div onClick={handleClickAway}>{children}</div>;\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<IconButton\n\t\t\t\tonClick={handleClick}\n\t\t\t\tref={anchorEl}\n\t\t\t\taria-label=\"Open Notifications\"\n\t\t\t\tcolor=\"inherit\"\n\t\t\t>\n\t\t\t\t<Badge badgeContent={notifications.length} color=\"secondary\">\n\t\t\t\t\t<ChatIcon />\n\t\t\t\t</Badge>\n\t\t\t</IconButton>\n\t\t\t<Popover\n\t\t\t\tdisableScrollLock\n\t\t\t\topen={isOpen}\n\t\t\t\tanchorEl={anchorEl.current}\n\t\t\t\tanchorOrigin={{\n\t\t\t\t\tvertical: \"bottom\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\ttransformOrigin={{\n\t\t\t\t\tvertical: \"top\",\n\t\t\t\t\thorizontal: \"right\",\n\t\t\t\t}}\n\t\t\t\tclasses={{ paper: classes.popoverPaper }}\n\t\t\t\tonClose={handleClickAway}\n\t\t\t>\n\t\t\t\t<List dense className={classes.tabContainer}>\n\t\t\t\t\t{notifications.length === 0 ? (\n\t\t\t\t\t\t<ListItem>\n\t\t\t\t\t\t\t<ListItemText>{i18n.t(\"notifications.noTickets\")}</ListItemText>\n\t\t\t\t\t\t</ListItem>\n\t\t\t\t\t) : (\n\t\t\t\t\t\tnotifications.map(ticket => (\n\t\t\t\t\t\t\t<NotificationTicket key={ticket.id}>\n\t\t\t\t\t\t\t\t<TicketListItem ticket={ticket} />\n\t\t\t\t\t\t\t</NotificationTicket>\n\t\t\t\t\t\t))\n\t\t\t\t\t)}\n\t\t\t\t</List>\n\t\t\t</Popover>\n\t\t</>\n\t);\n};\n\nexport default NotificationsPopOver;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}