{"ast":null,"code":"import React,{useContext,useState}from\"react\";import{useHistory}from\"react-router-dom\";import{makeStyles}from\"@material-ui/core/styles\";import{IconButton}from\"@material-ui/core\";import{MoreVert,Replay}from\"@material-ui/icons\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import TicketOptionsMenu from\"../TicketOptionsMenu\";import ButtonWithSpinner from\"../ButtonWithSpinner\";import toastError from\"../../errors/toastError\";import{AuthContext}from\"../../context/Auth/AuthContext\";const useStyles=makeStyles(theme=>({actionButtons:{marginRight:6,flex:\"none\",alignSelf:\"center\",marginLeft:\"auto\",\"& > *\":{margin:theme.spacing(1)}}}));const TicketActionButtons=_ref=>{let{ticket}=_ref;const classes=useStyles();const history=useHistory();const[anchorEl,setAnchorEl]=useState(null);const[loading,setLoading]=useState(false);const ticketOptionsMenuOpen=Boolean(anchorEl);const{user}=useContext(AuthContext);const handleOpenTicketOptionsMenu=e=>{setAnchorEl(e.currentTarget);};const handleCloseTicketOptionsMenu=e=>{setAnchorEl(null);};const handleUpdateTicketStatus=async(e,status,userId)=>{setLoading(true);try{await api.put(\"/tickets/\".concat(ticket.id),{status:status,userId:userId||null});setLoading(false);if(status===\"open\"){history.push(\"/tickets/\".concat(ticket.id));}else{history.push(\"/tickets\");}}catch(err){setLoading(false);toastError(err);}};return/*#__PURE__*/React.createElement(\"div\",{className:classes.actionButtons},ticket.status===\"closed\"&&/*#__PURE__*/React.createElement(ButtonWithSpinner,{loading:loading,startIcon:/*#__PURE__*/React.createElement(Replay,null),size:\"small\",onClick:e=>handleUpdateTicketStatus(e,\"open\",user===null||user===void 0?void 0:user.id)},i18n.t(\"messagesList.header.buttons.reopen\")),ticket.status===\"open\"&&/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ButtonWithSpinner,{loading:loading,startIcon:/*#__PURE__*/React.createElement(Replay,null),size:\"small\",onClick:e=>handleUpdateTicketStatus(e,\"pending\",null)},i18n.t(\"messagesList.header.buttons.return\")),/*#__PURE__*/React.createElement(ButtonWithSpinner,{loading:loading,size:\"small\",variant:\"contained\",color:\"primary\",onClick:e=>handleUpdateTicketStatus(e,\"closed\",user===null||user===void 0?void 0:user.id)},i18n.t(\"messagesList.header.buttons.resolve\")),/*#__PURE__*/React.createElement(IconButton,{onClick:handleOpenTicketOptionsMenu},/*#__PURE__*/React.createElement(MoreVert,null)),/*#__PURE__*/React.createElement(TicketOptionsMenu,{ticket:ticket,anchorEl:anchorEl,menuOpen:ticketOptionsMenuOpen,handleClose:handleCloseTicketOptionsMenu})),ticket.status===\"pending\"&&/*#__PURE__*/React.createElement(ButtonWithSpinner,{loading:loading,size:\"small\",variant:\"contained\",color:\"primary\",onClick:e=>handleUpdateTicketStatus(e,\"open\",user===null||user===void 0?void 0:user.id)},i18n.t(\"messagesList.header.buttons.accept\")));};export default TicketActionButtons;","map":{"version":3,"names":["React","useContext","useState","useHistory","makeStyles","IconButton","MoreVert","Replay","i18n","api","TicketOptionsMenu","ButtonWithSpinner","toastError","AuthContext","useStyles","theme","actionButtons","marginRight","flex","alignSelf","marginLeft","margin","spacing","TicketActionButtons","_ref","ticket","classes","history","anchorEl","setAnchorEl","loading","setLoading","ticketOptionsMenuOpen","Boolean","user","handleOpenTicketOptionsMenu","e","currentTarget","handleCloseTicketOptionsMenu","handleUpdateTicketStatus","status","userId","put","concat","id","push","err","createElement","className","startIcon","size","onClick","t","Fragment","variant","color","menuOpen","handleClose"],"sources":["/home/fenix/whaticket-free/frontend/src/components/TicketActionButtons/index.js"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { IconButton } from \"@material-ui/core\";\nimport { MoreVert, Replay } from \"@material-ui/icons\";\n\nimport { i18n } from \"../../translate/i18n\";\nimport api from \"../../services/api\";\nimport TicketOptionsMenu from \"../TicketOptionsMenu\";\nimport ButtonWithSpinner from \"../ButtonWithSpinner\";\nimport toastError from \"../../errors/toastError\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst useStyles = makeStyles(theme => ({\n\tactionButtons: {\n\t\tmarginRight: 6,\n\t\tflex: \"none\",\n\t\talignSelf: \"center\",\n\t\tmarginLeft: \"auto\",\n\t\t\"& > *\": {\n\t\t\tmargin: theme.spacing(1),\n\t\t},\n\t},\n}));\n\nconst TicketActionButtons = ({ ticket }) => {\n\tconst classes = useStyles();\n\tconst history = useHistory();\n\tconst [anchorEl, setAnchorEl] = useState(null);\n\tconst [loading, setLoading] = useState(false);\n\tconst ticketOptionsMenuOpen = Boolean(anchorEl);\n\tconst { user } = useContext(AuthContext);\n\n\tconst handleOpenTicketOptionsMenu = e => {\n\t\tsetAnchorEl(e.currentTarget);\n\t};\n\n\tconst handleCloseTicketOptionsMenu = e => {\n\t\tsetAnchorEl(null);\n\t};\n\n\tconst handleUpdateTicketStatus = async (e, status, userId) => {\n\t\tsetLoading(true);\n\t\ttry {\n\t\t\tawait api.put(`/tickets/${ticket.id}`, {\n\t\t\t\tstatus: status,\n\t\t\t\tuserId: userId || null,\n\t\t\t});\n\n\t\t\tsetLoading(false);\n\t\t\tif (status === \"open\") {\n\t\t\t\thistory.push(`/tickets/${ticket.id}`);\n\t\t\t} else {\n\t\t\t\thistory.push(\"/tickets\");\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tsetLoading(false);\n\t\t\ttoastError(err);\n\t\t}\n\t};\n\n\treturn (\n\t\t<div className={classes.actionButtons}>\n\t\t\t{ticket.status === \"closed\" && (\n\t\t\t\t<ButtonWithSpinner\n\t\t\t\t\tloading={loading}\n\t\t\t\t\tstartIcon={<Replay />}\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t\tonClick={e => handleUpdateTicketStatus(e, \"open\", user?.id)}\n\t\t\t\t>\n\t\t\t\t\t{i18n.t(\"messagesList.header.buttons.reopen\")}\n\t\t\t\t</ButtonWithSpinner>\n\t\t\t)}\n\t\t\t{ticket.status === \"open\" && (\n\t\t\t\t<>\n\t\t\t\t\t<ButtonWithSpinner\n\t\t\t\t\t\tloading={loading}\n\t\t\t\t\t\tstartIcon={<Replay />}\n\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\tonClick={e => handleUpdateTicketStatus(e, \"pending\", null)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{i18n.t(\"messagesList.header.buttons.return\")}\n\t\t\t\t\t</ButtonWithSpinner>\n\t\t\t\t\t<ButtonWithSpinner\n\t\t\t\t\t\tloading={loading}\n\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\tonClick={e => handleUpdateTicketStatus(e, \"closed\", user?.id)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{i18n.t(\"messagesList.header.buttons.resolve\")}\n\t\t\t\t\t</ButtonWithSpinner>\n\t\t\t\t\t<IconButton onClick={handleOpenTicketOptionsMenu}>\n\t\t\t\t\t\t<MoreVert />\n\t\t\t\t\t</IconButton>\n\t\t\t\t\t<TicketOptionsMenu\n\t\t\t\t\t\tticket={ticket}\n\t\t\t\t\t\tanchorEl={anchorEl}\n\t\t\t\t\t\tmenuOpen={ticketOptionsMenuOpen}\n\t\t\t\t\t\thandleClose={handleCloseTicketOptionsMenu}\n\t\t\t\t\t/>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{ticket.status === \"pending\" && (\n\t\t\t\t<ButtonWithSpinner\n\t\t\t\t\tloading={loading}\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\tonClick={e => handleUpdateTicketStatus(e, \"open\", user?.id)}\n\t\t\t\t>\n\t\t\t\t\t{i18n.t(\"messagesList.header.buttons.accept\")}\n\t\t\t\t</ButtonWithSpinner>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport default TicketActionButtons;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}